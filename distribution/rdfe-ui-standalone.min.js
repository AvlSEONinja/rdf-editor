(function(e,t){typeof define=="function"&&define.amd?define("sifter",t):typeof exports=="object"?module.exports=t():e.Sifter=t()})(this,function(){var e=function(e,t){this.items=e,this.settings=t||{diacritics:!0}};e.prototype.tokenize=function(e){e=r(String(e||"").toLowerCase());if(!e||!e.length)return[];var t,n,s,u,a=[],f=e.split(/ +/);for(t=0,n=f.length;t<n;t++){s=i(f[t]);if(this.settings.diacritics)for(u in o)o.hasOwnProperty(u)&&(s=s.replace(new RegExp(u,"g"),o[u]));a.push({string:f[t],regex:new RegExp(s,"i")})}return a},e.prototype.iterator=function(e,t){var n;s(e)?n=Array.prototype.forEach||function(e){for(var t=0,n=this.length;t<n;t++)e(this[t],t,this)}:n=function(e){for(var t in this)this.hasOwnProperty(t)&&e(this[t],t,this)},n.apply(e,[t])},e.prototype.getScoreFunction=function(e,t){var n,r,i,s;n=this,e=n.prepareSearch(e,t),i=e.tokens,r=e.options.fields,s=i.length;var o=function(e,t){var n,r;return e?(e=String(e||""),r=e.search(t.regex),r===-1?0:(n=t.string.length/e.length,r===0&&(n+=.5),n)):0},u=function(){var e=r.length;return e?e===1?function(e,t){return o(t[r[0]],e)}:function(t,n){for(var i=0,s=0;i<e;i++)s+=o(n[r[i]],t);return s/e}:function(){return 0}}();return s?s===1?function(e){return u(i[0],e)}:e.options.conjunction==="and"?function(e){var t;for(var n=0,r=0;n<s;n++){t=u(i[n],e);if(t<=0)return 0;r+=t}return r/s}:function(e){for(var t=0,n=0;t<s;t++)n+=u(i[t],e);return n/s}:function(){return 0}},e.prototype.getSortFunction=function(e,n){var r,i,s,o,u,a,f,l,c,h,p;s=this,e=s.prepareSearch(e,n),p=!e.query&&n.sort_empty||n.sort,c=function(e,t){return e==="$score"?t.score:s.items[t.id][e]},u=[];if(p)for(r=0,i=p.length;r<i;r++)(e.query||p[r].field!=="$score")&&u.push(p[r]);if(e.query){h=!0;for(r=0,i=u.length;r<i;r++)if(u[r].field==="$score"){h=!1;break}h&&u.unshift({field:"$score",direction:"desc"})}else for(r=0,i=u.length;r<i;r++)if(u[r].field==="$score"){u.splice(r,1);break}l=[];for(r=0,i=u.length;r<i;r++)l.push(u[r].direction==="desc"?-1:1);return a=u.length,a?a===1?(o=u[0].field,f=l[0],function(e,n){return f*t(c(o,e),c(o,n))}):function(e,n){var r,i,s,o,f;for(r=0;r<a;r++){f=u[r].field,i=l[r]*t(c(f,e),c(f,n));if(i)return i}return 0}:null},e.prototype.prepareSearch=function(e,t){if(typeof e=="object")return e;t=n({},t);var r=t.fields,i=t.sort,o=t.sort_empty;return r&&!s(r)&&(t.fields=[r]),i&&!s(i)&&(t.sort=[i]),o&&!s(o)&&(t.sort_empty=[o]),{options:t,query:String(e||"").toLowerCase(),tokens:this.tokenize(e),total:0,items:[]}},e.prototype.search=function(e,t){var n=this,r,i,s,o,u,a;return s=this.prepareSearch(e,t),t=s.options,e=s.query,a=t.score||n.getScoreFunction(s),e.length?n.iterator(n.items,function(e,n){i=a(e),(t.filter===!1||i>0)&&s.items.push({score:i,id:n})}):n.iterator(n.items,function(e,t){s.items.push({score:1,id:t})}),u=n.getSortFunction(s,t),u&&s.items.sort(u),s.total=s.items.length,typeof t.limit=="number"&&(s.items=s.items.slice(0,t.limit)),s};var t=function(e,t){return typeof e=="number"&&typeof t=="number"?e>t?1:e<t?-1:0:(e=String(e||"").toLowerCase(),t=String(t||"").toLowerCase(),e>t?1:t>e?-1:0)},n=function(e,t){var n,r,i,s;for(n=1,r=arguments.length;n<r;n++){s=arguments[n];if(!s)continue;for(i in s)s.hasOwnProperty(i)&&(e[i]=s[i])}return e},r=function(e){return(e+"").replace(/^\s+|\s+$|/g,"")},i=function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},s=Array.isArray||$&&$.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},o={a:"[aÀÁÂÃÄÅàáâãäåĀā]",c:"[cÇçćĆčČ]",d:"[dđĐďĎ]",e:"[eÈÉÊËèéêëěĚĒē]",i:"[iÌÍÎÏìíîïĪī]",n:"[nÑñňŇ]",o:"[oÒÓÔÕÕÖØòóôõöøŌō]",r:"[rřŘ]",s:"[sŠš]",t:"[tťŤ]",u:"[uÙÚÛÜùúûüůŮŪū]",y:"[yŸÿýÝ]",z:"[zŽž]"};return e}),function(e,t){typeof define=="function"&&define.amd?define("microplugin",t):typeof exports=="object"?module.exports=t():e.MicroPlugin=t()}(this,function(){var e={};e.mixin=function(e){e.plugins={},e.prototype.initializePlugins=function(e){var n,r,i,s=this,o=[];s.plugins={names:[],settings:{},requested:{},loaded:{}};if(t.isArray(e))for(n=0,r=e.length;n<r;n++)typeof e[n]=="string"?o.push(e[n]):(s.plugins.settings[e[n].name]=e[n].options,o.push(e[n].name));else if(e)for(i in e)e.hasOwnProperty(i)&&(s.plugins.settings[i]=e[i],o.push(i));while(o.length)s.require(o.shift())},e.prototype.loadPlugin=function(t){var n=this,r=n.plugins,i=e.plugins[t];if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');r.requested[t]=!0,r.loaded[t]=i.fn.apply(n,[n.plugins.settings[t]||{}]),r.names.push(t)},e.prototype.require=function(e){var t=this,n=t.plugins;if(!t.plugins.loaded.hasOwnProperty(e)){if(n.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');t.loadPlugin(e)}return n.loaded[e]},e.define=function(t,n){e.plugins[t]={name:t,fn:n}}};var t={isArray:Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}};return e}),function(e,t){typeof define=="function"&&define.amd?define("selectize",["jquery","sifter","microplugin"],t):typeof exports=="object"?module.exports=t(require("jquery"),require("sifter"),require("microplugin")):e.Selectize=t(e.jQuery,e.Sifter,e.MicroPlugin)}(this,function(e,t,n){"use strict";var r=function(e,t){if(typeof t=="string"&&!t.length)return;var n=typeof t=="string"?new RegExp(t,"i"):t,r=function(e){var t=0;if(e.nodeType===3){var i=e.data.search(n);if(i>=0&&e.data.length>0){var s=e.data.match(n),o=document.createElement("span");o.className="highlight";var u=e.splitText(i),a=u.splitText(s[0].length),f=u.cloneNode(!0);o.appendChild(f),u.parentNode.replaceChild(o,u),t=1}}else if(e.nodeType===1&&e.childNodes&&!/(script|style)/i.test(e.tagName))for(var l=0;l<e.childNodes.length;++l)l+=r(e.childNodes[l]);return t};return e.each(function(){r(this)})},i=function(){};i.prototype={on:function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},off:function(e,t){var n=arguments.length;if(n===0)return delete this._events;if(n===1)return delete this._events[e];this._events=this._events||{};if(e in this._events==0)return;this._events[e].splice(this._events[e].indexOf(t),1)},trigger:function(e){this._events=this._events||{};if(e in this._events==0)return;for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}},i.mixin=function(e){var t=["on","off","trigger"];for(var n=0;n<t.length;n++)e.prototype[t[n]]=i.prototype[t[n]]};var s=/Mac/.test(navigator.userAgent),o=65,u=188,a=13,f=27,l=37,c=38,h=80,p=39,d=40,v=78,m=8,g=46,y=16,b=s?91:17,w=s?18:17,E=9,S=1,x=2,T=function(e){return typeof e!="undefined"},N=function(e){return typeof e=="undefined"||e===null?null:typeof e=="boolean"?e?"1":"0":e+""},C=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},k=function(e){return(e+"").replace(/\$/g,"$$$$")},L={};L.before=function(e,t,n){var r=e[t];e[t]=function(){return n.apply(e,arguments),r.apply(e,arguments)}},L.after=function(e,t,n){var r=e[t];e[t]=function(){var t=r.apply(e,arguments);return n.apply(e,arguments),t}};var A=function(t,n){if(!e.isArray(n))return n;var r,i,s={};for(r=0,i=n.length;r<i;r++)n[r].hasOwnProperty(t)&&(s[n[r][t]]=n[r]);return s},O=function(e){var t=!1;return function(){if(t)return;t=!0,e.apply(this,arguments)}},M=function(e,t){var n;return function(){var r=this,i=arguments;window.clearTimeout(n),n=window.setTimeout(function(){e.apply(r,i)},t)}},_=function(e,t,n){var r,i=e.trigger,s={};e.trigger=function(){var n=arguments[0];if(t.indexOf(n)===-1)return i.apply(e,arguments);s[n]=arguments},n.apply(e,[]),e.trigger=i;for(r in s)s.hasOwnProperty(r)&&i.apply(e,s[r])},D=function(e,t,n,r){e.on(t,n,function(t){var n=t.target;while(n&&n.parentNode!==e[0])n=n.parentNode;return t.currentTarget=n,r.apply(this,[t])})},P=function(e){var t={};if("selectionStart"in e)t.start=e.selectionStart,t.length=e.selectionEnd-t.start;else if(document.selection){e.focus();var n=document.selection.createRange(),r=document.selection.createRange().text.length;n.moveStart("character",-e.value.length),t.start=n.text.length-r,t.length=r}return t},H=function(e,t,n){var r,i,s={};if(n)for(r=0,i=n.length;r<i;r++)s[n[r]]=e.css(n[r]);else s=e.css();t.css(s)},B=function(t,n){if(!t)return 0;var r=e("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(t).appendTo("body");H(n,r,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var i=r.width();return r.remove(),i},j=function(e){var t=null,n=function(n,r){var i,s,o,u,a,f,l,c;n=n||window.event||{},r=r||{};if(n.metaKey||n.altKey)return;if(!r.force&&e.data("grow")===!1)return;i=e.val(),n.type&&n.type.toLowerCase()==="keydown"&&(s=n.keyCode,o=s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===32,s===g||s===m?(c=P(e[0]),c.length?i=i.substring(0,c.start)+i.substring(c.start+c.length):s===m&&c.start?i=i.substring(0,c.start-1)+i.substring(c.start+1):s===g&&typeof c.start!="undefined"&&(i=i.substring(0,c.start)+i.substring(c.start+1))):o&&(f=n.shiftKey,l=String.fromCharCode(n.keyCode),f?l=l.toUpperCase():l=l.toLowerCase(),i+=l)),u=e.attr("placeholder"),!i&&u&&(i=u),a=B(i,e)+4,a!==t&&(t=a,e.width(a),e.triggerHandler("resize"))};e.on("keydown keyup update blur",n),n()},F=function(n,r){var i,s,o,u,a,f=this;a=n[0],a.selectize=f;var l=window.getComputedStyle&&window.getComputedStyle(a,null);u=l?l.getPropertyValue("direction"):a.currentStyle&&a.currentStyle.direction,u=u||n.parents("[dir]:first").attr("dir")||"",e.extend(f,{settings:r,$input:n,tagType:a.tagName.toLowerCase()==="select"?S:x,rtl:/rtl/i.test(u),eventNS:".selectize"+ ++F.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:n.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:r.loadThrottle===null?f.onSearchChange:M(f.onSearchChange,r.loadThrottle)}),f.sifter=new t(this.options,{diacritics:r.diacritics}),e.extend(f.options,A(r.valueField,r.options)),delete f.settings.options,e.extend(f.optgroups,A(r.optgroupValueField,r.optgroups)),delete f.settings.optgroups,f.settings.mode=f.settings.mode||(f.settings.maxItems===1?"single":"multi"),typeof f.settings.hideSelected!="boolean"&&(f.settings.hideSelected=f.settings.mode==="multi"),f.initializePlugins(f.settings.plugins),f.setupCallbacks(),f.setupTemplates(),f.setup()};return i.mixin(F),n.mixin(F),e.extend(F.prototype,{setup:function(){var t=this,n=t.settings,r=t.eventNS,i=e(window),o=e(document),u=t.$input,a,f,l,c,h,p,d,v,m,g,E,x;d=t.settings.mode,g=u.attr("tabindex")||"",E=u.attr("class")||"",a=e("<div>").addClass(n.wrapperClass).addClass(E).addClass(d),f=e("<div>").addClass(n.inputClass).addClass("items").appendTo(a),l=e('<input type="text" autocomplete="off" />').appendTo(f).attr("tabindex",g),p=e(n.dropdownParent||a),c=e("<div>").addClass(n.dropdownClass).addClass(d).hide().appendTo(p),h=e("<div>").addClass(n.dropdownContentClass).appendTo(c),t.settings.copyClassesToDropdown&&c.addClass(E),a.css({width:u[0].style.width}),t.plugins.names.length&&(x="plugin-"+t.plugins.names.join(" plugin-"),a.addClass(x),c.addClass(x)),(n.maxItems===null||n.maxItems>1)&&t.tagType===S&&u.attr("multiple","multiple"),t.settings.placeholder&&l.attr("placeholder",n.placeholder),u.attr("autocorrect")&&l.attr("autocorrect",u.attr("autocorrect")),u.attr("autocapitalize")&&l.attr("autocapitalize",u.attr("autocapitalize")),t.$wrapper=a,t.$control=f,t.$control_input=l,t.$dropdown=c,t.$dropdown_content=h,c.on("mouseenter","[data-selectable]",function(){return t.onOptionHover.apply(t,arguments)}),c.on("mousedown","[data-selectable]",function(){return t.onOptionSelect.apply(t,arguments)}),D(f,"mousedown","*:not(input)",function(){return t.onItemSelect.apply(t,arguments)}),j(l),f.on({mousedown:function(){return t.onMouseDown.apply(t,arguments)},click:function(){return t.onClick.apply(t,arguments)}}),l.on({mousedown:function(e){e.stopPropagation()},keydown:function(){return t.onKeyDown.apply(t,arguments)},keyup:function(){return t.onKeyUp.apply(t,arguments)},keypress:function(){return t.onKeyPress.apply(t,arguments)},resize:function(){t.positionDropdown.apply(t,[])},blur:function(){return t.onBlur.apply(t,arguments)},focus:function(){return t.ignoreBlur=!1,t.onFocus.apply(t,arguments)},paste:function(){return t.onPaste.apply(t,arguments)}}),o.on("keydown"+r,function(e){t.isCmdDown=e[s?"metaKey":"ctrlKey"],t.isCtrlDown=e[s?"altKey":"ctrlKey"],t.isShiftDown=e.shiftKey}),o.on("keyup"+r,function(e){e.keyCode===w&&(t.isCtrlDown=!1),e.keyCode===y&&(t.isShiftDown=!1),e.keyCode===b&&(t.isCmdDown=!1)}),o.on("mousedown"+r,function(e){if(t.isFocused){if(e.target===t.$dropdown[0]||e.target.parentNode===t.$dropdown[0])return!1;!t.$control.has(e.target).length&&e.target!==t.$control[0]&&t.blur()}}),i.on(["scroll"+r,"resize"+r].join(" "),function(){t.isOpen&&t.positionDropdown.apply(t,arguments)}),i.on("mousemove"+r,function(){t.ignoreHover=!1}),this.revertSettings={$children:u.children().detach(),tabindex:u.attr("tabindex")},u.attr("tabindex",-1).hide().after(t.$wrapper),e.isArray(n.items)&&(t.setValue(n.items),delete n.items),u[0].validity&&u.on("invalid"+r,function(e){e.preventDefault(),t.isInvalid=!0,t.refreshState()}),t.updateOriginalInput(),t.refreshItems(),t.refreshState(),t.updatePlaceholder(),t.isSetup=!0,u.is(":disabled")&&t.disable(),t.on("change",this.onChange),u.data("selectize",t),u.addClass("selectized"),t.trigger("initialize"),n.preload===!0&&t.onSearchChange("")},setupTemplates:function(){var t=this,n=t.settings.labelField,r=t.settings.optgroupLabelField,i={optgroup:function(e){return'<div class="optgroup">'+e.html+"</div>"},optgroup_header:function(e,t){return'<div class="optgroup-header">'+t(e[r])+"</div>"},option:function(e,t){return'<div class="option">'+t(e[n])+"</div>"},item:function(e,t){return'<div class="item">'+t(e[n])+"</div>"},option_create:function(e,t){return'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>"}};t.settings.render=e.extend({},i,t.settings.render)},setupCallbacks:function(){var e,t,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad"};for(e in n)n.hasOwnProperty(e)&&(t=this.settings[n[e]],t&&this.on(e,t))},onClick:function(e){var t=this;t.isFocused||(t.focus(),e.preventDefault())},onMouseDown:function(t){var n=this,r=t.isDefaultPrevented(),i=e(t.target);if(n.isFocused){if(t.target!==n.$control_input[0])return n.settings.mode==="single"?n.isOpen?n.close():n.open():r||n.setActiveItem(null),!1}else r||window.setTimeout(function(){n.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(e){var t=this;(t.isFull()||t.isInputHidden||t.isLocked)&&e.preventDefault()},onKeyPress:function(e){if(this.isLocked)return e&&e.preventDefault();var t=String.fromCharCode(e.keyCode||e.which);if(this.settings.create&&t===this.settings.delimiter)return this.createItem(),e.preventDefault(),!1},onKeyDown:function(e){var t=e.target===this.$control_input[0],n=this;if(n.isLocked){e.keyCode!==E&&e.preventDefault();return}switch(e.keyCode){case o:if(n.isCmdDown){n.selectAll();return}break;case f:n.close();return;case v:if(!e.ctrlKey||e.altKey)break;case d:if(!n.isOpen&&n.hasOptions)n.open();else if(n.$activeOption){n.ignoreHover=!0;var r=n.getAdjacentOption(n.$activeOption,1);r.length&&n.setActiveOption(r,!0,!0)}e.preventDefault();return;case h:if(!e.ctrlKey||e.altKey)break;case c:if(n.$activeOption){n.ignoreHover=!0;var i=n.getAdjacentOption(n.$activeOption,-1);i.length&&n.setActiveOption(i,!0,!0)}e.preventDefault();return;case a:n.isOpen&&n.$activeOption&&n.onOptionSelect({currentTarget:n.$activeOption}),e.preventDefault();return;case l:n.advanceSelection(-1,e);return;case p:n.advanceSelection(1,e);return;case E:n.settings.selectOnTab&&n.isOpen&&n.$activeOption&&(n.onOptionSelect({currentTarget:n.$activeOption}),e.preventDefault()),n.settings.create&&n.createItem()&&e.preventDefault();return;case m:case g:n.deleteSelection(e);return}if((n.isFull()||n.isInputHidden)&&(s?!e.metaKey:!e.ctrlKey)){e.preventDefault();return}},onKeyUp:function(e){var t=this;if(t.isLocked)return e&&e.preventDefault();var n=t.$control_input.val()||"";t.lastValue!==n&&(t.lastValue=n,t.onSearchChange(n),t.refreshOptions(),t.trigger("type",n))},onSearchChange:function(e){var t=this,n=t.settings.load;if(!n)return;if(t.loadedSearches.hasOwnProperty(e))return;t.loadedSearches[e]=!0,t.load(function(r){n.apply(t,[e,r])})},onFocus:function(e){var t=this;t.isFocused=!0;if(t.isDisabled)return t.blur(),e&&e.preventDefault(),!1;if(t.ignoreFocus)return;t.settings.preload==="focus"&&t.onSearchChange(""),t.$activeItems.length||(t.showInput(),t.setActiveItem(null),t.refreshOptions(!!t.settings.openOnFocus)),t.refreshState()},onBlur:function(e){var t=this;t.isFocused=!1;if(t.ignoreFocus)return;if(!t.ignoreBlur&&document.activeElement===t.$dropdown_content[0]){t.ignoreBlur=!0,t.onFocus(e);return}t.settings.create&&t.settings.createOnBlur&&t.createItem(!1),t.close(),t.setTextboxValue(""),t.setActiveItem(null),t.setActiveOption(null),t.setCaret(t.items.length),t.refreshState()},onOptionHover:function(e){if(this.ignoreHover)return;this.setActiveOption(e.currentTarget,!1)},onOptionSelect:function(t){var n,r,i,s=this;t.preventDefault&&(t.preventDefault(),t.stopPropagation()),r=e(t.currentTarget),r.hasClass("create")?s.createItem():(n=r.attr("data-value"),typeof n!="undefined"&&(s.lastQuery=null,s.setTextboxValue(""),s.addItem(n),!s.settings.hideSelected&&t.type&&/mouse/.test(t.type)&&s.setActiveOption(s.getOption(n))))},onItemSelect:function(e){var t=this;if(t.isLocked)return;t.settings.mode==="multi"&&(e.preventDefault(),t.setActiveItem(e.currentTarget,e))},load:function(e){var t=this,n=t.$wrapper.addClass("loading");t.loading++,e.apply(t,[function(e){t.loading=Math.max(t.loading-1,0),e&&e.length&&(t.addOption(e),t.refreshOptions(t.isFocused&&!t.isInputHidden)),t.loading||n.removeClass("loading"),t.trigger("load",e)}])},setTextboxValue:function(e){var t=this.$control_input,n=t.val()!==e;n&&(t.val(e).triggerHandler("update"),this.lastValue=e)},getValue:function(){return this.tagType===S&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(e){_(this,["change"],function(){this.clear(),this.addItems(e)})},setActiveItem:function(t,n){var r=this,i,s,o,u,a,f,l,c;if(r.settings.mode==="single")return;t=e(t);if(!t.length){e(r.$activeItems).removeClass("active"),r.$activeItems=[],r.isFocused&&r.showInput();return}i=n&&n.type.toLowerCase();if(i==="mousedown"&&r.isShiftDown&&r.$activeItems.length){c=r.$control.children(".active:last"),u=Array.prototype.indexOf.apply(r.$control[0].childNodes,[c[0]]),a=Array.prototype.indexOf.apply(r.$control[0].childNodes,[t[0]]),u>a&&(l=u,u=a,a=l);for(s=u;s<=a;s++)f=r.$control[0].childNodes[s],r.$activeItems.indexOf(f)===-1&&(e(f).addClass("active"),r.$activeItems.push(f));n.preventDefault()}else i==="mousedown"&&r.isCtrlDown||i==="keydown"&&this.isShiftDown?t.hasClass("active")?(o=r.$activeItems.indexOf(t[0]),r.$activeItems.splice(o,1),t.removeClass("active")):r.$activeItems.push(t.addClass("active")[0]):(e(r.$activeItems).removeClass("active"),r.$activeItems=[t.addClass("active")[0]]);r.hideInput(),this.isFocused||r.focus()},setActiveOption:function(t,n,r){var i,s,o,u,a,f=this;f.$activeOption&&f.$activeOption.removeClass("active"),f.$activeOption=null,t=e(t);if(!t.length)return;f.$activeOption=t.addClass("active");if(n||!T(n))i=f.$dropdown_content.height(),s=f.$activeOption.outerHeight(!0),n=f.$dropdown_content.scrollTop()||0,o=f.$activeOption.offset().top-f.$dropdown_content.offset().top+n,u=o,a=o-i+s,o+s>i+n?f.$dropdown_content.stop().animate({scrollTop:a},r?f.settings.scrollDuration:0):o<n&&f.$dropdown_content.stop().animate({scrollTop:u},r?f.settings.scrollDuration:0)},selectAll:function(){var e=this;if(e.settings.mode==="single")return;e.$activeItems=Array.prototype.slice.apply(e.$control.children(":not(input)").addClass("active")),e.$activeItems.length&&(e.hideInput(),e.close()),e.focus()},hideInput:function(){var e=this;e.setTextboxValue(""),e.$control_input.css({opacity:0,position:"absolute",left:e.rtl?1e4:-1e4}),e.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var e=this;if(e.isDisabled)return;e.ignoreFocus=!0,e.$control_input[0].focus(),window.setTimeout(function(){e.ignoreFocus=!1,e.onFocus()},0)},blur:function(){this.$control_input.trigger("blur")},getScoreFunction:function(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())},getSearchOptions:function(){var e=this.settings,t=e.sortField;return typeof t=="string"&&(t={field:t}),{fields:e.searchField,conjunction:e.searchConjunction,sort:t}},search:function(t){var n,r,i,s,o,u=this,a=u.settings,f=this.getSearchOptions();if(a.score){o=u.settings.score.apply(this,[t]);if(typeof o!="function")throw new Error('Selectize "score" setting must be a function that returns a function')}t!==u.lastQuery?(u.lastQuery=t,s=u.sifter.search(t,e.extend(f,{score:o})),u.currentResults=s):s=e.extend(!0,{},u.currentResults);if(a.hideSelected)for(n=s.items.length-1;n>=0;n--)u.items.indexOf(N(s.items[n].id))!==-1&&s.items.splice(n,1);return s},refreshOptions:function(t){var n,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;typeof t=="undefined"&&(t=!0);var b=this,w=e.trim(b.$control_input.val()),E=b.search(w),S=b.$dropdown_content,x=b.$activeOption&&N(b.$activeOption.attr("data-value"));o=E.items.length,typeof b.settings.maxOptions=="number"&&(o=Math.min(o,b.settings.maxOptions)),u={};if(b.settings.optgroupOrder){a=b.settings.optgroupOrder;for(n=0;n<a.length;n++)u[a[n]]=[]}else a=[];for(n=0;n<o;n++){f=b.options[E.items[n].id],l=b.render("option",f),c=f[b.settings.optgroupField]||"",h=e.isArray(c)?c:[c];for(i=0,s=h&&h.length;i<s;i++)c=h[i],b.optgroups.hasOwnProperty(c)||(c=""),u.hasOwnProperty(c)||(u[c]=[],a.push(c)),u[c].push(l)}p=[];for(n=0,o=a.length;n<o;n++)c=a[n],b.optgroups.hasOwnProperty(c)&&u[c].length?(d=b.render("optgroup_header",b.optgroups[c])||"",d+=u[c].join(""),p.push(b.render("optgroup",e.extend({},b.optgroups[c],{html:d})))):p.push(u[c].join(""));S.html(p.join(""));if(b.settings.highlight&&E.query.length&&E.tokens.length)for(n=0,o=E.tokens.length;n<o;n++)r(S,E.tokens[n].regex);if(!b.settings.hideSelected)for(n=0,o=b.items.length;n<o;n++)b.getOption(b.items[n]).addClass("selected");v=b.canCreate(w),v&&(S.prepend(b.render("option_create",{input:w})),y=e(S[0].childNodes[0])),b.hasOptions=E.items.length>0||v;if(b.hasOptions){if(E.items.length>0){g=x&&b.getOption(x),g&&g.length?m=g:b.settings.mode==="single"&&b.items.length&&(m=b.getOption(b.items[0]));if(!m||!m.length)y&&!b.settings.addPrecedence?m=b.getAdjacentOption(y,1):m=S.find("[data-selectable]:first")}else m=y;b.setActiveOption(m),t&&!b.isOpen&&b.open()}else b.setActiveOption(null),t&&b.isOpen&&b.close()},addOption:function(t){var n,r,i,s,o=this;if(e.isArray(t)){for(n=0,r=t.length;n<r;n++)o.addOption(t[n]);return}s=N(t[o.settings.valueField]);if(typeof s!="string"||o.options.hasOwnProperty(s))return;o.userOptions[s]=!0,o.options[s]=t,o.lastQuery=null,o.trigger("option_add",s,t)},addOptionGroup:function(e,t){this.optgroups[e]=t,this.trigger("optgroup_add",e,t)},updateOption:function(t,n){var r=this,i,s,o,u,a,f;t=N(t),o=N(n[r.settings.valueField]);if(t===null)return;if(!r.options.hasOwnProperty(t))return;if(typeof o!="string")throw new Error("Value must be set in option data");o!==t&&(delete r.options[t],u=r.items.indexOf(t),u!==-1&&r.items.splice(u,1,o)),r.options[o]=n,a=r.renderCache.item,f=r.renderCache.option,a&&(delete a[t],delete a[o]),f&&(delete f[t],delete f[o]),r.items.indexOf(o)!==-1&&(i=r.getItem(t),s=e(r.render("item",n)),i.hasClass("active")&&s.addClass("active"),i.replaceWith(s)),r.lastQuery=null,r.isOpen&&r.refreshOptions(!1)},removeOption:function(e){var t=this;e=N(e);var n=t.renderCache.item,r=t.renderCache.option;n&&delete n[e],r&&delete r[e],delete t.userOptions[e],delete t.options[e],t.lastQuery=null,t.trigger("option_remove",e),t.removeItem(e)},clearOptions:function(){var e=this;e.loadedSearches={},e.userOptions={},e.renderCache={},e.options=e.sifter.items={},e.lastQuery=null,e.trigger("option_clear"),e.clear()},getOption:function(e){return this.getElementWithValue(e,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(t,n){var r=this.$dropdown.find("[data-selectable]"),i=r.index(t)+n;return i>=0&&i<r.length?r.eq(i):e()},getElementWithValue:function(t,n){t=N(t);if(typeof t!="undefined"&&t!==null)for(var r=0,i=n.length;r<i;r++)if(n[r].getAttribute("data-value")===t)return e(n[r]);return e()},getItem:function(e){return this.getElementWithValue(e,this.$control.children())},addItems:function(t){var n=e.isArray(t)?t:[t];for(var r=0,i=n.length;r<i;r++)this.isPending=r<i-1,this.addItem(n[r])},addItem:function(t){_(this,["change"],function(){var n,r,i,s=this,o=s.settings.mode,u,a,f,l;t=N(t);if(s.items.indexOf(t)!==-1){o==="single"&&s.close();return}if(!s.options.hasOwnProperty(t))return;o==="single"&&s.clear();if(o==="multi"&&s.isFull())return;n=e(s.render("item",s.options[t])),l=s.isFull(),s.items.splice(s.caretPos,0,t),s.insertAtCaret(n),(!s.isPending||!l&&s.isFull())&&s.refreshState(),s.isSetup&&(i=s.$dropdown_content.find("[data-selectable]"),s.isPending||(r=s.getOption(t),f=s.getAdjacentOption(r,1).attr("data-value"),s.refreshOptions(s.isFocused&&o!=="single"),f&&s.setActiveOption(s.getOption(f))),!i.length||s.isFull()?s.close():s.positionDropdown(),s.updatePlaceholder(),s.trigger("item_add",t,n),s.updateOriginalInput())})},removeItem:function(e){var t=this,n,r,i;n=typeof e=="object"?e:t.getItem(e),e=N(n.attr("data-value")),r=t.items.indexOf(e),r!==-1&&(n.remove(),n.hasClass("active")&&(i=t.$activeItems.indexOf(n[0]),t.$activeItems.splice(i,1)),t.items.splice(r,1),t.lastQuery=null,!t.settings.persist&&t.userOptions.hasOwnProperty(e)&&t.removeOption(e),r<t.caretPos&&t.setCaret(t.caretPos-1),t.refreshState(),t.updatePlaceholder(),t.updateOriginalInput(),t.positionDropdown(),t.trigger("item_remove",e))},createItem:function(t){var n=this,r=e.trim(n.$control_input.val()||""),i=n.caretPos;if(!n.canCreate(r))return!1;n.lock(),typeof t=="undefined"&&(t=!0);var s=typeof n.settings.create=="function"?this.settings.create:function(e){var t={};return t[n.settings.labelField]=e,t[n.settings.valueField]=e,t},o=O(function(e){n.unlock();if(!e||typeof e!="object")return;var r=N(e[n.settings.valueField]);if(typeof r!="string")return;n.setTextboxValue(""),n.addOption(e),n.setCaret(i),n.addItem(r),n.refreshOptions(t&&n.settings.mode!=="single")}),u=s.apply(this,[r,o]);return typeof u!="undefined"&&o(u),!0},refreshItems:function(){this.lastQuery=null;if(this.isSetup)for(var e=0;e<this.items.length;e++)this.addItem(this.items);this.refreshState(),this.updateOriginalInput()},refreshState:function(){var e,t=this;t.isRequired&&(t.items.length&&(t.isInvalid=!1),t.$control_input.prop("required",e)),t.refreshClasses()},refreshClasses:function(){var t=this,n=t.isFull(),r=t.isLocked;t.$wrapper.toggleClass("rtl",t.rtl),t.$control.toggleClass("focus",t.isFocused).toggleClass("disabled",t.isDisabled).toggleClass("required",t.isRequired).toggleClass("invalid",t.isInvalid).toggleClass("locked",r).toggleClass("full",n).toggleClass("not-full",!n).toggleClass("input-active",t.isFocused&&!t.isInputHidden).toggleClass("dropdown-active",t.isOpen).toggleClass("has-options",!e.isEmptyObject(t.options)).toggleClass("has-items",t.items.length>0),t.$control_input.data("grow",!n&&!r)},isFull:function(){return this.settings.maxItems!==null&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(){var e,t,n,r=this;if(r.tagType===S){n=[];for(e=0,t=r.items.length;e<t;e++)n.push('<option value="'+C(r.items[e])+'" selected="selected"></option>');!n.length&&!this.$input.attr("multiple")&&n.push('<option value="" selected="selected"></option>'),r.$input.html(n.join(""))}else r.$input.val(r.getValue()),r.$input.attr("value",r.$input.val());r.isSetup&&r.trigger("change",r.$input.val())},updatePlaceholder:function(){if(!this.settings.placeholder)return;var e=this.$control_input;this.items.length?e.removeAttr("placeholder"):e.attr("placeholder",this.settings.placeholder),e.triggerHandler("update",{force:!0})},open:function(){var e=this;if(e.isLocked||e.isOpen||e.settings.mode==="multi"&&e.isFull())return;e.focus(),e.isOpen=!0,e.refreshState(),e.$dropdown.css({visibility:"hidden",display:"block"}),e.positionDropdown(),e.$dropdown.css({visibility:"visible"}),e.trigger("dropdown_open",e.$dropdown)},close:function(){var e=this,t=e.isOpen;e.settings.mode==="single"&&e.items.length&&e.hideInput(),e.isOpen=!1,e.$dropdown.hide(),e.setActiveOption(null),e.refreshState(),t&&e.trigger("dropdown_close",e.$dropdown)},positionDropdown:function(){var e=this.$control,t=this.settings.dropdownParent==="body"?e.offset():e.position();t.top+=e.outerHeight(!0),this.$dropdown.css({width:e.outerWidth(),top:t.top,left:t.left})},clear:function(){var e=this;if(!e.items.length)return;e.$control.children(":not(input)").remove(),e.items=[],e.lastQuery=null,e.setCaret(0),e.setActiveItem(null),e.updatePlaceholder(),e.updateOriginalInput(),e.refreshState(),e.showInput(),e.trigger("clear")},insertAtCaret:function(t){var n=Math.min(this.caretPos,this.items.length);n===0?this.$control.prepend(t):e(this.$control[0].childNodes[n]).before(t),this.setCaret(n+1)},deleteSelection:function(t){var n,r,i,s,o,u,a,f,l,c=this;i=t&&t.keyCode===m?-1:1,s=P(c.$control_input[0]),c.$activeOption&&!c.settings.hideSelected&&(a=c.getAdjacentOption(c.$activeOption,-1).attr("data-value")),o=[];if(c.$activeItems.length){l=c.$control.children(".active:"+(i>0?"last":"first")),u=c.$control.children(":not(input)").index(l),i>0&&u++;for(n=0,r=c.$activeItems.length;n<r;n++)o.push(e(c.$activeItems[n]).attr("data-value"));t&&(t.preventDefault(),t.stopPropagation())}else(c.isFocused||c.settings.mode==="single")&&c.items.length&&(i<0&&s.start===0&&s.length===0?o.push(c.items[c.caretPos-1]):i>0&&s.start===c.$control_input.val().length&&o.push(c.items[c.caretPos]));if(!o.length||typeof c.settings.onDelete=="function"&&c.settings.onDelete.apply(c,[o])===!1)return!1;typeof u!="undefined"&&c.setCaret(u);while(o.length)c.removeItem(o.pop());return c.showInput(),c.positionDropdown(),c.refreshOptions(!0),a&&(f=c.getOption(a),f.length&&c.setActiveOption(f)),!0},advanceSelection:function(e,t){var n,r,i,s,o,u,a=this;if(e===0)return;a.rtl&&(e*=-1),n=e>0?"last":"first",r=P(a.$control_input[0]),a.isFocused&&!a.isInputHidden?(s=a.$control_input.val().length,o=e<0?r.start===0&&r.length===0:r.start===s,o&&!s&&a.advanceCaret(e,t)):(u=a.$control.children(".active:"+n),u.length&&(i=a.$control.children(":not(input)").index(u),a.setActiveItem(null),a.setCaret(e>0?i+1:i)))},advanceCaret:function(e,t){var n=this,r,i;if(e===0)return;r=e>0?"next":"prev",n.isShiftDown?(i=n.$control_input[r](),i.length&&(n.hideInput(),n.setActiveItem(i),t&&t.preventDefault())):n.setCaret(n.caretPos+e)},setCaret:function(t){var n=this;n.settings.mode==="single"?t=n.items.length:t=Math.max(0,Math.min(n.items.length,t));if(!n.isPending){var r,i,s,o,u;o=n.$control.children(":not(input)");for(r=0,i=o.length;r<i;r++)u=e(o[r]).detach(),r<t?n.$control_input.before(u):n.$control.append(u)}n.caretPos=t},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var e=this;e.$input.prop("disabled",!0),e.isDisabled=!0,e.lock()},enable:function(){var e=this;e.$input.prop("disabled",!1),e.isDisabled=!1,e.unlock()},destroy:function(){var t=this,n=t.eventNS,r=t.revertSettings;t.trigger("destroy"),t.off(),t.$wrapper.remove(),t.$dropdown.remove(),t.$input.html("").append(r.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:r.tabindex}).show(),t.$control_input.removeData("grow"),t.$input.removeData("selectize"),e(window).off(n),e(document).off(n),e(document.body).off(n),delete t.$input[0].selectize},render:function(e,t){var n,r,i,s="",o=!1,u=this,a=/^[\t ]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;if(e==="option"||e==="item")n=N(t[u.settings.valueField]),o=!!n;if(o){T(u.renderCache[e])||(u.renderCache[e]={});if(u.renderCache[e].hasOwnProperty(n))return u.renderCache[e][n]}s=u.settings.render[e].apply(this,[t,C]);if(e==="option"||e==="option_create")s=s.replace(a,"<$1 data-selectable");e==="optgroup"&&(r=t[u.settings.optgroupValueField]||"",s=s.replace(a,'<$1 data-group="'+k(C(r))+'"'));if(e==="option"||e==="item")s=s.replace(a,'<$1 data-value="'+k(C(n||""))+'"');return o&&(u.renderCache[e][n]=s),s},clearCache:function(e){var t=this;typeof e=="undefined"?t.renderCache={}:delete t.renderCache[e]},canCreate:function(e){var t=this;if(!t.settings.create)return!1;var n=t.settings.createFilter;return e.length&&(typeof n!="function"||n.apply(t,[e]))&&(typeof n!="string"||(new RegExp(n)).test(e))&&(!(n instanceof RegExp)||n.test(e))}}),F.count=0,F.defaults={plugins:[],delimiter:",",persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,scrollDuration:60,loadThrottle:300,dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",optgroupOrder:null,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},e.fn.selectize=function(t){var n=e.fn.selectize.defaults,r=e.extend({},n,t),i=r.dataAttr,s=r.labelField,o=r.valueField,u=r.optgroupField,a=r.optgroupLabelField,f=r.optgroupValueField,l=function(t,n){var i,u,a,f,l=e.trim(t.val()||"");if(!r.allowEmptyOption&&!l.length)return;a=l.split(r.delimiter);for(i=0,u=a.length;i<u;i++)f={},f[s]=a[i],f[o]=a[i],n.options[a[i]]=f;n.items=a},c=function(t,n){var l,c,h,p,d=0,v=n.options,m=function(e){var t=i&&e.attr(i);return typeof t=="string"&&t.length?JSON.parse(t):null},g=function(t,i){var a,f;t=e(t),a=t.attr("value")||"";if(!a.length&&!r.allowEmptyOption)return;if(v.hasOwnProperty(a)){i&&(v[a].optgroup?e.isArray(v[a].optgroup)?v[a].optgroup.push(i):v[a].optgroup=[v[a].optgroup,i]:v[a].optgroup=i);return}f=m(t)||{},f[s]=f[s]||t.text(),f[o]=f[o]||a,f[u]=f[u]||i,f.$order=++d,v[a]=f,t.is(":selected")&&n.items.push(a)},y=function(t){var r,i,s,o,u;t=e(t),s=t.attr("label"),s&&(o=m(t)||{},o[a]=s,o[f]=s,n.optgroups[s]=o),u=e("option",t);for(r=0,i=u.length;r<i;r++)g(u[r],s)};n.maxItems=t.attr("multiple")?null:1,p=t.children();for(l=0,c=p.length;l<c;l++)h=p[l].tagName.toLowerCase(),h==="optgroup"?y(p[l]):h==="option"&&g(p[l])};return this.each(function(){if(this.selectize)return;var i,s=e(this),o=this.tagName.toLowerCase(),u=s.attr("placeholder")||s.attr("data-placeholder");!u&&!r.allowEmptyOption&&(u=s.children('option[value=""]').text());var a={placeholder:u,options:{},optgroups:{},items:[]};o==="select"?c(s,a):l(s,a),i=new F(s,e.extend(!0,{},n,a,t))})},e.fn.selectize.defaults=F.defaults,F.define("drag_drop",function(t){if(!e.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if(this.settings.mode!=="multi")return;var n=this;n.lock=function(){var e=n.lock;return function(){var t=n.$control.data("sortable");return t&&t.disable(),e.apply(n,arguments)}}(),n.unlock=function(){var e=n.unlock;return function(){var t=n.$control.data("sortable");return t&&t.enable(),e.apply(n,arguments)}}(),n.setup=function(){var t=n.setup;return function(){t.apply(this,arguments);var r=n.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:n.isLocked,start:function(e,t){t.placeholder.css("width",t.helper.css("width")),r.css({overflow:"visible"})},stop:function(){r.css({overflow:"hidden"});var t=n.$activeItems?n.$activeItems.slice():null,i=[];r.children("[data-value]").each(function(){i.push(e(this).attr("data-value"))}),n.setValue(i),n.setActiveItem(t)}})}}()}),F.define("dropdown_header",function(t){var n=this;t=e.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(e){return'<div class="'+e.headerClass+'">'+'<div class="'+e.titleRowClass+'">'+'<span class="'+e.labelClass+'">'+e.title+"</span>"+'<a href="javascript:void(0)" class="'+e.closeClass+'">&times;</a>'+"</div>"+"</div>"}},t),n.setup=function(){var r=n.setup;return function(){r.apply(n,arguments),n.$dropdown_header=e(t.html(t)),n.$dropdown.prepend(n.$dropdown_header)}}()}),F.define("optgroup_columns",function(t){var n=this;t=e.extend({equalizeWidth:!0,equalizeHeight:!0},t),this.getAdjacentOption=function(t,n){var r=t.closest("[data-group]").find("[data-selectable]"),i=r.index(t)+n;return i>=0&&i<r.length?r.eq(i):e()},this.onKeyDown=function(){var e=n.onKeyDown;return function(t){var r,i,s,o;if(!this.isOpen||t.keyCode!==l&&t.keyCode!==p)return e.apply(this,arguments);n.ignoreHover=!0,o=this.$activeOption.closest("[data-group]"),r=o.find("[data-selectable]").index(this.$activeOption),t.keyCode===l?o=o.prev("[data-group]"):o=o.next("[data-group]"),s=o.find("[data-selectable]"),i=s.eq(Math.min(s.length-1,r)),i.length&&this.setActiveOption(i);return}}();var r=function(){var e,t=r.width,n=document;return typeof t=="undefined"&&(e=n.createElement("div"),e.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',e=e.firstChild,n.body.appendChild(e),t=r.width=e.offsetWidth-e.clientWidth,n.body.removeChild(e)),t},i=function(){var i,s,o,u,a,f,l;l=e("[data-group]",n.$dropdown_content),s=l.length;if(!s||!n.$dropdown_content.width())return;if(t.equalizeHeight){o=0;for(i=0;i<s;i++)o=Math.max(o,l.eq(i).height());l.css({height:o})}t.equalizeWidth&&(f=n.$dropdown_content.innerWidth()-r(),u=Math.round(f/s),l.css({width:u}),s>1&&(a=f-u*(s-1),l.eq(s-1).css({width:a})))};if(t.equalizeHeight||t.equalizeWidth)L.after(this,"positionDropdown",i),L.after(this,"refreshOptions",i)}),F.define("remove_button",function(t){if(this.settings.mode==="single")return;t=e.extend({label:"&times;",title:"Remove",className:"remove",append:!0},t);var n=this,r='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+C(t.title)+'">'+t.label+"</a>",i=function(e,t){var n=e.search(/(<\/[^>]+>\s*)$/);return e.substring(0,n)+t+e.substring(n)};this.setup=function(){var s=n.setup;return function(){if(t.append){var o=n.settings.render.item;n.settings.render.item=function(e){return i(o.apply(this,arguments),r)}}s.apply(this,arguments),this.$control.on("click","."+t.className,function(t){t.preventDefault();if(n.isLocked)return;var r=e(t.currentTarget).parent();n.setActiveItem(r),n.deleteSelection()&&n.setCaret(n.items.length)})}}()}),F.define("restore_on_backspace",function(e){var t=this;e.text=e.text||function(e){return e[this.settings.labelField]},this.onKeyDown=function(n){var r=t.onKeyDown;return function(t){var n,i;if(t.keyCode===m&&this.$control_input.val()===""&&!this.$activeItems.length){n=this.caretPos-1;if(n>=0&&n<this.items.length){i=this.options[this.items[n]],this.deleteSelection(t)&&(this.setTextboxValue(e.text.apply(this,[i])),this.refreshOptions(!0)),t.preventDefault();return}}return r.apply(this,arguments)}}()}),F}),function(e){if(typeof exports!="undefined"&&typeof require!="undefined")var t=e._||require("underscore"),n=e.Backbone||require("backbone");else var t=e._,n=e.Backbone;var r=n.View.extend({events:{submit:function(e){this.trigger("submit",e)}},initialize:function(e){var n=this;e=this.options=t.extend({submitButton:!1},e);var r=this.schema=function(){if(e.schema)return t.result(e,"schema");var r=e.model;return r&&r.schema?t.result(r,"schema"):n.schema?t.result(n,"schema"):{}}();t.extend(this,t.pick(e,"model","data","idPrefix","templateData"));var i=this.constructor;this.template=e.template||this.template||i.template,this.Fieldset=e.Fieldset||this.Fieldset||i.Fieldset,this.Field=e.Field||this.Field||i.Field,this.NestedField=e.NestedField||this.NestedField||i.NestedField;var s=this.selectedFields=e.fields||t.keys(r),o=this.fields={};t.each(s,function(e){var t=r[e];o[e]=this.createField(e,t)},this);var u=e.fieldsets||t.result(this,"fieldsets")||t.result(this.model,"fieldsets")||[s],a=this.fieldsets=[];t.each(u,function(e){this.fieldsets.push(this.createFieldset(e))},this)},createFieldset:function(e){var t={schema:e,fields:this.fields,legend:e.legend||null};return new this.Fieldset(t)},createField:function(e,t){var n={form:this,key:e,schema:t,idPrefix:this.idPrefix};this.model?n.model=this.model:this.data?n.value=this.data[e]:n.value=null;var r=new this.Field(n);return this.listenTo(r.editor,"all",this.handleEditorEvent),r},handleEditorEvent:function(e,n){var r=n.key+":"+e;this.trigger.call(this,r,this,n,Array.prototype.slice.call(arguments,2));switch(e){case"change":this.trigger("change",this);break;case"focus":this.hasFocus||this.trigger("focus",this);break;case"blur":if(this.hasFocus){var i=this;setTimeout(function(){var e=t.find(i.fields,function(e){return e.editor.hasFocus});e||i.trigger("blur",i)},0)}}},templateData:function(){var e=this.options;return{submitButton:e.submitButton}},render:function(){var e=this,r=this.fields,i=n.$,s=i(i.trim(this.template(t.result(this,"templateData"))));return s.find("[data-editors]").add(s).each(function(n,s){var o=i(s),u=o.attr("data-editors");if(t.isUndefined(u))return;var a=u=="*"?e.selectedFields||t.keys(r):u.split(",");t.each(a,function(e){var t=r[e];o.append(t.editor.render().el)})}),s.find("[data-fields]").add(s).each(function(n,s){var o=i(s),u=o.attr("data-fields");if(t.isUndefined(u))return;var a=u=="*"?e.selectedFields||t.keys(r):u.split(",");t.each(a,function(e){var t=r[e];o.append(t.render().el)})}),s.find("[data-fieldsets]").add(s).each(function(n,r){var s=i(r),o=s.attr("data-fieldsets");if(t.isUndefined(o))return;t.each(e.fieldsets,function(e){s.append(e.render().el)})}),this.setElement(s),s.addClass(this.className),this},validate:function(e){var n=this,r=this.fields,i=this.model,s={};e=e||{},t.each(r,function(e){var t=e.validate();t&&(s[e.key]=t)});if(!e.skipModelValidate&&i&&i.validate){var o=i.validate(this.getValue());if(o){var u=t.isObject(o)&&!t.isArray(o);u||(s._others=s._others||[],s._others.push(o)),u&&t.each(o,function(e,t){if(r[t]&&!s[t])r[t].setError(e),s[t]=e;else{s._others=s._others||[];var n={};n[t]=e,s._others.push(n)}})}}return t.isEmpty(s)?null:s},commit:function(e){e=e||{};var n={skipModelValidate:!e.validate},r=this.validate(n);if(r)return r;var i,s=t.extend({error:function(e,t){i=t}},e);this.model.set(this.getValue(),s);if(i)return i},getValue:function(e){if(e)return this.fields[e].getValue();var n={};return t.each(this.fields,function(e){n[e.key]=e.getValue()}),n},setValue:function(e,t){var n={};typeof e=="string"?n[e]=t:n=e;var r;for(r in this.schema)n[r]!==undefined&&this.fields[r].setValue(n[r])},getEditor:function(e){var t=this.fields[e];if(!t)throw new Error("Field not found: "+e);return t.editor},focus:function(){if(this.hasFocus)return;var e=this.fieldsets[0],t=e.getFieldAt(0);if(!t)return;t.editor.focus()},blur:function(){if(!this.hasFocus)return;var e=t.find(this.fields,function(e){return e.editor.hasFocus});e&&e.editor.blur()},trigger:function(e){return e==="focus"?this.hasFocus=!0:e==="blur"&&(this.hasFocus=!1),n.View.prototype.trigger.apply(this,arguments)},remove:function(){return t.each(this.fieldsets,function(e){e.remove()}),t.each(this.fields,function(e){e.remove()}),n.View.prototype.remove.apply(this,arguments)}},{template:t.template('    <form>     <div data-fieldsets></div>      <% if (submitButton) { %>        <button type="submit"><%= submitButton %></button>      <% } %>    </form>  ',null,this.templateSettings),templateSettings:{evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},editors:{}});r.validators=function(){var e={};return e.errMessages={required:"Required",regexp:"Invalid",number:"Must be a number",email:"Invalid email address",url:"Invalid URL",match:t.template('Must match field "<%= field %>"',null,r.templateSettings)},e.required=function(e){return e=t.extend({type:"required",message:this.errMessages.required},e),function(r){e.value=r;var i={type:e.type,message:t.isFunction(e.message)?e.message(e):e.message};if(r===null||r===undefined||r===!1||r==="")return i}},e.regexp=function(e){if(!e.regexp)throw new Error('Missing required "regexp" option for "regexp" validator');return e=t.extend({type:"regexp",match:!0,message:this.errMessages.regexp},e),function(r){e.value=r;var i={type:e.type,message:t.isFunction(e.message)?e.message(e):e.message};if(r===null||r===undefined||r==="")return;"string"==typeof e.regexp&&(e.regexp=new RegExp(e.regexp,e.flags));if(e.match?!e.regexp.test(r):e.regexp.test(r))return i}},e.number=function(n){return n=t.extend({type:"number",message:this.errMessages.number,regexp:/^[0-9]*\.?[0-9]*?$/},n),e.regexp(n)},e.email=function(n){return n=t.extend({type:"email",message:this.errMessages.email,regexp:/^[\w\-]{1,}([\w\-\+.]{1,1}[\w\-]{1,}){0,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/},n),e.regexp(n)},e.url=function(n){return n=t.extend({type:"url",message:this.errMessages.url,regexp:/^(http|https):\/\/(([A-Z0-9][A-Z0-9_\-]*)(\.[A-Z0-9][A-Z0-9_\-]*)+)(:(\d+))?\/?/i},n),e.regexp(n)},e.match=function(e){if(!e.field)throw new Error('Missing required "field" options for "match" validator');return e=t.extend({type:"match",message:this.errMessages.match},e),function(r,i){e.value=r;var s={type:e.type,message:t.isFunction(e.message)?e.message(e):e.message};if(r===null||r===undefined||r==="")return;if(r!==i[e.field])return s}},e}(),r.Fieldset=n.View.extend({initialize:function(e){e=e||{};var n=this.schema=this.createSchema(e.schema);this.fields=t.pick(e.fields,n.fields),this.template=e.template||n.template||this.template||this.constructor.template},createSchema:function(e){return t.isArray(e)&&(e={fields:e}),e.legend=e.legend||null,e},getFieldAt:function(e){var t=this.schema.fields[e];return this.fields[t]},templateData:function(){return this.schema},render:function(){var e=this.schema,r=this.fields,i=n.$,s=i(i.trim(this.template(t.result(this,"templateData"))));return s.find("[data-fields]").add(s).each(function(e,n){var s=i(n),o=s.attr("data-fields");if(t.isUndefined(o))return;t.each(r,function(e){s.append(e.render().el)})}),this.setElement(s),this},remove:function(){t.each(this.fields,function(e){e.remove()}),n.View.prototype.remove.call(this)}},{template:t.template("    <fieldset data-fields>      <% if (legend) { %>        <legend><%= legend %></legend>      <% } %>    </fieldset>  ",null,r.templateSettings)}),r.Field=n.View.extend({initialize:function(e){e=e||{},t.extend(this,t.pick(e,"form","key","model","value","idPrefix"));var n=this.schema=this.createSchema(e.schema);this.template=e.template||n.template||this.template||this.constructor.template,this.errorClassName=e.errorClassName||this.errorClassName||this.constructor.errorClassName,this.editor=this.createEditor()},createSchema:function(e){return t.isString(e)&&(e={type:e}),e=t.extend({type:"Text",title:this.createTitle()},e),e.type=t.isString(e.type)?r.editors[e.type]:e.type,e},createEditor:function(){var e=t.extend(t.pick(this,"schema","form","key","model","value"),{id:this.createEditorId()}),n=this.schema.type;return new n(e)},createEditorId:function(){var e=this.idPrefix,n=this.key;return n=n.replace(/\./g,"_"),t.isString(e)||t.isNumber(e)?e+n:t.isNull(e)?n:this.model?this.model.cid+"_"+n:n},createTitle:function(){var e=this.key;return e=e.replace(/([A-Z])/g," $1"),e=e.replace(/^./,function(e){return e.toUpperCase()}),e},templateData:function(){var e=this.schema;return{help:e.help||"",title:e.title,titleHTML:e.titleHTML,fieldAttrs:e.fieldAttrs,editorAttrs:e.editorAttrs,key:this.key,editorId:this.editor.id}},render:function(){var e=this.schema,r=this.editor,i=n.$;if(this.editor.noField===!0)return this.setElement(r.render().el);var s=i(i.trim(this.template(t.result(this,"templateData"))));return e.fieldClass&&s.addClass(e.fieldClass),e.fieldAttrs&&s.attr(e.fieldAttrs),s.find("[data-editor]").add(s).each(function(e,n){var s=i(n),o=s.attr("data-editor");if(t.isUndefined(o))return;s.append(r.render().el)}),this.setElement(s),this},disable:function(){t.isFunction(this.editor.disable)?this.editor.disable():($input=this.editor.$el,$input=$input.is("input")?$input:$input.find("input"),$input.attr("disabled",!0))},enable:function(){t.isFunction(this.editor.enable)?this.editor.enable():($input=this.editor.$el,$input=$input.is("input")?$input:$input.find("input"),$input.attr("disabled",!1))},validate:function(){var e=this.editor.validate();return e?this.setError(e.message):this.clearError(),e},setError:function(e){if(this.editor.hasNestedForm)return;this.$el.addClass(this.errorClassName),this.$("[data-error]").html(e)},clearError:function(){this.$el.removeClass(this.errorClassName),this.$("[data-error]").empty()},commit:function(){return this.editor.commit()},getValue:function(){return this.editor.getValue()},setValue:function(e){this.editor.setValue(e)},focus:function(){this.editor.focus()},blur:function(){this.editor.blur()},remove:function(){this.editor.remove(),n.View.prototype.remove.call(this)}},{template:t.template('    <div>      <label for="<%= editorId %>">        <% if (titleHTML){ %><%= titleHTML %>        <% } else { %><%- title %><% } %>      </label>      <div>        <span data-editor></span>        <div data-error></div>        <div><%= help %></div>      </div>    </div>  ',null,r.templateSettings),errorClassName:"error"}),r.NestedField=r.Field.extend({template:t.template('    <div>      <label for="<%= editorId %>">        <% if (titleHTML){ %><%= titleHTML %>        <% } else { %><%- title %><% } %>      </label>      <div>        <span data-editor></span>        <div class="error-text" data-error></div>        <div class="error-help"><%= help %></div>      </div>    </div>  ',null,r.templateSettings)}),r.Editor=r.editors.Base=n.View.extend({defaultValue:null,hasFocus:!1,initialize:function(e){var e=e||{};if(e.model){if(!e.key)throw new Error("Missing option: 'key'");this.model=e.model,this.value=this.model.get(e.key)}else e.value!==undefined&&(this.value=e.value);this.value===undefined&&(this.value=this.defaultValue),t.extend(this,t.pick(e,"key","form"));var n=this.schema=e.schema||{};this.validators=e.validators||n.validators,this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),n.editorClass&&this.$el.addClass(n.editorClass),n.editorAttrs&&this.$el.attr(n.editorAttrs)},getName:function(){var e=this.key||"";return e.replace(/\./g,"_")},getValue:function(){return this.value},setValue:function(e){this.value=e},focus:function(){throw new Error("Not implemented")},blur:function(){throw new Error("Not implemented")},commit:function(e){var t=this.validate();if(t)return t;this.listenTo(this.model,"invalid",function(e,n){t=n}),this.model.set(this.key,this.getValue(),e);if(t)return t},validate:function(){var e=this.$el,n=null,r=this.getValue(),i=this.form?this.form.getValue():{},s=this.validators,o=this.getValidator;return s&&t.every(s,function(e){return n=o(e)(r,i),n?!1:!0}),n},trigger:function(e){return e==="focus"?this.hasFocus=!0:e==="blur"&&(this.hasFocus=!1),n.View.prototype.trigger.apply(this,arguments)},getValidator:function(e){var n=r.validators;if(t.isRegExp(e))return n.regexp({regexp:e});if(t.isString(e)){if(!n[e])throw new Error('Validator "'+e+'" not found');return n[e]()}if(t.isFunction(e))return e;if(t.isObject(e)&&e.type){var i=e;return n[i.type](i)}throw new Error("Invalid validator: "+e)}}),r.editors.Text=r.Editor.extend({tagName:"input",defaultValue:"",previousValue:"",events:{keyup:"determineChange",keypress:function(e){var t=this;setTimeout(function(){t.determineChange()},0)},select:function(e){this.trigger("select",this)},focus:function(e){this.trigger("focus",this)},blur:function(e){this.trigger("blur",this)}},initialize:function(e){r.editors.Base.prototype.initialize.call(this,e);var t=this.schema,n="text";t&&t.editorAttrs&&t.editorAttrs.type&&(n=t.editorAttrs.type),t&&t.dataType&&(n=t.dataType),this.$el.attr("type",n)},render:function(){return this.setValue(this.value),this},determineChange:function(e){var t=this.$el.val(),n=t!==this.previousValue;n&&(this.previousValue=t,this.trigger("change",this))},getValue:function(){return this.$el.val()},setValue:function(e){this.$el.val(e)},focus:function(){if(this.hasFocus)return;this.$el.focus()},blur:function(){if(!this.hasFocus)return;this.$el.blur()},select:function(){this.$el.select()}}),r.editors.TextArea=r.editors.Text.extend({tagName:"textarea",initialize:function(e){r.editors.Base.prototype.initialize.call(this,e)}}),r.editors.Password=r.editors.Text.extend({initialize:function(e){r.editors.Text.prototype.initialize.call(this,e),this.$el.attr("type","password")}}),r.editors.Number=r.editors.Text.extend({defaultValue:0,events:t.extend({},r.editors.Text.prototype.events,{keypress:"onKeyPress",change:"onKeyPress"}),initialize:function(e){r.editors.Text.prototype.initialize.call(this,e);var t=this.schema;this.$el.attr("type","number"),(!t||!t.editorAttrs||!t.editorAttrs.step)&&this.$el.attr("step","any")},onKeyPress:function(e){var t=this,n=function(){setTimeout(function(){t.determineChange()},0)};if(e.charCode===0){n();return}var r=this.$el.val();e.charCode!=undefined&&(r+=String.fromCharCode(e.charCode));var i=/^[0-9]*\.?[0-9]*?$/.test(r);i?n():e.preventDefault()},getValue:function(){var e=this.$el.val();return e===""?null:parseFloat(e,10)},setValue:function(e){e=function(){return t.isNumber(e)?e:t.isString(e)&&e!==""?parseFloat(e,10):null}(),t.isNaN(e)&&(e=null),r.editors.Text.prototype.setValue.call(this,e)}}),r.editors.Hidden=r.editors.Text.extend({defaultValue:"",noField:!0,initialize:function(e){r.editors.Text.prototype.initialize.call(this,e),this.$el.attr("type","hidden")},focus:function(){},blur:function(){}}),r.editors.Checkbox=r.editors.Base.extend({defaultValue:!1,tagName:"input",events:{click:function(e){this.trigger("change",this)},focus:function(e){this.trigger("focus",this)},blur:function(e){this.trigger("blur",this)}},initialize:function(e){r.editors.Base.prototype.initialize.call(this,e),this.$el.attr("type","checkbox")},render:function(){return this.setValue(this.value),this},getValue:function(){return this.$el.prop("checked")},setValue:function(e){e?this.$el.prop("checked",!0):this.$el.prop("checked",!1)},focus:function(){if(this.hasFocus)return;this.$el.focus()},blur:function(){if(!this.hasFocus)return;this.$el.blur()}}),r.editors.Select=r.editors.Base.extend({tagName:"select",previousValue:"",events:{keyup:"determineChange",keypress:function(e){var t=this;setTimeout(function(){t.determineChange()},0)},change:function(e){this.trigger("change",this)},focus:function(e){this.trigger("focus",this)},blur:function(e){this.trigger("blur",this)}},initialize:function(e){r.editors.Base.prototype.initialize.call(this,e);if(!this.schema||!this.schema.options)throw new Error("Missing required 'schema.options'")},render:function(){return this.setOptions(this.schema.options),this},setOptions:function(e){var r=this;if(e instanceof n.Collection){var i=e;i.length>0?this.renderOptions(e):i.fetch({success:function(t){r.renderOptions(e)}})}else t.isFunction(e)?e(function(e){r.renderOptions(e)},r):this.renderOptions(e)},renderOptions:function(e){var t=this.$el,n;n=this._getOptionsHtml(e),t.html(n),this.setValue(this.value)},_getOptionsHtml:function(e){var r;if(t.isString(e))r=e;else if(t.isArray(e))r=this._arrayToHtml(e);else if(e instanceof n.Collection)r=this._collectionToHtml(e);else if(t.isFunction(e)){var i;e(function(e){i=e},this),r=this._getOptionsHtml(i)}else r=this._objectToHtml(e);return r},determineChange:function(e){var t=this.getValue(),n=t!==this.previousValue;n&&(this.previousValue=t,this.trigger("change",this))},getValue:function(){return this.$el.val()},setValue:function(e){this.$el.val(e)},focus:function(){if(this.hasFocus)return;this.$el.focus()},blur:function(){if(!this.hasFocus)return;this.$el.blur()},_collectionToHtml:function(e){var t=[];e.each(function(e){t.push({val:e.id,label:e.toString()})});var n=this._arrayToHtml(t);return n},_objectToHtml:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({val:n,label:e[n]});var r=this._arrayToHtml(t);return r},_arrayToHtml:function(e){var n=$();return t.each(e,function(e){if(t.isObject(e))if(e.group){var r=$("<optgroup>").attr("label",e.group).html(this._getOptionsHtml(e.options));n=n.add(r)}else{var i=e.val||e.val===0?e.val:"";n=n.add($("<option>").val(i).text(e.label))}else n=n.add($("<option>").text(e))},this),n}}),r.editors.Radio=r.editors.Select.extend({tagName:"ul",events:{"change input[type=radio]":function(){this.trigger("change",this)},"focus input[type=radio]":function(){if(this.hasFocus)return;this.trigger("focus",this)},"blur input[type=radio]":function(){if(!this.hasFocus)return;var e=this;setTimeout(function(){if(e.$("input[type=radio]:focus")[0])return;e.trigger("blur",e)},0)}},getTemplate:function(){return this.schema.template||this.constructor.template},getValue:function(){return this.$("input[type=radio]:checked").val()},setValue:function(e){this.$("input[type=radio]").val([e])},focus:function(){if(this.hasFocus)return;var e=this.$("input[type=radio]:checked");if(e[0]){e.focus();return}this.$("input[type=radio]").first().focus()},blur:function(){if(!this.hasFocus)return;this.$("input[type=radio]:focus").blur()},_arrayToHtml:function(e){var n=this,r=this.getTemplate(),i=n.getName(),s=n.id,o=t.map(e,function(e,n){var r={name:i,id:s+"-"+n};return t.isObject(e)?(r.value=e.val||e.val===0?e.val:"",r.label=e.label,r.labelHTML=e.labelHTML):(r.value=e,r.label=e),r});return r({items:o})}},{template:t.template('    <% _.each(items, function(item) { %>      <li>        <input type="radio" name="<%= item.name %>" value="<%- item.value %>" id="<%= item.id %>" />        <label for="<%= item.id %>"><% if (item.labelHTML){ %><%= item.labelHTML %><% }else{ %><%- item.label %><% } %></label>      </li>    <% }); %>  ',null,r.templateSettings)}),r.editors.Checkboxes=r.editors.Select.extend({tagName:"ul",groupNumber:0,events:{"click input[type=checkbox]":function(){this.trigger("change",this)},"focus input[type=checkbox]":function(){if(this.hasFocus)return;this.trigger("focus",this)},"blur input[type=checkbox]":function(){if(!this.hasFocus)return;var e=this;setTimeout(function(){if(e.$("input[type=checkbox]:focus")[0])return;e.trigger("blur",e)},0)}},getValue:function(){var e=[];return this.$("input[type=checkbox]:checked").each(function(){e.push($(this).val())}),e},setValue:function(e){t.isArray(e)||(e=[e]),this.$("input[type=checkbox]").val(e)},focus:function(){if(this.hasFocus)return;this.$("input[type=checkbox]").first().focus()},blur:function(){if(!this.hasFocus)return;this.$("input[type=checkbox]:focus").blur()},_arrayToHtml:function(e){var n=$(),r=this;return t.each(e,function(e,i){var s=$("<li>");if(t.isObject(e))if(e.group){var o=r.id;r.id+="-"+r.groupNumber++,s=$('<fieldset class="group">').append($("<legend>").text(e.group)),s=s.append(r._arrayToHtml(e.options)),r.id=o,close=!1}else{var u=e.val||e.val===0?e.val:"";s.append($('<input type="checkbox" name="'+r.getName()+'" id="'+r.id+"-"+i+'" />').val(u)),e.labelHTML?s.append($('<label for="'+r.id+"-"+i+'">').html(e.labelHTML)):s.append($('<label for="'+r.id+"-"+i+'">').text(e.label))}else s.append($('<input type="checkbox" name="'+r.getName()+'" id="'+r.id+"-"+i+'" />').val(e)),s.append($('<label for="'+r.id+"-"+i+'">').text(e));n=n.add(s)}),n}}),r.editors.Object=r.editors.Base.extend({hasNestedForm:!0,initialize:function(e){this.value={},r.editors.Base.prototype.initialize.call(this,e);if(!this.form)throw new Error('Missing required option "form"');if(!this.schema.subSchema)throw new Error("Missing required 'schema.subSchema' option for Object editor")},render:function(){var e=this.form.constructor;return this.nestedForm=new e({schema:this.schema.subSchema,data:this.value,idPrefix:this.id+"_",Field:e.NestedField}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){return this.nestedForm?this.nestedForm.getValue():this.value},setValue:function(e){this.value=e,this.render()},focus:function(){if(this.hasFocus)return;this.nestedForm.focus()},blur:function(){if(!this.hasFocus)return;this.nestedForm.blur()},remove:function(){this.nestedForm.remove(),n.View.prototype.remove.call(this)},validate:function(){var e=t.extend({},r.editors.Base.prototype.validate.call(this),this.nestedForm.validate());return t.isEmpty(e)?!1:e},_observeFormEvents:function(){if(!this.nestedForm)return;this.nestedForm.on("all",function(){var e=t.toArray(arguments);e[1]=this,this.trigger.apply(this,e)},this)}}),r.editors.NestedModel=r.editors.Object.extend({initialize:function(e){r.editors.Base.prototype.initialize.call(this,e);if(!this.form)throw new Error('Missing required option "form"');if(!e.schema.model)throw new Error('Missing required "schema.model" option for NestedModel editor')},render:function(){var e=this.form.constructor,t=this.value||{},n=this.key,r=this.schema.model,i=t.constructor===r?t:new r(t);return this.nestedForm=new e({model:i,idPrefix:this.id+"_",fieldTemplate:"nestedField"}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},commit:function(){var e=this.nestedForm.commit();return e?(this.$el.addClass("error"),e):r.editors.Object.prototype.commit.call(this)}}),r.editors.Date=r.editors.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){if(this.hasFocus)return;this.trigger("focus",this)},"blur select":function(){if(!this.hasFocus)return;var e=this;setTimeout(function(){if(e.$("select:focus")[0])return;e.trigger("blur",e)},0)}},initialize:function(e){e=e||{},r.editors.Base.prototype.initialize.call(this,e);var n=r.editors.Date,i=new Date;this.options=t.extend({monthNames:n.monthNames,showMonthNames:n.showMonthNames},e),this.schema=t.extend({yearStart:i.getFullYear()-100,yearEnd:i.getFullYear()},e.schema||{}),this.value&&!t.isDate(this.value)&&(this.value=new Date(this.value));if(!this.value){var s=new Date;s.setSeconds(0),s.setMilliseconds(0),this.value=s}this.template=e.template||this.constructor.template},render:function(){var e=this.options,r=this.schema,i=n.$,s=t.map(t.range(1,32),function(e){return'<option value="'+e+'">'+e+"</option>"}),o=t.map(t.range(0,12),function(t){var n=e.showMonthNames?e.monthNames[t]:t+1;return'<option value="'+t+'">'+n+"</option>"}),u=r.yearStart<r.yearEnd?t.range(r.yearStart,r.yearEnd+1):t.range(r.yearStart,r.yearEnd-1,-1),a=t.map(u,function(e){return'<option value="'+e+'">'+e+"</option>"}),f=i(i.trim(this.template({dates:s.join(""),months:o.join(""),years:a.join("")})));return this.$date=f.find('[data-type="date"]'),this.$month=f.find('[data-type="month"]'),this.$year=f.find('[data-type="year"]'),this.$hidden=i('<input type="hidden" name="'+this.key+'" />'),f.append(this.$hidden),this.setValue(this.value),this.setElement(f),this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.$year.val(),t=this.$month.val(),n=this.$date.val();return!e||!t||!n?null:new Date(e,t,n)},setValue:function(e){this.$date.val(e.getDate()),this.$month.val(e.getMonth()),this.$year.val(e.getFullYear()),this.updateHidden()},focus:function(){if(this.hasFocus)return;this.$("select").first().focus()},blur:function(){if(!this.hasFocus)return;this.$("select:focus").blur()},updateHidden:function(){var e=this.getValue();t.isDate(e)&&(e=e.toISOString()),this.$hidden.val(e)}},{template:t.template('    <div>      <select data-type="date"><%= dates %></select>      <select data-type="month"><%= months %></select>      <select data-type="year"><%= years %></select>    </div>  ',null,r.templateSettings),showMonthNames:!0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"]}),r.editors.DateTime=r.editors.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){if(this.hasFocus)return;this.trigger("focus",this)},"blur select":function(){if(!this.hasFocus)return;var e=this;setTimeout(function(){if(e.$("select:focus")[0])return;e.trigger("blur",e)},0)}},initialize:function(e){e=e||{},r.editors.Base.prototype.initialize.call(this,e),this.options=t.extend({DateEditor:r.editors.DateTime.DateEditor},e),this.schema=t.extend({minsInterval:15},e.schema||{}),this.dateEditor=new this.options.DateEditor(e),this.value=this.dateEditor.value,this.template=e.template||this.constructor.template},render:function(){function e(e){return e<10?"0"+e:e}var r=this.schema,i=n.$,s=t.map(t.range(0,24),function(t){return'<option value="'+t+'">'+e(t)+"</option>"}),o=t.map(t.range(0,60,r.minsInterval),function(t){return'<option value="'+t+'">'+e(t)+"</option>"}),u=i(i.trim(this.template({hours:s.join(),mins:o.join()})));return u.find("[data-date]").append(this.dateEditor.render().el),this.$hour=u.find('select[data-type="hour"]'),this.$min=u.find('select[data-type="min"]'),this.$hidden=u.find('input[type="hidden"]'),this.setValue(this.value),this.setElement(u),this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.dateEditor.getValue(),t=this.$hour.val(),n=this.$min.val();return!e||!t||!n?null:(e.setHours(t),e.setMinutes(n),e)},setValue:function(e){t.isDate(e)||(e=new Date(e)),this.dateEditor.setValue(e),this.$hour.val(e.getHours()),this.$min.val(e.getMinutes()),this.updateHidden()},focus:function(){if(this.hasFocus)return;this.$("select").first().focus()},blur:function(){if(!this.hasFocus)return;this.$("select:focus").blur()},updateHidden:function(){var e=this.getValue();t.isDate(e)&&(e=e.toISOString()),this.$hidden.val(e)},remove:function(){this.dateEditor.remove(),r.editors.Base.prototype.remove.call(this)}},{template:t.template('    <div class="bbf-datetime">      <div class="bbf-date-container" data-date></div>      <select data-type="hour"><%= hours %></select>      :      <select data-type="min"><%= mins %></select>    </div>  ',null,r.templateSettings),DateEditor:r.editors.Date}),r.VERSION="0.14.0",n.Form=r,typeof module!="undefined"&&(module.exports=r)}(window||global||this);if(typeof jQuery=="undefined")throw new Error("Bootstrap's JavaScript requires jQuery");+function(e){"use strict";var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||t[0]==1&&t[1]==9&&t[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(e){"use strict";function r(t){return this.each(function(){var r=e(this),i=r.data("bs.alert");i||r.data("bs.alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})}var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.VERSION="3.3.2",n.TRANSITION_DURATION=150,n.prototype.close=function(t){function o(){s.detach().trigger("closed.bs.alert").remove()}var r=e(this),i=r.attr("data-target");i||(i=r.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,""));var s=e(i);t&&t.preventDefault(),s.length||(s=r.closest(".alert")),s.trigger(t=e.Event("close.bs.alert"));if(t.isDefaultPrevented())return;s.removeClass("in"),e.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",o).emulateTransitionEnd(n.TRANSITION_DURATION):o()};var i=e.fn.alert;e.fn.alert=r,e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=i,this},e(document).on("click.bs.alert.data-api",t,n.prototype.close)}(jQuery),+function(e){"use strict";function n(n){return this.each(function(){var r=e(this),i=r.data("bs.button"),s=typeof n=="object"&&n;i||r.data("bs.button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})}var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.isLoading=!1};t.VERSION="3.3.2",t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(t){var n="disabled",r=this.$element,i=r.is("input")?"val":"html",s=r.data();t+="Text",s.resetText==null&&r.data("resetText",r[i]()),setTimeout(e.proxy(function(){r[i](s[t]==null?this.options[t]:s[t]),t=="loadingText"?(this.isLoading=!0,r.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,r.removeClass(n).removeAttr(n))},this),0)},t.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var n=this.$element.find("input");n.prop("type")=="radio"&&(n.prop("checked")&&this.$element.hasClass("active")?e=!1:t.find(".active").removeClass("active")),e&&n.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));e&&this.$element.toggleClass("active")};var r=e.fn.button;e.fn.button=n,e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=r,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var r=e(t.target);r.hasClass("btn")||(r=r.closest(".btn")),n.call(r,"toggle"),t.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){e(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),+function(e){"use strict";function n(n){return this.each(function(){var r=e(this),i=r.data("bs.carousel"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("bs.carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})}var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=this.sliding=this.interval=this.$active=this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",e.proxy(this.keydown,this)),this.options.pause=="hover"&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",e.proxy(this.pause,this)).on("mouseleave.bs.carousel",e.proxy(this.cycle,this))};t.VERSION="3.3.2",t.TRANSITION_DURATION=600,t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},t.prototype.keydown=function(e){if(/input|textarea/i.test(e.target.tagName))return;switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()},t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},t.prototype.getItemIndex=function(e){return this.$items=e.parent().children(".item"),this.$items.index(e||this.$active)},t.prototype.getItemForDirection=function(e,t){var n=this.getItemIndex(t),r=e=="prev"&&n===0||e=="next"&&n==this.$items.length-1;if(r&&!this.options.wrap)return t;var i=e=="prev"?-1:1,s=(n+i)%this.$items.length;return this.$items.eq(s)},t.prototype.to=function(e){var t=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(e>this.$items.length-1||e<0)return;return this.sliding?this.$element.one("slid.bs.carousel",function(){t.to(e)}):n==e?this.pause().cycle():this.slide(e>n?"next":"prev",this.$items.eq(e))},t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){if(this.sliding)return;return this.slide("next")},t.prototype.prev=function(){if(this.sliding)return;return this.slide("prev")},t.prototype.slide=function(n,r){var i=this.$element.find(".item.active"),s=r||this.getItemForDirection(n,i),o=this.interval,u=n=="next"?"left":"right",a=this;if(s.hasClass("active"))return this.sliding=!1;var f=s[0],l=e.Event("slide.bs.carousel",{relatedTarget:f,direction:u});this.$element.trigger(l);if(l.isDefaultPrevented())return;this.sliding=!0,o&&this.pause();if(this.$indicators.length){this.$indicators.find(".active").removeClass("active");var c=e(this.$indicators.children()[this.getItemIndex(s)]);c&&c.addClass("active")}var h=e.Event("slid.bs.carousel",{relatedTarget:f,direction:u});return e.support.transition&&this.$element.hasClass("slide")?(s.addClass(n),s[0].offsetWidth,i.addClass(u),s.addClass(u),i.one("bsTransitionEnd",function(){s.removeClass([n,u].join(" ")).addClass("active"),i.removeClass(["active",u].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger(h)},0)}).emulateTransitionEnd(t.TRANSITION_DURATION)):(i.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger(h)),o&&this.cycle(),this};var r=e.fn.carousel;e.fn.carousel=n,e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=r,this};var i=function(t){var r,i=e(this),s=e(i.attr("data-target")||(r=i.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""));if(!s.hasClass("carousel"))return;var o=e.extend({},s.data(),i.data()),u=i.attr("data-slide-to");u&&(o.interval=!1),n.call(s,o),u&&s.data("bs.carousel").to(u),t.preventDefault()};e(document).on("click.bs.carousel.data-api","[data-slide]",i).on("click.bs.carousel.data-api","[data-slide-to]",i),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var t=e(this);n.call(t,t.data())})})}(jQuery),+function(e){"use strict";function i(r){if(r&&r.which===3)return;e(t).remove(),e(n).each(function(){var t=e(this),n=s(t),i={relatedTarget:this};if(!n.hasClass("open"))return;n.trigger(r=e.Event("hide.bs.dropdown",i));if(r.isDefaultPrevented())return;t.attr("aria-expanded","false"),n.removeClass("open").trigger("hidden.bs.dropdown",i)})}function s(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}function o(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})}var t=".dropdown-backdrop",n='[data-toggle="dropdown"]',r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.VERSION="3.3.2",r.prototype.toggle=function(t){var n=e(this);if(n.is(".disabled, :disabled"))return;var r=s(n),o=r.hasClass("open");i();if(!o){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",i);var u={relatedTarget:this};r.trigger(t=e.Event("show.bs.dropdown",u));if(t.isDefaultPrevented())return;n.trigger("focus").attr("aria-expanded","true"),r.toggleClass("open").trigger("shown.bs.dropdown",u)}return!1},r.prototype.keydown=function(t){if(!/(38|40|27|32)/.test(t.which)||/input|textarea/i.test(t.target.tagName))return;var r=e(this);t.preventDefault(),t.stopPropagation();if(r.is(".disabled, :disabled"))return;var i=s(r),o=i.hasClass("open");if(!o&&t.which!=27||o&&t.which==27)return t.which==27&&i.find(n).trigger("focus"),r.trigger("click");var u=" li:not(.divider):visible a",a=i.find('[role="menu"]'+u+', [role="listbox"]'+u);if(!a.length)return;var f=a.index(t.target);t.which==38&&f>0&&f--,t.which==40&&f<a.length-1&&f++,~f||(f=0),a.eq(f).trigger("focus")};var u=e.fn.dropdown;e.fn.dropdown=o,e.fn.dropdown.Constructor=r,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=u,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n,r.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',r.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',r.prototype.keydown)}(jQuery),+function(e){"use strict";function n(n,r){return this.each(function(){var i=e(this),s=i.data("bs.modal"),o=e.extend({},t.DEFAULTS,i.data(),typeof n=="object"&&n);s||i.data("bs.modal",s=new t(this,o)),typeof n=="string"?s[n](r):o.show&&s.show(r)})}var t=function(t,n){this.options=n,this.$body=e(document.body),this.$element=e(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};t.VERSION="3.3.2",t.TRANSITION_DURATION=300,t.BACKDROP_TRANSITION_DURATION=150,t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},t.prototype.show=function(n){var r=this,i=e.Event("show.bs.modal",{relatedTarget:n});this.$element.trigger(i);if(this.isShown||i.isDefaultPrevented())return;this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var i=e.support.transition&&r.$element.hasClass("fade");r.$element.parent().length||r.$element.appendTo(r.$body),r.$element.show().scrollTop(0),r.options.backdrop&&r.adjustBackdrop(),r.adjustDialog(),i&&r.$element[0].offsetWidth,r.$element.addClass("in").attr("aria-hidden",!1),r.enforceFocus();var s=e.Event("shown.bs.modal",{relatedTarget:n});i?r.$element.find(".modal-dialog").one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(t.TRANSITION_DURATION):r.$element.trigger("focus").trigger(s)})},t.prototype.hide=function(n){n&&n.preventDefault(),n=e.Event("hide.bs.modal"),this.$element.trigger(n);if(!this.isShown||n.isDefaultPrevented())return;this.isShown=!1,this.escape(),this.resize(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal()},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]!==e.target&&!this.$element.has(e.target).length&&this.$element.trigger("focus")},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy(function(e){e.which==27&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},t.prototype.resize=function(){this.isShown?e(window).on("resize.bs.modal",e.proxy(this.handleUpdate,this)):e(window).off("resize.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$body.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(n){var r=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=e.support.transition&&i;this.$backdrop=e('<div class="modal-backdrop '+i+'" />').prependTo(this.$element).on("click.dismiss.bs.modal",e.proxy(function(e){if(e.target!==e.currentTarget)return;this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this)},this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!n)return;s?this.$backdrop.one("bsTransitionEnd",n).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):n()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){r.removeBackdrop(),n&&n()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):o()}else n&&n()},t.prototype.handleUpdate=function(){this.options.backdrop&&this.adjustBackdrop(),this.adjustDialog()},t.prototype.adjustBackdrop=function(){this.$backdrop.css("height",0).css("height",this.$element[0].scrollHeight)},t.prototype.adjustDialog=function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},t.prototype.checkScrollbar=function(){this.bodyIsOverflowing=document.body.scrollHeight>document.documentElement.clientHeight,this.scrollbarWidth=this.measureScrollbar()},t.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.bodyIsOverflowing&&this.$body.css("padding-right",e+this.scrollbarWidth)},t.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},t.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var r=e.fn.modal;e.fn.modal=n,e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=r,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var r=e(this),i=r.attr("href"),s=e(r.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),o=s.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(i)&&i},s.data(),r.data());r.is("a")&&t.preventDefault(),s.one("show.bs.modal",function(e){if(e.isDefaultPrevented())return;s.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus")})}),n.call(s,o,this)})}(jQuery),+function(e){"use strict";function n(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s=typeof n=="object"&&n;if(!i&&n=="destroy")return;i||r.data("bs.tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})}var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.VERSION="3.3.2",t.TRANSITION_DURATION=150,t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);var i=this.options.trigger.split(" ");for(var s=i.length;s--;){var o=i[s];if(o=="click")this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if(o!="manual"){var u=o=="hover"?"mouseenter":"focusin",a=o=="hover"?"mouseleave":"focusout";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(n&&n.$tip&&n.$tip.is(":visible")){n.hoverState="in";return}n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="in";if(!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="out";if(!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},t.prototype.show=function(){var n=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(n);var r=e.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(n.isDefaultPrevented()||!r)return;var i=this,s=this.tip(),o=this.getUID(this.type);this.setContent(),s.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&s.addClass("fade");var u=typeof this.options.placement=="function"?this.options.placement.call(this,s[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,f=a.test(u);f&&(u=u.replace(a,"")||"top"),s.detach().css({top:0,left:0,display:"block"}).addClass(u).data("bs."+this.type,this),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element);var l=this.getPosition(),c=s[0].offsetWidth,h=s[0].offsetHeight;if(f){var p=u,d=this.options.container?e(this.options.container):this.$element.parent(),v=this.getPosition(d);u=u=="bottom"&&l.bottom+h>v.bottom?"top":u=="top"&&l.top-h<v.top?"bottom":u=="right"&&l.right+c>v.width?"left":u=="left"&&l.left-c<v.left?"right":u,s.removeClass(p).addClass(u)}var m=this.getCalculatedOffset(u,l,c,h);this.applyPlacement(m,u);var g=function(){var e=i.hoverState;i.$element.trigger("shown.bs."+i.type),i.hoverState=null,e=="out"&&i.leave(i)};e.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",g).emulateTransitionEnd(t.TRANSITION_DURATION):g()}},t.prototype.applyPlacement=function(t,n){var r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(u)&&(u=0),t.top=t.top+o,t.left=t.left+u,e.offset.setOffset(r[0],e.extend({using:function(e){r.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),r.addClass("in");var a=r[0].offsetWidth,f=r[0].offsetHeight;n=="top"&&f!=s&&(t.top=t.top+s-f);var l=this.getViewportAdjustedDelta(n,t,a,f);l.left?t.left+=l.left:t.top+=l.top;var c=/top|bottom/.test(n),h=c?l.left*2-i+a:l.top*2-s+f,p=c?"offsetWidth":"offsetHeight";r.offset(t),this.replaceArrow(h,r[0][p],c)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n?"left":"top",50*(1-e/t)+"%").css(n?"top":"left","")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(n){function o(){r.hoverState!="in"&&i.detach(),r.$element.removeAttr("aria-describedby").trigger("hidden.bs."+r.type),n&&n()}var r=this,i=this.tip(),s=e.Event("hide.bs."+this.type);this.$element.trigger(s);if(s.isDefaultPrevented())return;return i.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",o).emulateTransitionEnd(t.TRANSITION_DURATION):o(),this.hoverState=null,this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(t){t=t||this.$element;var n=t[0],r=n.tagName=="BODY",i=n.getBoundingClientRect();i.width==null&&(i=e.extend({},i,{width:i.right-i.left,height:i.bottom-i.top}));var s=r?{top:0,left:0}:t.offset(),o={scroll:r?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},u=r?{width:e(window).width(),height:e(window).height()}:null;return e.extend({},i,o,u,s)},t.prototype.getCalculatedOffset=function(e,t,n,r){return e=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-n/2}:e=="top"?{top:t.top-r,left:t.left+t.width/2-n/2}:e=="left"?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getViewportAdjustedDelta=function(e,t,n,r){var i={top:0,left:0};if(!this.$viewport)return i;var s=this.options.viewport&&this.options.viewport.padding||0,o=this.getPosition(this.$viewport);if(/right|left/.test(e)){var u=t.top-s-o.scroll,a=t.top+s-o.scroll+r;u<o.top?i.top=o.top-u:a>o.top+o.height&&(i.top=o.top+o.height-a)}else{var f=t.left-s,l=t.left+s+n;f<o.left?i.left=o.left-f:l>o.width&&(i.left=o.left+o.width-l)}return i},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},t.prototype.getUID=function(e){do e+=~~(Math.random()*1e6);while(document.getElementById(e));return e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=this;t&&(n=e(t.currentTarget).data("bs."+this.type),n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n))),n.tip().hasClass("in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){var e=this;clearTimeout(this.timeout),this.hide(function(){e.$element.off("."+e.type).removeData("bs."+e.type)})};var r=e.fn.tooltip;e.fn.tooltip=n,e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=r,this}}(jQuery),+function(e){"use strict";function n(n){return this.each(function(){var r=e(this),i=r.data("bs.popover"),s=typeof n=="object"&&n;if(!i&&n=="destroy")return;i||r.data("bs.popover",i=new t(this,s)),typeof n=="string"&&i[n]()})}var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.3.2",t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?typeof n=="string"?"html":"append":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||(typeof t.content=="function"?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var r=e.fn.popover;e.fn.popover=n,e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=r,this}}(jQuery),+function(e){"use strict";function n(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),typeof n=="string"&&i[n]()})}var t=function(t){this.element=e(t)};t.VERSION="3.3.2",t.TRANSITION_DURATION=150,t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.data("target");r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;var i=n.find(".active:last a"),s=e.Event("hide.bs.tab",{relatedTarget:t[0]}),o=e.Event("show.bs.tab",{relatedTarget:i[0]});i.trigger(s),t.trigger(o);if(o.isDefaultPrevented()||s.isDefaultPrevented())return;var u=e(r);this.activate(t.closest("li"),n),this.activate(u,u.parent(),function(){i.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:i[0]})})},t.prototype.activate=function(n,r,i){function u(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),n.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),o?(n[0].offsetWidth,n.addClass("in")):n.removeClass("fade"),n.parent(".dropdown-menu")&&n.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}var s=r.find("> .active"),o=i&&e.support.transition&&(s.length&&s.hasClass("fade")||!!r.find("> .fade").length);s.length&&o?s.one("bsTransitionEnd",u).emulateTransitionEnd(t.TRANSITION_DURATION):u(),s.removeClass("in")};var r=e.fn.tab;e.fn.tab=n,e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=r,this};var i=function(t){t.preventDefault(),n.call(e(this),"show")};e(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery),+function(e){"use strict";function n(n){return this.each(function(){var r=e(this),i=r.data("bs.affix"),s=typeof n=="object"&&n;i||r.data("bs.affix",i=new t(this,s)),typeof n=="string"&&i[n]()})}var t=function(n,r){this.options=e.extend({},t.DEFAULTS,r),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};t.VERSION="3.3.2",t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0,target:window},t.prototype.getState=function(e,t,n,r){var i=this.$target.scrollTop(),s=this.$element.offset(),o=this.$target.height();if(n!=null&&this.affixed=="top")return i<n?"top":!1;if(this.affixed=="bottom")return n!=null?i+this.unpin<=s.top?!1:"bottom":i+o<=e-r?!1:"bottom";var u=this.affixed==null,a=u?i:s.top,f=u?o:t;return n!=null&&i<=n?"top":r!=null&&a+f>=e-r?"bottom":!1},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var e=this.$target.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var n=this.$element.height(),r=this.options.offset,i=r.top,s=r.bottom,o=e("body").height();typeof r!="object"&&(s=i=r),typeof i=="function"&&(i=r.top(this.$element)),typeof s=="function"&&(s=r.bottom(this.$element));var u=this.getState(o,n,i,s);if(this.affixed!=u){this.unpin!=null&&this.$element.css("top","");var a="affix"+(u?"-"+u:""),f=e.Event(a+".bs.affix");this.$element.trigger(f);if(f.isDefaultPrevented())return;this.affixed=u,this.unpin=u=="bottom"?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(a).trigger(a.replace("affix","affixed")+".bs.affix")}u=="bottom"&&this.$element.offset({top:o-n-s})};var r=e.fn.affix;e.fn.affix=n,e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=r,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),r=t.data();r.offset=r.offset||{},r.offsetBottom!=null&&(r.offset.bottom=r.offsetBottom),r.offsetTop!=null&&(r.offset.top=r.offsetTop),n.call(t,r)})})}(jQuery),+function(e){"use strict";function n(t){var n,r=t.attr("data-target")||(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return e(r)}function r(n){return this.each(function(){var r=e(this),i=r.data("bs.collapse"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n);!i&&s.toggle&&n=="show"&&(s.toggle=!1),i||r.data("bs.collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})}var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.$trigger=e(this.options.trigger).filter('[href="#'+n.id+'"], [data-target="#'+n.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};t.VERSION="3.3.2",t.TRANSITION_DURATION=350,t.DEFAULTS={toggle:!0,trigger:'[data-toggle="collapse"]'},t.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},t.prototype.show=function(){if(this.transitioning||this.$element.hasClass("in"))return;var n,i=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(i&&i.length){n=i.data("bs.collapse");if(n&&n.transitioning)return}var s=e.Event("show.bs.collapse");this.$element.trigger(s);if(s.isDefaultPrevented())return;i&&i.length&&(r.call(i,"hide"),n||i.data("bs.collapse",null));var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var u=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return u.call(this);var a=e.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",e.proxy(u,this)).emulateTransitionEnd(t.TRANSITION_DURATION)[o](this.$element[0][a])},t.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass("in"))return;var n=e.Event("hide.bs.collapse");this.$element.trigger(n);if(n.isDefaultPrevented())return;var r=this.dimension();this.$element[r](this.$element[r]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!e.support.transition)return i.call(this);this.$element[r](0).one("bsTransitionEnd",e.proxy(i,this)).emulateTransitionEnd(t.TRANSITION_DURATION)},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},t.prototype.getParent=function(){return e(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(e.proxy(function(t,r){var i=e(r);this.addAriaAndCollapsedClass(n(i),i)},this)).end()},t.prototype.addAriaAndCollapsedClass=function(e,t){var n=e.hasClass("in");e.attr("aria-expanded",n),t.toggleClass("collapsed",!n).attr("aria-expanded",n)};var i=e.fn.collapse;e.fn.collapse=r,e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=i,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var i=e(this);i.attr("data-target")||t.preventDefault();var s=n(i),o=s.data("bs.collapse"),u=o?"toggle":e.extend({},i.data(),{trigger:this});r.call(s,u)})}(jQuery),+function(e){"use strict";function t(n,r){var i=e.proxy(this.process,this);this.$body=e("body"),this.$scrollElement=e(n).is("body")?e(window):e(n),this.options=e.extend({},t.DEFAULTS,r),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",i),this.refresh(),this.process()}function n(n){return this.each(function(){var r=e(this),i=r.data("bs.scrollspy"),s=typeof n=="object"&&n;i||r.data("bs.scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})}t.VERSION="3.3.2",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t="offset",n=0;e.isWindow(this.$scrollElement[0])||(t="position",n=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var r=this;this.$body.find(this.selector).map(function(){var r=e(this),i=r.data("target")||r.attr("href"),s=/^#./.test(i)&&e(i);return s&&s.length&&s.is(":visible")&&[[s[t]().top+n,i]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){r.offsets.push(this[0]),r.targets.push(this[1])})},t.prototype.process=function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.getScrollHeight(),n=this.options.offset+t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;this.scrollHeight!=t&&this.refresh();if(e>=n)return s!=(o=i[i.length-1])&&this.activate(o);if(s&&e<r[0])return this.activeTarget=null,this.clear();for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},t.prototype.activate=function(t){this.activeTarget=t,this.clear();var n=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',r=e(n).parents("li").addClass("active");r.parent(".dropdown-menu").length&&(r=r.closest("li.dropdown").addClass("active")),r.trigger("activate.bs.scrollspy")},t.prototype.clear=function(){e(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var r=e.fn.scrollspy;e.fn.scrollspy=n,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=r,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);n.call(t,t.data())})})}(jQuery),+function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(e.style[n]!==undefined)return{end:t[n]};return!1}e.fn.emulateTransitionEnd=function(t){var n=!1,r=this;e(this).one("bsTransitionEnd",function(){n=!0});var i=function(){n||e(r).trigger(e.support.transition.end)};return setTimeout(i,t),this},e(function(){e.support.transition=t();if(!e.support.transition)return;e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}}})}(jQuery),function(e){"use strict";var t=function(t,n){this.options=e.extend({},e.fn.editableform.defaults,n),this.$div=e(t),this.options.scope||(this.options.scope=this)};t.prototype={constructor:t,initInput:function(){this.input=this.options.input,this.value=this.input.str2value(this.options.value),this.input.prerender()},initTemplate:function(){this.$form=e(e.fn.editableform.template)},initButtons:function(){var t=this.$form.find(".editable-buttons");t.append(e.fn.editableform.buttons),this.options.showbuttons==="bottom"&&t.addClass("editable-buttons-bottom")},render:function(){this.$loading=e(e.fn.editableform.loading),this.$div.empty().append(this.$loading),this.initTemplate(),this.options.showbuttons?this.initButtons():this.$form.find(".editable-buttons").remove(),this.showLoading(),this.isSaving=!1,this.$div.triggerHandler("rendering"),this.initInput(),this.$form.find("div.editable-input").append(this.input.$tpl),this.$div.append(this.$form),e.when(this.input.render()).then(e.proxy(function(){this.options.showbuttons||this.input.autosubmit(),this.$form.find(".editable-cancel").click(e.proxy(this.cancel,this));if(this.input.error)this.error(this.input.error),this.$form.find(".editable-submit").attr("disabled",!0),this.input.$input.attr("disabled",!0),this.$form.submit(function(e){e.preventDefault()});else{this.error(!1),this.input.$input.removeAttr("disabled"),this.$form.find(".editable-submit").removeAttr("disabled");var t=this.value===null||this.value===undefined||this.value===""?this.options.defaultValue:this.value;this.input.value2input(t),this.$form.submit(e.proxy(this.submit,this))}this.$div.triggerHandler("rendered"),this.showForm(),this.input.postrender&&this.input.postrender()},this))},cancel:function(){this.$div.triggerHandler("cancel")},showLoading:function(){var e,t;this.$form?(e=this.$form.outerWidth(),t=this.$form.outerHeight(),e&&this.$loading.width(e),t&&this.$loading.height(t),this.$form.hide()):(e=this.$loading.parent().width(),e&&this.$loading.width(e)),this.$loading.show()},showForm:function(e){this.$loading.hide(),this.$form.show(),e!==!1&&this.input.activate(),this.$div.triggerHandler("show")},error:function(t){var n=this.$form.find(".control-group"),r=this.$form.find(".editable-error-block"),i;if(t===!1)n.removeClass(e.fn.editableform.errorGroupClass),r.removeClass(e.fn.editableform.errorBlockClass).empty().hide();else{if(t){i=(""+t).split("\n");for(var s=0;s<i.length;s++)i[s]=e("<div>").text(i[s]).html();t=i.join("<br>")}n.addClass(e.fn.editableform.errorGroupClass),r.addClass(e.fn.editableform.errorBlockClass).html(t).show()}},submit:function(t){t.stopPropagation(),t.preventDefault();var n=this.input.input2value(),r=this.validate(n);if(e.type(r)==="object"&&r.newValue!==undefined){n=r.newValue,this.input.value2input(n);if(typeof r.msg=="string"){this.error(r.msg),this.showForm();return}}else if(r){this.error(r),this.showForm();return}if(!this.options.savenochange&&this.input.value2str(n)==this.input.value2str(this.value)){this.$div.triggerHandler("nochange");return}var i=this.input.value2submit(n);this.isSaving=!0,e.when(this.save(i)).done(e.proxy(function(e){this.isSaving=!1;var t=typeof this.options.success=="function"?this.options.success.call(this.options.scope,e,n):null;if(t===!1){this.error(!1),this.showForm(!1);return}if(typeof t=="string"){this.error(t),this.showForm();return}t&&typeof t=="object"&&t.hasOwnProperty("newValue")&&(n=t.newValue),this.error(!1),this.value=n,this.$div.triggerHandler("save",{newValue:n,submitValue:i,response:e})},this)).fail(e.proxy(function(e){this.isSaving=!1;var t;typeof this.options.error=="function"?t=this.options.error.call(this.options.scope,e,n):t=typeof e=="string"?e:e.responseText||e.statusText||"Unknown error!",this.error(t),this.showForm()},this))},save:function(t){this.options.pk=e.fn.editableutils.tryParseJson(this.options.pk,!0);var n=typeof this.options.pk=="function"?this.options.pk.call(this.options.scope):this.options.pk,r=!!(typeof this.options.url=="function"||this.options.url&&(this.options.send==="always"||this.options.send==="auto"&&n!==null&&n!==undefined)),i;if(r)return this.showLoading(),i={name:this.options.name||"",value:t,pk:n},typeof this.options.params=="function"?i=this.options.params.call(this.options.scope,i):(this.options.params=e.fn.editableutils.tryParseJson(this.options.params,!0),e.extend(i,this.options.params)),typeof this.options.url=="function"?this.options.url.call(this.options.scope,i):e.ajax(e.extend({url:this.options.url,data:i,type:"POST"},this.options.ajaxOptions))},validate:function(e){e===undefined&&(e=this.value);if(typeof this.options.validate=="function")return this.options.validate.call(this.options.scope,e)},option:function(e,t){e in this.options&&(this.options[e]=t),e==="value"&&this.setValue(t)},setValue:function(e,t){t?this.value=this.input.str2value(e):this.value=e,this.$form&&this.$form.is(":visible")&&this.input.value2input(this.value)}},e.fn.editableform=function(n){var r=arguments;return this.each(function(){var i=e(this),s=i.data("editableform"),o=typeof n=="object"&&n;s||i.data("editableform",s=new t(this,o)),typeof n=="string"&&s[n].apply(s,Array.prototype.slice.call(r,1))})},e.fn.editableform.Constructor=t,e.fn.editableform.defaults={type:"text",url:null,params:null,name:null,pk:null,value:null,defaultValue:null,send:"auto",validate:null,success:null,error:null,ajaxOptions:null,showbuttons:!0,scope:null,savenochange:!1},e.fn.editableform.template='<form class="form-inline editableform"><div class="control-group"><div><div class="editable-input"></div><div class="editable-buttons"></div></div><div class="editable-error-block"></div></div></form>',e.fn.editableform.loading='<div class="editableform-loading"></div>',e.fn.editableform.buttons='<button type="submit" class="editable-submit">ok</button><button type="button" class="editable-cancel">cancel</button>',e.fn.editableform.errorGroupClass=null,e.fn.editableform.errorBlockClass="editable-error",e.fn.editableform.engine="jquery"}(window.jQuery),function(e){"use strict";e.fn.editableutils={inherit:function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.superclass=t.prototype},setCursorPosition:function(e,t){if(e.setSelectionRange)e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}},tryParseJson:function(e,t){if(typeof e=="string"&&e.length&&e.match(/^[\{\[].*[\}\]]$/))if(t)try{e=(new Function("return "+e))()}catch(n){}finally{return e}else e=(new Function("return "+e))();return e},sliceObj:function(t,n,r){var i,s,o={};if(!e.isArray(n)||!n.length)return o;for(var u=0;u<n.length;u++){i=n[u],t.hasOwnProperty(i)&&(o[i]=t[i]);if(r===!0)continue;s=i.toLowerCase(),t.hasOwnProperty(s)&&(o[i]=t[s])}return o},getConfigData:function(t){var n={};return e.each(t.data(),function(e,t){if(typeof t!="object"||t&&typeof t=="object"&&(t.constructor===Object||t.constructor===Array))n[e]=t}),n},objectKeys:function(e){if(Object.keys)return Object.keys(e);if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t=[],n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},escape:function(t){return e("<div>").text(t).html()},itemsByValue:function(t,n,r){if(!n||t===null)return[];if(typeof r!="function"){var i=r||"value";r=function(e){return e[i]}}var s=e.isArray(t),o=[],u=this;return e.each(n,function(n,i){if(i.children)o=o.concat(u.itemsByValue(t,i.children,r));else if(s)e.grep(t,function(e){return e==(i&&typeof i==="object"?r(i):i)}).length&&o.push(i);else{var a=i&&typeof i=="object"?r(i):i;t==a&&o.push(i)}}),o},createInput:function(t){var n,r,i,s=t.type;return s==="date"&&(t.mode==="inline"?e.fn.editabletypes.datefield?s="datefield":e.fn.editabletypes.dateuifield&&(s="dateuifield"):e.fn.editabletypes.date?s="date":e.fn.editabletypes.dateui&&(s="dateui"),s==="date"&&!e.fn.editabletypes.date&&(s="combodate")),s==="datetime"&&t.mode==="inline"&&(s="datetimefield"),s==="wysihtml5"&&!e.fn.editabletypes[s]&&(s="textarea"),typeof e.fn.editabletypes[s]=="function"?(n=e.fn.editabletypes[s],r=this.sliceObj(t,this.objectKeys(n.defaults)),i=new n(r),i):(e.error("Unknown type: "+s),!1)},supportsTransitions:function(){var e=document.body||document.documentElement,t=e.style,n="transition",r=["Moz","Webkit","Khtml","O","ms"];if(typeof t[n]=="string")return!0;n=n.charAt(0).toUpperCase()+n.substr(1);for(var i=0;i<r.length;i++)if(typeof t[r[i]+n]=="string")return!0;return!1}}}(window.jQuery),function(e){"use strict";var t=function(e,t){this.init(e,t)},n=function(e,t){this.init(e,t)};t.prototype={containerName:null,containerDataName:null,innerCss:null,containerClass:"editable-container editable-popup",defaults:{},init:function(n,r){this.$element=e(n),this.options=e.extend({},e.fn.editableContainer.defaults,r),this.splitOptions(),this.formOptions.scope=this.$element[0],this.initContainer(),this.delayedHide=!1,this.$element.on("destroyed",e.proxy(function(){this.destroy()},this)),e(document).data("editable-handlers-attached")||(e(document).on("keyup.editable",function(t){t.which===27&&e(".editable-open").editableContainer("hide")}),e(document).on("click.editable",function(n){var r=e(n.target),i,s=[".editable-container",".ui-datepicker-header",".datepicker",".modal-backdrop",".bootstrap-wysihtml5-insert-image-modal",".bootstrap-wysihtml5-insert-link-modal"];if(!e.contains(document.documentElement,n.target))return;if(r.is(document))return;for(i=0;i<s.length;i++)if(r.is(s[i])||r.parents(s[i]).length)return;t.prototype.closeOthers(n.target)}),e(document).data("editable-handlers-attached",!0))},splitOptions:function(){this.containerOptions={},this.formOptions={};if(!e.fn[this.containerName])throw new Error(this.containerName+" not found. Have you included corresponding js file?");for(var t in this.options)t in this.defaults?this.containerOptions[t]=this.options[t]:this.formOptions[t]=this.options[t]},tip:function(){return this.container()?this.container().$tip:null},container:function(){var e;if(this.containerDataName)if(e=this.$element.data(this.containerDataName))return e;return e=this.$element.data(this.containerName),e},call:function(){this.$element[this.containerName].apply(this.$element,arguments)},initContainer:function(){this.call(this.containerOptions)},renderForm:function(){this.$form.editableform(this.formOptions).on({save:e.proxy(this.save,this),nochange:e.proxy(function(){this.hide("nochange")},this),cancel:e.proxy(function(){this.hide("cancel")},this),show:e.proxy(function(){this.delayedHide?(this.hide(this.delayedHide.reason),this.delayedHide=!1):this.setPosition()},this),rendering:e.proxy(this.setPosition,this),resize:e.proxy(this.setPosition,this),rendered:e.proxy(function(){this.$element.triggerHandler("shown",e(this.options.scope).data("editable"))},this)}).editableform("render")},show:function(t){this.$element.addClass("editable-open"),t!==!1&&this.closeOthers(this.$element[0]),this.innerShow(),this.tip().addClass(this.containerClass),this.$form,this.$form=e("<div>"),this.tip().is(this.innerCss)?this.tip().append(this.$form):this.tip().find(this.innerCss).append(this.$form),this.renderForm()},hide:function(e){if(!this.tip()||!this.tip().is(":visible")||!this.$element.hasClass("editable-open"))return;if(this.$form.data("editableform").isSaving){this.delayedHide={reason:e};return}this.delayedHide=!1,this.$element.removeClass("editable-open"),this.innerHide(),this.$element.triggerHandler("hidden",e||"manual")},innerShow:function(){},innerHide:function(){},toggle:function(e){this.container()&&this.tip()&&this.tip().is(":visible")?this.hide():this.show(e)},setPosition:function(){},save:function(e,t){this.$element.triggerHandler("save",t),this.hide("save")},option:function(e,t){this.options[e]=t,e in this.containerOptions?(this.containerOptions[e]=t,this.setContainerOption(e,t)):(this.formOptions[e]=t,this.$form&&this.$form.editableform("option",e,t))},setContainerOption:function(e,t){this.call("option",e,t)},destroy:function(){this.hide(),this.innerDestroy(),this.$element.off("destroyed"),this.$element.removeData("editableContainer")},innerDestroy:function(){},closeOthers:function(t){e(".editable-open").each(function(n,r){if(r===t||e(r).find(t).length)return;var i=e(r),s=i.data("editableContainer");if(!s)return;s.options.onblur==="cancel"?i.data("editableContainer").hide("onblur"):s.options.onblur==="submit"&&i.data("editableContainer").tip().find("form").submit()})},activate:function(){this.tip&&this.tip().is(":visible")&&this.$form&&this.$form.data("editableform").input.activate()}},e.fn.editableContainer=function(r){var i=arguments;return this.each(function(){var s=e(this),o="editableContainer",u=s.data(o),a=typeof r=="object"&&r,f=a.mode==="inline"?n:t;u||s.data(o,u=new f(this,a)),typeof r=="string"&&u[r].apply(u,Array.prototype.slice.call(i,1))})},e.fn.editableContainer.Popup=t,e.fn.editableContainer.Inline=n,e.fn.editableContainer.defaults={value:null,placement:"top",autohide:!0,onblur:"cancel",anim:!1,mode:"popup"},jQuery.event.special.destroyed={remove:function(e){e.handler&&e.handler()}}}(window.jQuery),function(e){"use strict";e.extend(e.fn.editableContainer.Inline.prototype,e.fn.editableContainer.Popup.prototype,{containerName:"editableform",innerCss:".editable-inline",containerClass:"editable-container editable-inline",initContainer:function(){this.$tip=e("<span></span>"),this.options.anim||(this.options.anim=0)},splitOptions:function(){this.containerOptions={},this.formOptions=this.options},tip:function(){return this.$tip},innerShow:function(){this.$element.hide(),this.tip().insertAfter(this.$element).show()},innerHide:function(){this.$tip.hide(this.options.anim,e.proxy(function(){this.$element.show(),this.innerDestroy()},this))},innerDestroy:function(){this.tip()&&this.tip().empty().remove()}})}(window.jQuery),function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.editable.defaults,n,e.fn.editableutils.getConfigData(this.$element)),this.options.selector?this.initLive():this.init(),this.options.highlight&&!e.fn.editableutils.supportsTransitions()&&(this.options.highlight=!1)};t.prototype={constructor:t,init:function(){var t=!1,n,r;this.options.name=this.options.name||this.$element.attr("id"),this.options.scope=this.$element[0],this.input=e.fn.editableutils.createInput(this.options);if(!this.input)return;this.options.value===undefined||this.options.value===null?(this.value=this.input.html2value(e.trim(this.$element.html())),t=!0):(this.options.value=e.fn.editableutils.tryParseJson(this.options.value,!0),typeof this.options.value=="string"?this.value=this.input.str2value(this.options.value):this.value=this.options.value),this.$element.addClass("editable"),this.input.type==="textarea"&&this.$element.addClass("editable-pre-wrapped"),this.options.toggle!=="manual"?(this.$element.addClass("editable-click"),this.$element.on(this.options.toggle+".editable",e.proxy(function(e){this.options.disabled||e.preventDefault();if(this.options.toggle==="mouseenter")this.show();else{var t=this.options.toggle!=="click";this.toggle(t)}},this))):this.$element.attr("tabindex",-1),typeof this.options.display=="function"&&(this.options.autotext="always");switch(this.options.autotext){case"always":n=!0;break;case"auto":n=!e.trim(this.$element.text()).length&&this.value!==null&&this.value!==undefined&&!t;break;default:n=!1}e.when(n?this.render():!0).then(e.proxy(function(){this.options.disabled?this.disable():this.enable(),this.$element.triggerHandler("init",this)},this))},initLive:function(){var t=this.options.selector;this.options.selector=!1,this.options.autotext="never",this.$element.on(this.options.toggle+".editable",t,e.proxy(function(t){var n=e(t.target);n.data("editable")||(n.hasClass(this.options.emptyclass)&&n.empty(),n.editable(this.options).trigger(t))},this))},render:function(e){if(this.options.display===!1)return;return this.input.value2htmlFinal?this.input.value2html(this.value,this.$element[0],this.options.display,e):typeof this.options.display=="function"?this.options.display.call(this.$element[0],this.value,e):this.input.value2html(this.value,this.$element[0])},enable:function(){this.options.disabled=!1,this.$element.removeClass("editable-disabled"),this.handleEmpty(this.isEmpty),this.options.toggle!=="manual"&&this.$element.attr("tabindex")==="-1"&&this.$element.removeAttr("tabindex")},disable:function(){this.options.disabled=!0,this.hide(),this.$element.addClass("editable-disabled"),this.handleEmpty(this.isEmpty),this.$element.attr("tabindex",-1)},toggleDisabled:function(){this.options.disabled?this.enable():this.disable()},option:function(t,n){if(t&&typeof t=="object"){e.each(t,e.proxy(function(t,n){this.option(e.trim(t),n)},this));return}this.options[t]=n;if(t==="disabled")return n?this.disable():this.enable();t==="value"&&this.setValue(n),this.container&&this.container.option(t,n),this.input.option&&this.input.option(t,n)},handleEmpty:function(t){if(this.options.display===!1)return;t!==undefined?this.isEmpty=t:typeof this.input.isEmpty=="function"?this.isEmpty=this.input.isEmpty(this.$element):this.isEmpty=e.trim(this.$element.html())==="",this.options.disabled?this.isEmpty&&(this.$element.empty(),this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass)):this.isEmpty?(this.$element.html(this.options.emptytext),this.options.emptyclass&&this.$element.addClass(this.options.emptyclass)):this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass)},show:function(t){if(this.options.disabled)return;if(!this.container){var n=e.extend({},this.options,{value:this.value,input:this.input});this.$element.editableContainer(n),this.$element.on("save.internal",e.proxy(this.save,this)),this.container=this.$element.data("editableContainer")}else if(this.container.tip().is(":visible"))return;this.container.show(t)},hide:function(){this.container&&this.container.hide()},toggle:function(e){this.container&&this.container.tip().is(":visible")?this.hide():this.show(e)},save:function(e,t){if(this.options.unsavedclass){var n=!1;n=n||typeof this.options.url=="function",n=n||this.options.display===!1,n=n||t.response!==undefined,n=n||this.options.savenochange&&this.input.value2str(this.value)!==this.input.value2str(t.newValue),n?this.$element.removeClass(this.options.unsavedclass):this.$element.addClass(this.options.unsavedclass)}if(this.options.highlight){var r=this.$element,i=r.css("background-color");r.css("background-color",this.options.highlight),setTimeout(function(){i==="transparent"&&(i=""),r.css("background-color",i),r.addClass("editable-bg-transition"),setTimeout(function(){r.removeClass("editable-bg-transition")},1700)},10)}this.setValue(t.newValue,!1,t.response)},validate:function(){if(typeof this.options.validate=="function")return this.options.validate.call(this,this.value)},setValue:function(t,n,r){n?this.value=this.input.str2value(t):this.value=t,this.container&&this.container.option("value",this.value),e.when(this.render(r)).then(e.proxy(function(){this.handleEmpty()},this))},activate:function(){this.container&&this.container.activate()},destroy:function(){this.disable(),this.container&&this.container.destroy(),this.input.destroy(),this.options.toggle!=="manual"&&(this.$element.removeClass("editable-click"),this.$element.off(this.options.toggle+".editable")),this.$element.off("save.internal"),this.$element.removeClass("editable editable-open editable-disabled"),this.$element.removeData("editable")}},e.fn.editable=function(n){var r={},i=arguments,s="editable";switch(n){case"validate":return this.each(function(){var t=e(this),n=t.data(s),i;n&&(i=n.validate())&&(r[n.options.name]=i)}),r;case"getValue":return arguments.length===2&&arguments[1]===!0?r=this.eq(0).data(s).value:this.each(function(){var t=e(this),n=t.data(s);n&&n.value!==undefined&&n.value!==null&&(r[n.options.name]=n.input.value2submit(n.value))}),r;case"submit":var o=arguments[1]||{},u=this,a=this.editable("validate");if(e.isEmptyObject(a)){var f={};if(u.length===1){var l=u.data("editable"),c={name:l.options.name||"",value:l.input.value2submit(l.value),pk:typeof l.options.pk=="function"?l.options.pk.call(l.options.scope):l.options.pk};typeof l.options.params=="function"?c=l.options.params.call(l.options.scope,c):(l.options.params=e.fn.editableutils.tryParseJson(l.options.params,!0),e.extend(c,l.options.params)),f={url:l.options.url,data:c,type:"POST"},o.success=o.success||l.options.success,o.error=o.error||l.options.error}else{var h=this.editable("getValue");f={url:o.url,data:h,type:"POST"}}f.success=typeof o.success=="function"?function(e){o.success.call(u,e,o)}:e.noop,f.error=typeof o.error=="function"?function(){o.error.apply(u,arguments)}:e.noop,o.ajaxOptions&&e.extend(f,o.ajaxOptions),o.data&&e.extend(f.data,o.data),e.ajax(f)}else typeof o.error=="function"&&o.error.call(u,a);return this}return this.each(function(){var r=e(this),o=r.data(s),u=typeof n=="object"&&n;if(u&&u.selector){o=new t(this,u);return}o||r.data(s,o=new t(this,u)),typeof n=="string"&&o[n].apply(o,Array.prototype.slice.call(i,1))})},e.fn.editable.defaults={type:"text",disabled:!1,toggle:"click",emptytext:"Empty",autotext:"auto",value:null,display:null,emptyclass:"editable-empty",unsavedclass:"editable-unsaved",selector:null,highlight:"#FFFF80"}}(window.jQuery),function(e){"use strict";e.fn.editabletypes={};var t=function(){};t.prototype={init:function(t,n,r){this.type=t,this.options=e.extend({},r,n)},prerender:function(){this.$tpl=e(this.options.tpl),this.$input=this.$tpl,this.$clear=null,this.error=null},render:function(){},value2html:function(t,n){e(n)[this.options.escape?"text":"html"](e.trim(t))},html2value:function(t){return e("<div>").html(t).text()},value2str:function(e){return e},str2value:function(e){return e},value2submit:function(e){return e},value2input:function(e){this.$input.val(e)},input2value:function(){return this.$input.val()},activate:function(){this.$input.is(":visible")&&this.$input.focus()},clear:function(){this.$input.val(null)},escape:function(t){return e("<div>").text(t).html()},autosubmit:function(){},destroy:function(){},setClass:function(){this.options.inputclass&&this.$input.addClass(this.options.inputclass)},setAttr:function(e){this.options[e]!==undefined&&this.options[e]!==null&&this.$input.attr(e,this.options[e])},option:function(e,t){this.options[e]=t}},t.defaults={tpl:"",inputclass:null,escape:!0,scope:null,showbuttons:!0},e.extend(e.fn.editabletypes,{abstractinput:t})}(window.jQuery),function(e){"use strict";var t=function(e){};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){var t=e.Deferred();return this.error=null,this.onSourceReady(function(){this.renderList(),t.resolve()},function(){this.error=this.options.sourceError,t.resolve()}),t.promise()},html2value:function(e){return null},value2html:function(t,n,r,i){var s=e.Deferred(),o=function(){typeof r=="function"?r.call(n,t,this.sourceData,i):this.value2htmlFinal(t,n),s.resolve()};return t===null?o.call(this):this.onSourceReady(o,function(){s.resolve()}),s.promise()},onSourceReady:function(t,n){var r;e.isFunction(this.options.source)?(r=this.options.source.call(this.options.scope),this.sourceData=null):r=this.options.source;if(this.options.sourceCache&&e.isArray(this.sourceData)){t.call(this);return}try{r=e.fn.editableutils.tryParseJson(r,!1)}catch(i){n.call(this);return}if(typeof r=="string"){if(this.options.sourceCache){var s=r,o;e(document).data(s)||e(document).data(s,{}),o=e(document).data(s);if(o.loading===!1&&o.sourceData){this.sourceData=o.sourceData,this.doPrepend(),t.call(this);return}if(o.loading===!0){o.callbacks.push(e.proxy(function(){this.sourceData=o.sourceData,this.doPrepend(),t.call(this)},this)),o.err_callbacks.push(e.proxy(n,this));return}o.loading=!0,o.callbacks=[],o.err_callbacks=[]}var u=e.extend({url:r,type:"get",cache:!1,dataType:"json",success:e.proxy(function(r){o&&(o.loading=!1),this.sourceData=this.makeArray(r),e.isArray(this.sourceData)?(o&&(o.sourceData=this.sourceData,e.each(o.callbacks,function(){this.call()})),this.doPrepend(),t.call(this)):(n.call(this),o&&e.each(o.err_callbacks,function(){this.call()}))},this),error:e.proxy(function(){n.call(this),o&&(o.loading=!1,e.each(o.err_callbacks,function(){this.call()}))},this)},this.options.sourceOptions);e.ajax(u)}else this.sourceData=this.makeArray(r),e.isArray(this.sourceData)?(this.doPrepend(),t.call(this)):n.call(this)},doPrepend:function(){if(this.options.prepend===null||this.options.prepend===undefined)return;e.isArray(this.prependData)||(e.isFunction(this.options.prepend)&&(this.options.prepend=this.options.prepend.call(this.options.scope)),this.options.prepend=e.fn.editableutils.tryParseJson(this.options.prepend,!0),typeof this.options.prepend=="string"&&(this.options.prepend={"":this.options.prepend}),this.prependData=this.makeArray(this.options.prepend)),e.isArray(this.prependData)&&e.isArray(this.sourceData)&&(this.sourceData=this.prependData.concat(this.sourceData))},renderList:function(){},value2htmlFinal:function(e,t){},makeArray:function(t){var n,r,i=[],s,o;if(!t||typeof t=="string")return null;if(e.isArray(t)){o=function(e,t){r={value:e,text:t};if(n++>=2)return!1};for(var u=0;u<t.length;u++)s=t[u],typeof s=="object"?(n=0,e.each(s,o),n===1?i.push(r):n>1&&(s.children&&(s.children=this.makeArray(s.children)),i.push(s))):i.push({value:s,text:s})}else e.each(t,function(e,t){i.push({value:e,text:t})});return i},option:function(e,t){this.options[e]=t,e==="source"&&(this.sourceData=null),e==="prepend"&&(this.prependData=null)}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{source:null,prepend:!1,sourceError:"Error when loading list",sourceCache:!0,sourceOptions:null}),e.fn.editabletypes.list=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("text",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.renderClear(),this.setClass(),this.setAttr("placeholder")},activate:function(){this.$input.is(":visible")&&(this.$input.focus(),e.fn.editableutils.setCursorPosition(this.$input.get(0),this.$input.val().length),this.toggleClear&&this.toggleClear())},renderClear:function(){this.options.clear&&(this.$clear=e('<span class="editable-clear-x"></span>'),this.$input.after(this.$clear).css("padding-right",24).keyup(e.proxy(function(t){if(~e.inArray(t.keyCode,[40,38,9,13,27]))return;clearTimeout(this.t);var n=this;this.t=setTimeout(function(){n.toggleClear(t)},100)},this)).parent().css("position","relative"),this.$clear.click(e.proxy(this.clear,this)))},postrender:function(){},toggleClear:function(e){if(!this.$clear)return;var t=this.$input.val().length,n=this.$clear.is(":visible");t&&!n&&this.$clear.show(),!t&&n&&this.$clear.hide()},clear:function(){this.$clear.hide(),this.$input.val("").focus()}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',placeholder:null,clear:!0}),e.fn.editabletypes.text=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("textarea",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.setClass(),this.setAttr("placeholder"),this.setAttr("rows"),this.$input.keydown(function(t){t.ctrlKey&&t.which===13&&e(this).closest("form").submit()})},activate:function(){e.fn.editabletypes.text.prototype.activate.call(this)}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:"<textarea></textarea>",inputclass:"input-large",placeholder:null,rows:7}),e.fn.editabletypes.textarea=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("select",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.list),e.extend(t.prototype,{renderList:function(){this.$input.empty();var t=function(n,r){var i;if(e.isArray(r))for(var s=0;s<r.length;s++)i={},r[s].children?(i.label=r[s].text,n.append(t(e("<optgroup>",i),r[s].children))):(i.value=r[s].value,r[s].disabled&&(i.disabled=!0),n.append(e("<option>",i).text(r[s].text)));return n};t(this.$input,this.sourceData),this.setClass(),this.$input.on("keydown.editable",function(t){t.which===13&&e(this).closest("form").submit()})},value2htmlFinal:function(t,n){var r="",i=e.fn.editableutils.itemsByValue(t,this.sourceData);i.length&&(r=i[0].text),e.fn.editabletypes.abstractinput.prototype.value2html.call(this,r,n)},autosubmit:function(){this.$input.off("keydown.editable").on("change.editable",function(){e(this).closest("form").submit()})}}),t.defaults=e.extend({},e.fn.editabletypes.list.defaults,{tpl:"<select></select>"}),e.fn.editabletypes.select=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("checklist",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.list),e.extend(t.prototype,{renderList:function(){var t,n;this.$tpl.empty();if(!e.isArray(this.sourceData))return;for(var r=0;r<this.sourceData.length;r++)t=e("<label>").append(e("<input>",{type:"checkbox",value:this.sourceData[r].value})).append(e("<span>").text(" "+this.sourceData[r].text)),e("<div>").append(t).appendTo(this.$tpl);this.$input=this.$tpl.find('input[type="checkbox"]'),this.setClass()},value2str:function(t){return e.isArray(t)?t.sort().join(e.trim(this.options.separator)):""},str2value:function(t){var n,r=null;return typeof t=="string"&&t.length?(n=new RegExp("\\s*"+e.trim(this.options.separator)+"\\s*"),r=t.split(n)):e.isArray(t)?r=t:r=[t],r},value2input:function(t){this.$input.prop("checked",!1),e.isArray(t)&&t.length&&this.$input.each(function(n,r){var i=e(r);e.each(t,function(e,t){i.val()==t&&i.prop("checked",!0)})})},input2value:function(){var t=[];return this.$input.filter(":checked").each(function(n,r){t.push(e(r).val())}),t},value2htmlFinal:function(t,n){var r=[],i=e.fn.editableutils.itemsByValue(t,this.sourceData),s=this.options.escape;i.length?(e.each(i,function(t,n){var i=s?e.fn.editableutils.escape(n.text):n.text;r.push(i)}),e(n).html(r.join("<br>"))):e(n).empty()},activate:function(){this.$input.first().focus()},autosubmit:function(){this.$input.on("keydown",function(t){t.which===13&&e(this).closest("form").submit()})}}),t.defaults=e.extend({},e.fn.editabletypes.list.defaults,{tpl:'<div class="editable-checklist"></div>',inputclass:null,separator:","}),e.fn.editabletypes.checklist=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("password",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),e.extend(t.prototype,{value2html:function(t,n){t?e(n).text("[hidden]"):e(n).empty()},html2value:function(e){return null}}),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="password">'}),e.fn.editabletypes.password=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("email",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="email">'}),e.fn.editabletypes.email=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("url",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="url">'}),e.fn.editabletypes.url=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("tel",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="tel">'}),e.fn.editabletypes.tel=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("number",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),e.extend(t.prototype,{render:function(){t.superclass.render.call(this),this.setAttr("min"),this.setAttr("max"),this.setAttr("step")},postrender:function(){this.$clear&&this.$clear.css({right:24})}}),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="number">',inputclass:"input-mini",min:null,max:null,step:null}),e.fn.editabletypes.number=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("range",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.number),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.filter("input"),this.setClass(),this.setAttr("min"),this.setAttr("max"),this.setAttr("step"),this.$input.on("input",function(){e(this).siblings("output").text(e(this).val())})},activate:function(){this.$input.focus()}}),t.defaults=e.extend({},e.fn.editabletypes.number.defaults,{tpl:'<input type="range"><output style="width: 30px; display: inline-block"></output>',inputclass:"input-medium"}),e.fn.editabletypes.range=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("time",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.setClass()}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="time">'}),e.fn.editabletypes.time=t}(window.jQuery),function(e){"use strict";var t=function(n){this.init("select2",n,t.defaults),n.select2=n.select2||{},this.sourceData=null,n.placeholder&&(n.select2.placeholder=n.placeholder);if(!n.select2.tags&&n.source){var r=n.source;e.isFunction(n.source)&&(r=n.source.call(n.scope)),typeof r=="string"?(n.select2.ajax=n.select2.ajax||{},n.select2.ajax.data||(n.select2.ajax.data=function(e){return{query:e}}),n.select2.ajax.results||(n.select2.ajax.results=function(e){return{results:e}}),n.select2.ajax.url=r):(this.sourceData=this.convertSource(r),n.select2.data=this.sourceData)}this.options.select2=e.extend({},t.defaults.select2,n.select2),this.isMultiple=this.options.select2.tags||this.options.select2.multiple,this.isRemote="ajax"in this.options.select2,this.idFunc=this.options.select2.id;if(typeof this.idFunc!="function"){var i=this.idFunc||"id";this.idFunc=function(e){return e[i]}}this.formatSelection=this.options.select2.formatSelection,typeof this.formatSelection!="function"&&(this.formatSelection=function(e){return e.text})};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.setClass(),this.isRemote&&this.$input.on("select2-loaded",e.proxy(function(e){this.sourceData=e.items.results},this)),this.isMultiple&&this.$input.on("change",function(){e(this).closest("form").parent().triggerHandler("resize")})},value2html:function(n,r){var i="",s,o=this;this.options.select2.tags?s=n:this.sourceData&&(s=e.fn.editableutils.itemsByValue(n,this.sourceData,this.idFunc)),e.isArray(s)?(i=[],e.each(s,function(e,t){i.push(t&&typeof t=="object"?o.formatSelection(t):t)})):s&&(i=o.formatSelection(s)),i=e.isArray(i)?i.join(this.options.viewseparator):i,t.superclass.value2html.call(this,i,r)},html2value:function(e){return this.options.select2.tags?this.str2value(e,this.options.viewseparator):null},value2input:function(t){e.isArray(t)&&(t=t.join(this.getSeparator())),this.$input.data("select2")?this.$input.val(t).trigger("change",!0):(this.$input.val(t),this.$input.select2(this.options.select2));if(this.isRemote&&!this.isMultiple&&!this.options.select2.initSelection){var n=this.options.select2.id,r=this.options.select2.formatSelection;if(!n&&!r){var i=e(this.options.scope);if(!i.data("editable").isEmpty){var s={id:t,text:i.text()};this.$input.select2("data",s)}}}},input2value:function(){return this.$input.select2("val")},str2value:function(t,n){if(typeof t!="string"||!this.isMultiple)return t;n=n||this.getSeparator();var r,i,s;if(t===null||t.length<1)return null;r=t.split(n);for(i=0,s=r.length;i<s;i+=1)r[i]=e.trim(r[i]);return r},autosubmit:function(){this.$input.on("change",function(t,n){n||e(this).closest("form").submit()})},getSeparator:function(){return this.options.select2.separator||e.fn.select2.defaults.separator},convertSource:function(t){if(e.isArray(t)&&t.length&&t[0].value!==undefined)for(var n=0;n<t.length;n++)t[n].value!==undefined&&(t[n].id=t[n].value,delete t[n].value);return t},destroy:function(){this.$input.data("select2")&&this.$input.select2("destroy")}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="hidden">',select2:null,placeholder:null,source:null,viewseparator:", "}),e.fn.editabletypes.select2=t}(window.jQuery),function(e){var t=function(t,n){this.$element=e(t);if(!this.$element.is("input")){e.error("Combodate should be applied to INPUT element");return}this.options=e.extend({},e.fn.combodate.defaults,n,this.$element.data()),this.init()};t.prototype={constructor:t,init:function(){this.map={day:["D","date"],month:["M","month"],year:["Y","year"],hour:["[Hh]","hours"],minute:["m","minutes"],second:["s","seconds"],ampm:["[Aa]",""]},this.$widget=e('<span class="combodate"></span>').html(this.getTemplate()),this.initCombos(),this.$widget.on("change","select",e.proxy(function(t){this.$element.val(this.getValue()).change(),this.options.smartDays&&(e(t.target).is(".month")||e(t.target).is(".year"))&&this.fillCombo("day")},this)),this.$widget.find("select").css("width","auto"),this.$element.hide().after(this.$widget),this.setValue(this.$element.val()||this.options.value)},getTemplate:function(){var t=this.options.template;return e.each(this.map,function(e,n){n=n[0];var r=new RegExp(n+"+"),i=n.length>1?n.substring(1,2):n;t=t.replace(r,"{"+i+"}")}),t=t.replace(/ /g,"&nbsp;"),e.each(this.map,function(e,n){n=n[0];var r=n.length>1?n.substring(1,2):n;t=t.replace("{"+r+"}",'<select class="'+e+'"></select>')}),t},initCombos:function(){for(var e in this.map){var t=this.$widget.find("."+e);this["$"+e]=t.length?t:null,this.fillCombo(e)}},fillCombo:function(e){var t=this["$"+e];if(!t)return;var n="fill"+e.charAt(0).toUpperCase()+e.slice(1),r=this[n](),i=t.val();t.empty();for(var s=0;s<r.length;s++)t.append('<option value="'+r[s][0]+'">'+r[s][1]+"</option>");t.val(i)},fillCommon:function(e){var t=[],n;if(this.options.firstItem==="name"){n=moment.relativeTime||moment.langData()._relativeTime;var r=typeof n[e]=="function"?n[e](1,!0,e,!1):n[e];r=r.split(" ").reverse()[0],t.push(["",r])}else this.options.firstItem==="empty"&&t.push(["",""]);return t},fillDay:function(){var e=this.fillCommon("d"),t,n,r=this.options.template.indexOf("DD")!==-1,i=31;if(this.options.smartDays&&this.$month&&this.$year){var s=parseInt(this.$month.val(),10),o=parseInt(this.$year.val(),10);!isNaN(s)&&!isNaN(o)&&(i=moment([o,s]).daysInMonth())}for(n=1;n<=i;n++)t=r?this.leadZero(n):n,e.push([n,t]);return e},fillMonth:function(){var e=this.fillCommon("M"),t,n,r=this.options.template.indexOf("MMMM")!==-1,i=this.options.template.indexOf("MMM")!==-1,s=this.options.template.indexOf("MM")!==-1;for(n=0;n<=11;n++)r?t=moment().date(1).month(n).format("MMMM"):i?t=moment().date(1).month(n).format("MMM"):s?t=this.leadZero(n+1):t=n+1,e.push([n,t]);return e},fillYear:function(){var e=[],t,n,r=this.options.template.indexOf("YYYY")!==-1;for(n=this.options.maxYear;n>=this.options.minYear;n--)t=r?n:(n+"").substring(2),e[this.options.yearDescending?"push":"unshift"]([n,t]);return e=this.fillCommon("y").concat(e),e},fillHour:function(){var e=this.fillCommon("h"),t,n,r=this.options.template.indexOf("h")!==-1,i=this.options.template.indexOf("H")!==-1,s=this.options.template.toLowerCase().indexOf("hh")!==-1,o=r?1:0,u=r?12:23;for(n=o;n<=u;n++)t=s?this.leadZero(n):n,e.push([n,t]);return e},fillMinute:function(){var e=this.fillCommon("m"),t,n,r=this.options.template.indexOf("mm")!==-1;for(n=0;n<=59;n+=this.options.minuteStep)t=r?this.leadZero(n):n,e.push([n,t]);return e},fillSecond:function(){var e=this.fillCommon("s"),t,n,r=this.options.template.indexOf("ss")!==-1;for(n=0;n<=59;n+=this.options.secondStep)t=r?this.leadZero(n):n,e.push([n,t]);return e},fillAmpm:function(){var e=this.options.template.indexOf("a")!==-1,t=this.options.template.indexOf("A")!==-1,n=[["am",e?"am":"AM"],["pm",e?"pm":"PM"]];return n},getValue:function(t){var n,r={},i=this,s=!1;return e.each(this.map,function(e,t){if(e==="ampm")return;var n=e==="day"?1:0;r[e]=i["$"+e]?parseInt(i["$"+e].val(),10):n;if(isNaN(r[e]))return s=!0,!1}),s?"":(this.$ampm&&(r.hour===12?r.hour=this.$ampm.val()==="am"?0:12:r.hour=this.$ampm.val()==="am"?r.hour:r.hour+12),n=moment([r.year,r.month,r.day,r.hour,r.minute,r.second]),this.highlight(n),t=t===undefined?this.options.format:t,t===null?n.isValid()?n:null:n.isValid()?n.format(t):"")},setValue:function(t){function s(t,n){var r={};return t.children("option").each(function(t,i){var s=e(i).attr("value"),o;if(s==="")return;o=Math.abs(s-n);if(typeof r.distance=="undefined"||o<r.distance)r={value:s,distance:o}}),r.value}if(!t)return;var n=typeof t=="string"?moment(t,this.options.format):moment(t),r=this,i={};n.isValid()&&(e.each(this.map,function(e,t){if(e==="ampm")return;i[e]=n[t[1]]()}),this.$ampm&&(i.hour>=12?(i.ampm="pm",i.hour>12&&(i.hour-=12)):(i.ampm="am",i.hour===0&&(i.hour=12))),e.each(i,function(e,t){r["$"+e]&&(e==="minute"&&r.options.minuteStep>1&&r.options.roundTime&&(t=s(r["$"+e],t)),e==="second"&&r.options.secondStep>1&&r.options.roundTime&&(t=s(r["$"+e],t)),r["$"+e].val(t))}),this.options.smartDays&&this.fillCombo("day"),this.$element.val(n.format(this.options.format)).change())},highlight:function(e){e.isValid()?this.options.errorClass?this.$widget.removeClass(this.options.errorClass):this.$widget.find("select").css("border-color",this.borderColor):this.options.errorClass?this.$widget.addClass(this.options.errorClass):(this.borderColor||(this.borderColor=this.$widget.find("select").css("border-color")),this.$widget.find("select").css("border-color","red"))},leadZero:function(e){return e<=9?"0"+e:e},destroy:function(){this.$widget.remove(),this.$element.removeData("combodate").show()}},e.fn.combodate=function(n){var r,i=Array.apply(null,arguments);return i.shift(),n==="getValue"&&this.length&&(r=this.eq(0).data("combodate"))?r.getValue.apply(r,i):this.each(function(){var r=e(this),s=r.data("combodate"),o=typeof n=="object"&&n;s||r.data("combodate",s=new t(this,o)),typeof n=="string"&&typeof s[n]=="function"&&s[n].apply(s,i)})},e.fn.combodate.defaults={format:"DD-MM-YYYY HH:mm",template:"D / MMM / YYYY   H : mm",value:null,minYear:1970,maxYear:2015,yearDescending:!0,minuteStep:5,secondStep:1,firstItem:"empty",errorClass:null,roundTime:!0,smartDays:!1}}(window.jQuery),function(e){"use strict";var t=function(n){this.init("combodate",n,t.defaults),this.options.viewformat||(this.options.viewformat=this.options.format),n.combodate=e.fn.editableutils.tryParseJson(n.combodate,!0),this.options.combodate=e.extend({},t.defaults.combodate,n.combodate,{format:this.options.format,template:this.options.template})};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.$input.combodate(this.options.combodate),e.fn.editableform.engine==="bs3"&&this.$input.siblings().find("select").addClass("form-control"),this.options.inputclass&&this.$input.siblings().find("select").addClass(this.options.inputclass)},value2html:function(e,n){var r=e?e.format(this.options.viewformat):"";t.superclass.value2html.call(this,r,n)},html2value:function(e){return e?moment(e,this.options.viewformat):null},value2str:function(e){return e?e.format(this.options.format):""},str2value:function(e){return e?moment(e,this.options.format):null},value2submit:function(e){return this.value2str(e)},value2input:function(e){this.$input.combodate("setValue",e)},input2value:function(){return this.$input.combodate("getValue",null)},activate:function(){this.$input.siblings(".combodate").find("select").eq(0).focus()},autosubmit:function(){}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',inputclass:null,format:"YYYY-MM-DD",viewformat:null,template:"D / MMM / YYYY",combodate:null}),e.fn.editabletypes.combodate=t}(window.jQuery),function(e){"use strict";var t=e.fn.editableform.Constructor.prototype.initInput;e.extend(e.fn.editableform.Constructor.prototype,{initTemplate:function(){this.$form=e(e.fn.editableform.template),this.$form.find(".control-group").addClass("form-group"),this.$form.find(".editable-error-block").addClass("help-block")},initInput:function(){t.apply(this);var n=this.input.options.inputclass===null||this.input.options.inputclass===!1,r="input-sm",i="text,select,textarea,password,email,url,tel,number,range,time,typeaheadjs".split(",");~e.inArray(this.input.type,i)&&(this.input.$input.addClass("form-control"),n&&(this.input.options.inputclass=r,this.input.$input.addClass(r)));var s=this.$form.find(".editable-buttons"),o=n?[r]:this.input.options.inputclass.split(" ");for(var u=0;u<o.length;u++)o[u].toLowerCase()==="input-lg"&&s.find("button").removeClass("btn-sm").addClass("btn-lg")}}),e.fn.editableform.buttons='<button type="submit" class="btn btn-primary btn-sm editable-submit"><i class="glyphicon glyphicon-ok"></i></button><button type="button" class="btn btn-default btn-sm editable-cancel"><i class="glyphicon glyphicon-remove"></i></button>',e.fn.editableform.errorGroupClass="has-error",e.fn.editableform.errorBlockClass=null,e.fn.editableform.engine="bs3"}(window.jQuery),function(e){"use strict";e.extend(e.fn.editableContainer.Popup.prototype,{containerName:"popover",containerDataName:"bs.popover",innerCss:".popover-content",defaults:e.fn.popover.Constructor.DEFAULTS,initContainer:function(){e.extend(this.containerOptions,{trigger:"manual",selector:!1,content:" ",template:this.defaults.template});var t;this.$element.data("template")&&(t=this.$element.data("template"),this.$element.removeData("template")),this.call(this.containerOptions),t&&this.$element.data("template",t)},innerShow:function(){this.call("show")},innerHide:function(){this.call("hide")},innerDestroy:function(){this.call("destroy")},setContainerOption:function(e,t){this.container().options[e]=t},setPosition:function(){(function(){var e=this.tip(),t=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,n=/\s?auto?\s?/i,r=n.test(t);r&&(t=t.replace(n,"")||"top");var i=this.getPosition(),s=e[0].offsetWidth,o=e[0].offsetHeight;if(r){var u=this.$element.parent(),a=t,f=document.documentElement.scrollTop||document.body.scrollTop,l=this.options.container=="body"?window.innerWidth:u.outerWidth(),c=this.options.container=="body"?window.innerHeight:u.outerHeight(),h=this.options.container=="body"?0:u.offset().left;t=t=="bottom"&&i.top+i.height+o-f>c?"top":t=="top"&&i.top-f-o<0?"bottom":t=="right"&&i.right+s>l?"left":t=="left"&&i.left-s<h?"right":t,e.removeClass(a).addClass(t)}var p=this.getCalculatedOffset(t,i,s,o);this.applyPlacement(p,t)}).call(this.container())}})}(window.jQuery),function(e){function t(){return new Date(Date.UTC.apply(Date,arguments))}function n(){var e=new Date;return t(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())}function s(t,n){var r=e(t).data(),i={},s,o=new RegExp("^"+n.toLowerCase()+"([A-Z])"),n=new RegExp("^"+n.toLowerCase());for(var u in r)n.test(u)&&(s=u.replace(o,function(e,t){return t.toLowerCase()}),i[s]=r[u]);return i}function o(t){var n={};if(!c[t]){t=t.split("-")[0];if(!c[t])return}var r=c[t];return e.each(l,function(e,t){t in r&&(n[t]=r[t])}),n}var r=function(t,n){var r=this;this._process_options(n),this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.is(".date")?this.element.find(".add-on, .btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&this.component.length===0&&(this.component=!1),this.picker=e(h.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&(this.picker.addClass("datepicker-rtl"),this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right")),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this.o.startDate),this.setEndDate(this.o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};r.prototype={constructor:r,_process_options:function(t){this._o=e.extend({},this._o,t);var n=this.o=e.extend({},this._o),r=n.language;c[r]||(r=r.split("-")[0],c[r]||(r=f.language)),n.language=r;switch(n.startView){case 2:case"decade":n.startView=2;break;case 1:case"year":n.startView=1;break;default:n.startView=0}switch(n.minViewMode){case 1:case"months":n.minViewMode=1;break;case 2:case"years":n.minViewMode=2;break;default:n.minViewMode=0}n.startView=Math.max(n.startView,n.minViewMode),n.weekStart%=7,n.weekEnd=(n.weekStart+6)%7;var i=h.parseFormat(n.format);n.startDate!==-Infinity&&(n.startDate=h.parseDate(n.startDate,i,n.language)),n.endDate!==Infinity&&(n.endDate=h.parseDate(n.endDate,i,n.language)),n.daysOfWeekDisabled=n.daysOfWeekDisabled||[],e.isArray(n.daysOfWeekDisabled)||(n.daysOfWeekDisabled=n.daysOfWeekDisabled.split(/[,\s]*/)),n.daysOfWeekDisabled=e.map(n.daysOfWeekDisabled,function(e){return parseInt(e,10)})},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var t=0,n,r;t<e.length;t++)n=e[t][0],r=e[t][1],n.on(r)},_unapplyEvents:function(e){for(var t=0,n,r;t<e.length;t++)n=e[t][0],r=e[t][1],n.off(r)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{mousedown:e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).size()||this.picker.is(e.target)||this.picker.find(e.target).size()||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,n){var r=n||this.date,i=new Date(r.getTime()+r.getTimezoneOffset()*6e4);this.element.trigger({type:t,date:i,format:e.proxy(function(e){var t=e||this.o.format;return h.formatDate(r,t,this.o.language)},this)})},show:function(e){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),this._attachSecondaryEvents(),e&&e.preventDefault(),this._trigger("show")},hide:function(e){if(this.isInline)return;if(!this.picker.is(":visible"))return;this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide")},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},getDate:function(){var e=this.getUTCDate();return new Date(e.getTime()+e.getTimezoneOffset()*6e4)},getUTCDate:function(){return this.date},setDate:function(e){this.setUTCDate(new Date(e.getTime()-e.getTimezoneOffset()*6e4))},setUTCDate:function(e){this.date=e,this.setValue()},setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e):this.component&&this.element.find("input").val(e)},getFormattedDate:function(e){return e===undefined&&(e=this.o.format),h.formatDate(this.date,e,this.o.language)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return;var t=parseInt(this.element.parents().filter(function(){return e(this).css("z-index")!="auto"}).first().css("z-index"))+10,n=this.component?this.component.parent().offset():this.element.offset(),r=this.component?this.component.outerHeight(!0):this.element.outerHeight(!0);this.picker.css({top:n.top+r,left:n.left,zIndex:t})},_allow_update:!0,update:function(){if(!this._allow_update)return;var e,t=!1;arguments&&arguments.length&&(typeof arguments[0]=="string"||arguments[0]instanceof Date)?(e=arguments[0],t=!0):(e=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),delete this.element.data().date),this.date=h.parseDate(e,this.o.format,this.o.language),t&&this.setValue(),this.date<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.date>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=new Date(this.date),this.fill()},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var n='<th class="cw">&nbsp;</th>';t+=n,this.picker.find(".datepicker-days thead tr:first-child").prepend(n)}while(e<this.o.weekStart+7)t+='<th class="dow">'+c[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){var e="",t=0;while(t<12)e+='<span class="month">'+c[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".datepicker-months td").html(e)},setRange:function(t){!t||!t.length?delete this.range:this.range=e.map(t,function(e){return e.valueOf()}),this.fill()},getClassNames:function(t){var n=[],r=this.viewDate.getUTCFullYear(),i=this.viewDate.getUTCMonth(),s=this.date.valueOf(),o=new Date;return t.getUTCFullYear()<r||t.getUTCFullYear()==r&&t.getUTCMonth()<i?n.push("old"):(t.getUTCFullYear()>r||t.getUTCFullYear()==r&&t.getUTCMonth()>i)&&n.push("new"),this.o.todayHighlight&&t.getUTCFullYear()==o.getFullYear()&&t.getUTCMonth()==o.getMonth()&&t.getUTCDate()==o.getDate()&&n.push("today"),s&&t.valueOf()==s&&n.push("active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled)!==-1)&&n.push("disabled"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&n.push("range"),e.inArray(t.valueOf(),this.range)!=-1&&n.push("selected")),n},fill:function(){var n=new Date(this.viewDate),r=n.getUTCFullYear(),i=n.getUTCMonth(),s=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,o=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,u=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,a=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,f=this.date&&this.date.valueOf(),l;this.picker.find(".datepicker-days thead th.datepicker-switch").text(c[this.o.language].months[i]+" "+r),this.picker.find("tfoot th.today").text(c[this.o.language].today).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot th.clear").text(c[this.o.language].clear).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var p=t(r,i-1,28,0,0,0,0),d=h.getDaysInMonth(p.getUTCFullYear(),p.getUTCMonth());p.setUTCDate(d),p.setUTCDate(d-(p.getUTCDay()-this.o.weekStart+7)%7);var v=new Date(p);v.setUTCDate(v.getUTCDate()+42),v=v.valueOf();var m=[],g;while(p.valueOf()<v){if(p.getUTCDay()==this.o.weekStart){m.push("<tr>");if(this.o.calendarWeeks){var y=new Date(+p+(this.o.weekStart-p.getUTCDay()-7)%7*864e5),b=new Date(+y+(11-y.getUTCDay())%7*864e5),w=new Date(+(w=t(b.getUTCFullYear(),0,1))+(11-w.getUTCDay())%7*864e5),E=(b-w)/864e5/7+1;m.push('<td class="cw">'+E+"</td>")}}g=this.getClassNames(p),g.push("day");var S=this.o.beforeShowDay(p);S===undefined?S={}:typeof S=="boolean"?S={enabled:S}:typeof S=="string"&&(S={classes:S}),S.enabled===!1&&g.push("disabled"),S.classes&&(g=g.concat(S.classes.split(/\s+/))),S.tooltip&&(l=S.tooltip),g=e.unique(g),m.push('<td class="'+g.join(" ")+'"'+(l?' title="'+l+'"':"")+">"+p.getUTCDate()+"</td>"),p.getUTCDay()==this.o.weekEnd&&m.push("</tr>"),p.setUTCDate(p.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(m.join(""));var x=this.date&&this.date.getUTCFullYear(),T=this.picker.find(".datepicker-months").find("th:eq(1)").text(r).end().find("span").removeClass("active");x&&x==r&&T.eq(this.date.getUTCMonth()).addClass("active"),(r<s||r>u)&&T.addClass("disabled"),r==s&&T.slice(0,o).addClass("disabled"),r==u&&T.slice(a+1).addClass("disabled"),m="",r=parseInt(r/10,10)*10;var N=this.picker.find(".datepicker-years").find("th:eq(1)").text(r+"-"+(r+9)).end().find("td");r-=1;for(var C=-1;C<11;C++)m+='<span class="year'+(C==-1?" old":C==10?" new":"")+(x==r?" active":"")+(r<s||r>u?" disabled":"")+'">'+r+"</span>",r+=1;N.html(m)},updateNavArrows:function(){if(!this._allow_update)return;var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}},click:function(n){n.preventDefault();var r=e(n.target).closest("span, td, th");if(r.length==1)switch(r[0].nodeName.toLowerCase()){case"th":switch(r[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var i=h.modes[this.viewMode].navStep*(r[0].className=="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,i);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,i)}this.fill();break;case"today":var s=new Date;s=t(s.getFullYear(),s.getMonth(),s.getDate(),0,0,0),this.showMode(-2);var o=this.o.todayBtn=="linked"?null:"view";this._setDate(s,o);break;case"clear":var u;this.isInput?u=this.element:this.component&&(u=this.element.find("input")),u&&u.val("").change(),this._trigger("changeDate"),this.update(),this.o.autoclose&&this.hide()}break;case"span":if(!r.is(".disabled")){this.viewDate.setUTCDate(1);if(r.is(".month")){var a=1,f=r.parent().find("span").index(r),l=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(f),this._trigger("changeMonth",this.viewDate),this.o.minViewMode===1&&this._setDate(t(l,f,a,0,0,0,0))}else{var l=parseInt(r.text(),10)||0,a=1,f=0;this.viewDate.setUTCFullYear(l),this._trigger("changeYear",this.viewDate),this.o.minViewMode===2&&this._setDate(t(l,f,a,0,0,0,0))}this.showMode(-1),this.fill()}break;case"td":if(r.is(".day")&&!r.is(".disabled")){var a=parseInt(r.text(),10)||1,l=this.viewDate.getUTCFullYear(),f=this.viewDate.getUTCMonth();r.is(".old")?f===0?(f=11,l-=1):f-=1:r.is(".new")&&(f==11?(f=0,l+=1):f+=1),this._setDate(t(l,f,a,0,0,0,0))}}},_setDate:function(e,t){if(!t||t=="date")this.date=new Date(e);if(!t||t=="view")this.viewDate=new Date(e);this.fill(),this.setValue(),this._trigger("changeDate");var n;this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&(n.change(),this.o.autoclose&&(!t||t=="date")&&this.hide())},moveMonth:function(e,t){if(!t)return e;var n=new Date(e.valueOf()),r=n.getUTCDate(),i=n.getUTCMonth(),s=Math.abs(t),o,u;t=t>0?1:-1;if(s==1){u=t==-1?function(){return n.getUTCMonth()==i}:function(){return n.getUTCMonth()!=o},o=i+t,n.setUTCMonth(o);if(o<0||o>11)o=(o+12)%12}else{for(var a=0;a<s;a++)n=this.moveMonth(n,t);o=n.getUTCMonth(),n.setUTCDate(r),u=function(){return o!=n.getUTCMonth()}}while(u())n.setUTCDate(--r),n.setUTCMonth(o);return n},moveYear:function(e,t){return this.moveMonth(e,t*12)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)")){e.keyCode==27&&this.show();return}var t=!1,n,r,i,s,o;switch(e.keyCode){case 27:this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;n=e.keyCode==37?-1:1,e.ctrlKey?(s=this.moveYear(this.date,n),o=this.moveYear(this.viewDate,n)):e.shiftKey?(s=this.moveMonth(this.date,n),o=this.moveMonth(this.viewDate,n)):(s=new Date(this.date),s.setUTCDate(this.date.getUTCDate()+n),o=new Date(this.viewDate),o.setUTCDate(this.viewDate.getUTCDate()+n)),this.dateWithinRange(s)&&(this.date=s,this.viewDate=o,this.setValue(),this.update(),e.preventDefault(),t=!0);break;case 38:case 40:if(!this.o.keyboardNavigation)break;n=e.keyCode==38?-1:1,e.ctrlKey?(s=this.moveYear(this.date,n),o=this.moveYear(this.viewDate,n)):e.shiftKey?(s=this.moveMonth(this.date,n),o=this.moveMonth(this.viewDate,n)):(s=new Date(this.date),s.setUTCDate(this.date.getUTCDate()+n*7),o=new Date(this.viewDate),o.setUTCDate(this.viewDate.getUTCDate()+n*7)),this.dateWithinRange(s)&&(this.date=s,this.viewDate=o,this.setValue(),this.update(),e.preventDefault(),t=!0);break;case 13:this.hide(),e.preventDefault();break;case 9:this.hide()}if(t){this._trigger("changeDate");var u;this.isInput?u=this.element:this.component&&(u=this.element.find("input")),u&&u.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".datepicker-"+h.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var i=function(t,n){this.element=e(t),this.inputs=e.map(n.inputs,function(e){return e.jquery?e[0]:e}),delete n.inputs,e(this.inputs).datepicker(n).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};i.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.date}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,n){n.setRange(t)})},dateUpdated:function(t){var n=e(t.target).data("datepicker"),r=n.getUTCDate(),i=e.inArray(t.target,this.inputs),s=this.inputs.length;if(i==-1)return;if(r<this.dates[i])while(i>=0&&r<this.dates[i])this.pickers[i--].setUTCDate(r);else if(r>this.dates[i])while(i<s&&r>this.dates[i])this.pickers[i++].setUTCDate(r);this.updateDates()},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var u=e.fn.datepicker,a=e.fn.datepicker=function(t){var n=Array.apply(null,arguments);n.shift();var u,a;return this.each(function(){var a=e(this),l=a.data("datepicker"),c=typeof t=="object"&&t;if(!l){var h=s(this,"date"),p=e.extend({},f,h,c),d=o(p.language),v=e.extend({},f,d,h,c);if(a.is(".input-daterange")||v.inputs){var m={inputs:v.inputs||a.find("input").toArray()};a.data("datepicker",l=new i(this,e.extend(v,m)))}else a.data("datepicker",l=new r(this,v))}if(typeof t=="string"&&typeof l[t]=="function"){u=l[t].apply(l,n);if(u!==undefined)return!1}}),u!==undefined?u:this},f=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},l=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=r;var c=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},h={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,h.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),n=e.match(this.validParts);if(!t||!t.length||!n||n.length===0)throw new Error("Invalid date format.");return{separators:t,parts:n}},parseDate:function(n,i,s){if(n instanceof Date)return n;typeof i=="string"&&(i=h.parseFormat(i));if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(n)){var o=/([\-+]\d+)([dmwy])/,u=n.match(/([\-+]\d+)([dmwy])/g),a,f;n=new Date;for(var l=0;l<u.length;l++){a=o.exec(u[l]),f=parseInt(a[1]);switch(a[2]){case"d":n.setUTCDate(n.getUTCDate()+f);break;case"m":n=r.prototype.moveMonth.call(r.prototype,n,f);break;case"w":n.setUTCDate(n.getUTCDate()+f*7);break;case"y":n=r.prototype.moveYear.call(r.prototype,n,f)}}return t(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),0,0,0)}var u=n&&n.match(this.nonpunctuation)||[],n=new Date,p={},d=["yyyy","yy","M","MM","m","mm","d","dd"],v={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){t-=1;while(t<0)t+=12;t%=12,e.setUTCMonth(t);while(e.getUTCMonth()!=t)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}},m,g,a;v.M=v.MM=v.mm=v.m,v.dd=v.d,n=t(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0);var y=i.parts.slice();u.length!=y.length&&(y=e(y).filter(function(t,n){return e.inArray(n,d)!==-1}).toArray());if(u.length==y.length){for(var l=0,b=y.length;l<b;l++){m=parseInt(u[l],10),a=y[l];if(isNaN(m))switch(a){case"MM":g=e(c[s].months).filter(function(){var e=this.slice(0,u[l].length),t=u[l].slice(0,e.length);return e==t}),m=e.inArray(g[0],c[s].months)+1;break;case"M":g=e(c[s].monthsShort).filter(function(){var e=this.slice(0,u[l].length),t=u[l].slice(0,e.length);return e==t}),m=e.inArray(g[0],c[s].monthsShort)+1}p[a]=m}for(var l=0,w;l<d.length;l++)w=d[l],w in p&&!isNaN(p[w])&&v[w](n,p[w])}return n},formatDate:function(t,n,r){typeof n=="string"&&(n=h.parseFormat(n));var i={d:t.getUTCDate(),D:c[r].daysShort[t.getUTCDay()],DD:c[r].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:c[r].monthsShort[t.getUTCMonth()],MM:c[r].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};i.dd=(i.d<10?"0":"")+i.d,i.mm=(i.m<10?"0":"")+i.m;var t=[],s=e.extend([],n.separators);for(var o=0,u=n.parts.length;o<=u;o++)s.length&&t.push(s.shift()),t.push(i[n.parts[o]]);return t.join("")},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="datepicker-switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};h.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+h.headTemplate+"<tbody></tbody>"+h.footTemplate+"</table>"+"</div>"+'<div class="datepicker-months">'+'<table class="table-condensed">'+h.headTemplate+h.contTemplate+h.footTemplate+"</table>"+"</div>"+'<div class="datepicker-years">'+'<table class="table-condensed">'+h.headTemplate+h.contTemplate+h.footTemplate+"</table>"+"</div>"+"</div>",e.fn.datepicker.DPGlobal=h,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=u,this},e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var n=e(this);if(n.data("datepicker"))return;t.preventDefault(),a.call(n,"show")}),e(function(){a.call(e('[data-provide="datepicker-inline"]'))})}(window.jQuery),function(e){"use strict";e.fn.bdatepicker=e.fn.datepicker.noConflict(),e.fn.datepicker||(e.fn.datepicker=e.fn.bdatepicker);var t=function(e){this.init("date",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{initPicker:function(t,n){this.options.viewformat||(this.options.viewformat=this.options.format),t.datepicker=e.fn.editableutils.tryParseJson(t.datepicker,!0),this.options.datepicker=e.extend({},n.datepicker,t.datepicker,{format:this.options.viewformat}),this.options.datepicker.language=this.options.datepicker.language||"en",this.dpg=e.fn.bdatepicker.DPGlobal,this.parsedFormat=this.dpg.parseFormat(this.options.format),this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat)},render:function(){this.$input.bdatepicker(this.options.datepicker),this.options.clear&&(this.$clear=e('<a href="#"></a>').html(this.options.clear).click(e.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.clear()},this)),this.$tpl.parent().append(e('<div class="editable-clear">').append(this.$clear)))},value2html:function(e,n){var r=e?this.dpg.formatDate(e,this.parsedViewFormat,this.options.datepicker.language):"";t.superclass.value2html.call(this,r,n)},html2value:function(e){return this.parseDate(e,this.parsedViewFormat)},value2str:function(e){return e?this.dpg.formatDate(e,this.parsedFormat,this.options.datepicker.language):""},str2value:function(e){return this.parseDate(e,this.parsedFormat)},value2submit:function(e){return this.value2str(e)},value2input:function(e){this.$input.bdatepicker("update",e)},input2value:function(){return this.$input.data("datepicker").date},activate:function(){},clear:function(){this.$input.data("datepicker").date=null,this.$input.find(".active").removeClass("active"),this.options.showbuttons||this.$input.closest("form").submit()},autosubmit:function(){this.$input.on("mouseup",".day",function(t){if(e(t.currentTarget).is(".old")||e(t.currentTarget).is(".new"))return;var n=e(this).closest("form");setTimeout(function(){n.submit()},200)})},parseDate:function(e,t){var n=null,r;return e&&(n=this.dpg.parseDate(e,t,this.options.datepicker.language),typeof e=="string"&&(r=this.dpg.formatDate(n,t,this.options.datepicker.language),e!==r&&(n=null))),n}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date well"></div>',inputclass:null,format:"yyyy-mm-dd",viewformat:null,datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:!1},clear:"&times; clear"}),e.fn.editabletypes.date=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("datefield",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.date),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input"),this.setClass(),this.setAttr("placeholder"),this.$tpl.bdatepicker(this.options.datepicker),this.$input.off("focus keydown"),this.$input.keyup(e.proxy(function(){this.$tpl.removeData("date"),this.$tpl.bdatepicker("update")},this))},value2input:function(e){this.$input.val(e?this.dpg.formatDate(e,this.parsedViewFormat,this.options.datepicker.language):""),this.$tpl.bdatepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){e.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}}),t.defaults=e.extend({},e.fn.editabletypes.date.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-small",datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:!0}}),e.fn.editabletypes.datefield=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("datetime",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{initPicker:function(t,n){this.options.viewformat||(this.options.viewformat=this.options.format),t.datetimepicker=e.fn.editableutils.tryParseJson(t.datetimepicker,!0),this.options.datetimepicker=e.extend({},n.datetimepicker,t.datetimepicker,{format:this.options.viewformat}),this.options.datetimepicker.language=this.options.datetimepicker.language||"en",this.dpg=e.fn.datetimepicker.DPGlobal,this.parsedFormat=this.dpg.parseFormat(this.options.format,this.options.formatType),this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat,this.options.formatType)},render:function(){this.$input.datetimepicker(this.options.datetimepicker),this.$input.on("changeMode",function(t){var n=e(this).closest("form").parent();setTimeout(function(){n.triggerHandler("resize")},0)}),this.options.clear&&(this.$clear=e('<a href="#"></a>').html(this.options.clear).click(e.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.clear()},this)),this.$tpl.parent().append(e('<div class="editable-clear">').append(this.$clear)))},value2html:function(e,n){var r=e?this.dpg.formatDate(this.toUTC(e),this.parsedViewFormat,this.options.datetimepicker.language,this.options.formatType):"";if(!n)return r;t.superclass.value2html.call(this,r,n)},html2value:function(e){var t=this.parseDate(e,this.parsedViewFormat);return t?this.fromUTC(t):null},value2str:function(e){return e?this.dpg.formatDate(this.toUTC(e),this.parsedFormat,this.options.datetimepicker.language,this.options.formatType):""},str2value:function(e){var t=this.parseDate(e,this.parsedFormat);return t?this.fromUTC(t):null},value2submit:function(e){return this.value2str(e)},value2input:function(e){e&&this.$input.data("datetimepicker").setDate(e)},input2value:function(){var e=this.$input.data("datetimepicker");return e.date?e.getDate():null},activate:function(){},clear:function(){this.$input.data("datetimepicker").date=null,this.$input.find(".active").removeClass("active"),this.options.showbuttons||this.$input.closest("form").submit()},autosubmit:function(){this.$input.on("mouseup",".minute",function(t){var n=e(this).closest("form");setTimeout(function(){n.submit()},200)})},toUTC:function(e){return e?new Date(e.valueOf()-e.getTimezoneOffset()*6e4):e},fromUTC:function(e){return e?new Date(e.valueOf()+e.getTimezoneOffset()*6e4):e},parseDate:function(e,t){var n=null,r;return e&&(n=this.dpg.parseDate(e,t,this.options.datetimepicker.language,this.options.formatType),typeof e=="string"&&(r=this.dpg.formatDate(n,t,this.options.datetimepicker.language,this.options.formatType),e!==r&&(n=null))),n}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date well"></div>',inputclass:null,format:"yyyy-mm-dd hh:ii",formatType:"standard",viewformat:null,datetimepicker:{todayHighlight:!1,autoclose:!1},clear:"&times; clear"}),e.fn.editabletypes.datetime=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("datetimefield",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.datetime),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input"),this.setClass(),this.setAttr("placeholder"),this.$tpl.datetimepicker(this.options.datetimepicker),this.$input.off("focus keydown"),this.$input.keyup(e.proxy(function(){this.$tpl.removeData("date"),this.$tpl.datetimepicker("update")},this))},value2input:function(e){this.$input.val(this.value2html(e)),this.$tpl.datetimepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){e.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}}),t.defaults=e.extend({},e.fn.editabletypes.datetime.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-medium",datetimepicker:{todayHighlight:!1,autoclose:!0}}),e.fn.editabletypes.datetimefield=t}(window.jQuery),!function(e){function t(){return new Date(Date.UTC.apply(Date,arguments))}function n(){var e=new Date;return t(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),0)}var r=function(t,n){var r=this;this.element=e(t),this.container=n.container||"body",this.language=n.language||this.element.data("date-language")||"en",this.language=this.language in s?this.language:"en",this.isRTL=s[this.language].rtl||!1,this.formatType=n.formatType||this.element.data("format-type")||"standard",this.format=o.parseFormat(n.format||this.element.data("date-format")||s[this.language].format||o.getDefaultFormat(this.formatType,"input"),this.formatType),this.isInline=!1,this.isVisible=!1,this.isInput=this.element.is("input"),this.fontAwesome=n.fontAwesome||this.element.data("font-awesome")||!1,this.bootcssVer=n.bootcssVer||(this.isInput?this.element.is(".form-control")?3:2:this.bootcssVer=this.element.is(".input-group")?3:2),this.component=this.element.is(".date")?this.bootcssVer==3?this.element.find(".input-group-addon .glyphicon-th, .input-group-addon .glyphicon-time, .input-group-addon .glyphicon-calendar, .input-group-addon .glyphicon-calendar, .input-group-addon .fa-calendar, .input-group-addon .fa-clock-o").parent():this.element.find(".add-on .icon-th, .add-on .icon-time, .add-on .icon-calendar .fa-calendar .fa-clock-o").parent():!1,this.componentReset=this.element.is(".date")?this.bootcssVer==3?this.element.find(".input-group-addon .glyphicon-remove .fa-times").parent():this.element.find(".add-on .icon-remove .fa-times").parent():!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&this.component.length===0&&(this.component=!1),this.linkField=n.linkField||this.element.data("link-field")||!1,this.linkFormat=o.parseFormat(n.linkFormat||this.element.data("link-format")||o.getDefaultFormat(this.formatType,"link"),this.formatType),this.minuteStep=n.minuteStep||this.element.data("minute-step")||5,this.pickerPosition=n.pickerPosition||this.element.data("picker-position")||"bottom-right",this.showMeridian=n.showMeridian||this.element.data("show-meridian")||!1,this.initialDate=n.initialDate||new Date,this.zIndex=n.zIndex||this.element.data("z-index")||undefined,this.icons={leftArrow:this.fontAwesome?"fa-arrow-left":this.bootcssVer===3?"glyphicon-arrow-left":"icon-arrow-left",rightArrow:this.fontAwesome?"fa-arrow-right":this.bootcssVer===3?"glyphicon-arrow-right":"icon-arrow-right"},this.icontype=this.fontAwesome?"fa":"glyphicon",this._attachEvents(),this.formatViewType="datetime","formatViewType"in n?this.formatViewType=n.formatViewType:"formatViewType"in this.element.data()&&(this.formatViewType=this.element.data("formatViewType")),this.minView=0,"minView"in n?this.minView=n.minView:"minView"in this.element.data()&&(this.minView=this.element.data("min-view")),this.minView=o.convertViewMode(this.minView),this.maxView=o.modes.length-1,"maxView"in n?this.maxView=n.maxView:"maxView"in this.element.data()&&(this.maxView=this.element.data("max-view")),this.maxView=o.convertViewMode(this.maxView),this.wheelViewModeNavigation=!1,"wheelViewModeNavigation"in n?this.wheelViewModeNavigation=n.wheelViewModeNavigation:"wheelViewModeNavigation"in this.element.data()&&(this.wheelViewModeNavigation=this.element.data("view-mode-wheel-navigation")),this.wheelViewModeNavigationInverseDirection=!1,"wheelViewModeNavigationInverseDirection"in n?this.wheelViewModeNavigationInverseDirection=n.wheelViewModeNavigationInverseDirection:"wheelViewModeNavigationInverseDirection"in this.element.data()&&(this.wheelViewModeNavigationInverseDirection=this.element.data("view-mode-wheel-navigation-inverse-dir")),this.wheelViewModeNavigationDelay=100,"wheelViewModeNavigationDelay"in n?this.wheelViewModeNavigationDelay=n.wheelViewModeNavigationDelay:"wheelViewModeNavigationDelay"in this.element.data()&&(this.wheelViewModeNavigationDelay=this.element.data("view-mode-wheel-navigation-delay")),this.startViewMode=2,"startView"in n?this.startViewMode=n.startView:"startView"in this.element.data()&&(this.startViewMode=this.element.data("start-view")),this.startViewMode=o.convertViewMode(this.startViewMode),this.viewMode=this.startViewMode,this.viewSelect=this.minView,"viewSelect"in n?this.viewSelect=n.viewSelect:"viewSelect"in this.element.data()&&(this.viewSelect=this.element.data("view-select")),this.viewSelect=o.convertViewMode(this.viewSelect),this.forceParse=!0,"forceParse"in n?this.forceParse=n.forceParse:"dateForceParse"in this.element.data()&&(this.forceParse=this.element.data("date-force-parse"));var i=this.bootcssVer===3?o.templateV3:o.template;while(i.indexOf("{iconType}")!==-1)i=i.replace("{iconType}",this.icontype);while(i.indexOf("{leftArrow}")!==-1)i=i.replace("{leftArrow}",this.icons.leftArrow);while(i.indexOf("{rightArrow}")!==-1)i=i.replace("{rightArrow}",this.icons.rightArrow);this.picker=e(i).appendTo(this.isInline?this.element:this.container).on({click:e.proxy(this.click,this),mousedown:e.proxy(this.mousedown,this)}),this.wheelViewModeNavigation&&(e.fn.mousewheel?this.picker.on({mousewheel:e.proxy(this.mousewheel,this)}):console.log("Mouse Wheel event is not supported. Please include the jQuery Mouse Wheel plugin before enabling this option")),this.isInline?this.picker.addClass("datetimepicker-inline"):this.picker.addClass("datetimepicker-dropdown-"+this.pickerPosition+" dropdown-menu");if(this.isRTL){this.picker.addClass("datetimepicker-rtl");var u=this.bootcssVer===3?".prev span, .next span":".prev i, .next i";this.picker.find(u).toggleClass(this.icons.leftArrow+" "+this.icons.rightArrow)}e(document).on("mousedown",function(t){e(t.target).closest(".datetimepicker").length===0&&r.hide()}),this.autoclose=!1,"autoclose"in n?this.autoclose=n.autoclose:"dateAutoclose"in this.element.data()&&(this.autoclose=this.element.data("date-autoclose")),this.keyboardNavigation=!0,"keyboardNavigation"in n?this.keyboardNavigation=n.keyboardNavigation:"dateKeyboardNavigation"in this.element.data()&&(this.keyboardNavigation=this.element.data("date-keyboard-navigation")),this.todayBtn=n.todayBtn||this.element.data("date-today-btn")||!1,this.todayHighlight=n.todayHighlight||this.element.data("date-today-highlight")||!1,this.weekStart=(n.weekStart||this.element.data("date-weekstart")||s[this.language].weekStart||0)%7,this.weekEnd=(this.weekStart+6)%7,this.startDate=-Infinity,this.endDate=Infinity,this.daysOfWeekDisabled=[],this.setStartDate(n.startDate||this.element.data("date-startdate")),this.setEndDate(n.endDate||this.element.data("date-enddate")),this.setDaysOfWeekDisabled(n.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled")),this.setMinutesDisabled(n.minutesDisabled||this.element.data("date-minute-disabled")),this.setHoursDisabled(n.hoursDisabled||this.element.data("date-hour-disabled")),this.fillDow(),this.fillMonths(),this.update(),this.showMode(),this.isInline&&this.show()};r.prototype={constructor:r,_events:[],_attachEvents:function(){this._detachEvents(),this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?(this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]],this.componentReset&&this._events.push([this.componentReset,{click:e.proxy(this.reset,this)}])):this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]];for(var t=0,n,r;t<this._events.length;t++)n=this._events[t][0],r=this._events[t][1],n.on(r)},_detachEvents:function(){for(var e=0,t,n;e<this._events.length;e++)t=this._events[e][0],n=this._events[e][1],t.off(n);this._events=[]},show:function(t){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.forceParse&&this.update(),this.place(),e(window).on("resize",e.proxy(this.place,this)),t&&(t.stopPropagation(),t.preventDefault()),this.isVisible=!0,this.element.trigger({type:"show",date:this.date})},hide:function(t){if(!this.isVisible)return;if(this.isInline)return;this.picker.hide(),e(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||e(document).off("mousedown",this.hide),this.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this.isVisible=!1,this.element.trigger({type:"hide",date:this.date})},remove:function(){this._detachEvents(),this.picker.remove(),delete this.picker,delete this.element.data().datetimepicker},getDate:function(){var e=this.getUTCDate();return new Date(e.getTime()+e.getTimezoneOffset()*6e4)},getUTCDate:function(){return this.date},setDate:function(e){this.setUTCDate(new Date(e.getTime()-e.getTimezoneOffset()*6e4))},setUTCDate:function(e){e>=this.startDate&&e<=this.endDate?(this.date=e,this.setValue(),this.viewDate=this.date,this.fill()):this.element.trigger({type:"outOfRange",date:e,startDate:this.startDate,endDate:this.endDate})},setFormat:function(e){this.format=o.parseFormat(e,this.formatType);var t;this.isInput?t=this.element:this.component&&(t=this.element.find("input")),t&&t.val()&&this.setValue()},setValue:function(){var t=this.getFormattedDate();this.isInput?this.element.val(t):(this.component&&this.element.find("input").val(t),this.element.data("date",t)),this.linkField&&e("#"+this.linkField).val(this.getFormattedDate(this.linkFormat))},getFormattedDate:function(e){return e==undefined&&(e=this.format),o.formatDate(this.date,e,this.language,this.formatType)},setStartDate:function(e){this.startDate=e||-Infinity,this.startDate!==-Infinity&&(this.startDate=o.parseDate(this.startDate,this.format,this.language,this.formatType)),this.update(),this.updateNavArrows()},setEndDate:function(e){this.endDate=e||Infinity,this.endDate!==Infinity&&(this.endDate=o.parseDate(this.endDate,this.format,this.language,this.formatType)),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(t){this.daysOfWeekDisabled=t||[],e.isArray(this.daysOfWeekDisabled)||(this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/)),this.daysOfWeekDisabled=e.map(this.daysOfWeekDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},setMinutesDisabled:function(t){this.minutesDisabled=t||[],e.isArray(this.minutesDisabled)||(this.minutesDisabled=this.minutesDisabled.split(/,\s*/)),this.minutesDisabled=e.map(this.minutesDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},setHoursDisabled:function(t){this.hoursDisabled=t||[],e.isArray(this.hoursDisabled)||(this.hoursDisabled=this.hoursDisabled.split(/,\s*/)),this.hoursDisabled=e.map(this.hoursDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return;if(!this.zIndex){var t=0;e("div").each(function(){var n=parseInt(e(this).css("zIndex"),10);n>t&&(t=n)}),this.zIndex=t+10}var n,r,i,s;this.container instanceof e?s=this.container.offset():s=e(this.container).offset();if(this.component){n=this.component.offset(),i=n.left;if(this.pickerPosition=="bottom-left"||this.pickerPosition=="top-left")i+=this.component.outerWidth()-this.picker.outerWidth()}else n=this.element.offset(),i=n.left;i+220>document.body.clientWidth&&(i=document.body.clientWidth-220),this.pickerPosition=="top-left"||this.pickerPosition=="top-right"?r=n.top-this.picker.outerHeight():r=n.top+this.height,r-=s.top,i-=s.left,r+=document.body.scrollTop,this.picker.css({top:r,left:i,zIndex:this.zIndex})},update:function(){var e,t=!1;if(arguments&&arguments.length&&(typeof arguments[0]=="string"||arguments[0]instanceof Date))e=arguments[0],t=!0;else{e=(this.isInput?this.element.val():this.element.find("input").val())||this.element.data("date")||this.initialDate;if(typeof e=="string"||e instanceof String)e=e.replace(/^\s+|\s+$/g,"")}e||(e=new Date,t=!1),this.date=o.parseDate(e,this.format,this.language,this.formatType),t&&this.setValue(),this.date<this.startDate?this.viewDate=new Date(this.startDate):this.date>this.endDate?this.viewDate=new Date(this.endDate):this.viewDate=new Date(this.date),this.fill()},fillDow:function(){var e=this.weekStart,t="<tr>";while(e<this.weekStart+7)t+='<th class="dow">'+s[this.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datetimepicker-days thead").append(t)},fillMonths:function(){var e="",t=0;while(t<12)e+='<span class="month">'+s[this.language].monthsShort[t++]+"</span>";this.picker.find(".datetimepicker-months td").html(e)},fill:function(){if(this.date==null||this.viewDate==null)return;var n=new Date(this.viewDate),r=n.getUTCFullYear(),i=n.getUTCMonth(),u=n.getUTCDate(),a=n.getUTCHours(),f=n.getUTCMinutes(),l=this.startDate!==-Infinity?this.startDate.getUTCFullYear():-Infinity,h=this.startDate!==-Infinity?this.startDate.getUTCMonth()+1:-Infinity,p=this.endDate!==Infinity?this.endDate.getUTCFullYear():Infinity,v=this.endDate!==Infinity?this.endDate.getUTCMonth()+1:Infinity,m=(new t(this.date.getUTCFullYear(),this.date.getUTCMonth(),this.date.getUTCDate())).valueOf(),y=new Date;this.picker.find(".datetimepicker-days thead th:eq(1)").text(s[this.language].months[i]+" "+r);if(this.formatViewType=="time"){var b=this.getFormattedDate();this.picker.find(".datetimepicker-hours thead th:eq(1)").text(b),this.picker.find(".datetimepicker-minutes thead th:eq(1)").text(b)}else this.picker.find(".datetimepicker-hours thead th:eq(1)").text(u+" "+s[this.language].months[i]+" "+r),this.picker.find(".datetimepicker-minutes thead th:eq(1)").text(u+" "+s[this.language].months[i]+" "+r);this.picker.find("tfoot th.today").text(s[this.language].today).toggle(this.todayBtn!==!1),this.updateNavArrows(),this.fillMonths();var w=t(r,i-1,28,0,0,0,0),E=o.getDaysInMonth(w.getUTCFullYear(),w.getUTCMonth());w.setUTCDate(E),w.setUTCDate(E-(w.getUTCDay()-this.weekStart+7)%7);var S=new Date(w);S.setUTCDate(S.getUTCDate()+42),S=S.valueOf();var x=[],T;while(w.valueOf()<S){w.getUTCDay()==this.weekStart&&x.push("<tr>"),T="";if(w.getUTCFullYear()<r||w.getUTCFullYear()==r&&w.getUTCMonth()<i)T+=" old";else if(w.getUTCFullYear()>r||w.getUTCFullYear()==r&&w.getUTCMonth()>i)T+=" new";this.todayHighlight&&w.getUTCFullYear()==y.getFullYear()&&w.getUTCMonth()==y.getMonth()&&w.getUTCDate()==y.getDate()&&(T+=" today"),w.valueOf()==m&&(T+=" active");if(w.valueOf()+864e5<=this.startDate||w.valueOf()>this.endDate||e.inArray(w.getUTCDay(),this.daysOfWeekDisabled)!==-1)T+=" disabled";x.push('<td class="day'+T+'">'+w.getUTCDate()+"</td>"),w.getUTCDay()==this.weekEnd&&x.push("</tr>"),w.setUTCDate(w.getUTCDate()+1)}this.picker.find(".datetimepicker-days tbody").empty().append(x.join("")),x=[];var N="",C="",k="",L=this.hoursDisabled||[];for(var A=0;A<24;A++){if(L.indexOf(A)!==-1)continue;var O=t(r,i,u,A);T="",O.valueOf()+36e5<=this.startDate||O.valueOf()>this.endDate?T+=" disabled":a==A&&(T+=" active"),this.showMeridian&&s[this.language].meridiem.length==2?(C=A<12?s[this.language].meridiem[0]:s[this.language].meridiem[1],C!=k&&(k!=""&&x.push("</fieldset>"),x.push('<fieldset class="hour"><legend>'+C.toUpperCase()+"</legend>")),k=C,N=A%12?A%12:12,x.push('<span class="hour'+T+" hour_"+(A<12?"am":"pm")+'">'+N+"</span>"),A==23&&x.push("</fieldset>")):(N=A+":00",x.push('<span class="hour'+T+'">'+N+"</span>"))}this.picker.find(".datetimepicker-hours td").html(x.join("")),x=[],N="",C="",k="";var M=this.minutesDisabled||[];for(var A=0;A<60;A+=this.minuteStep){if(M.indexOf(A)!==-1)continue;var O=t(r,i,u,a,A,0);T="",O.valueOf()<this.startDate||O.valueOf()>this.endDate?T+=" disabled":Math.floor(f/this.minuteStep)==Math.floor(A/this.minuteStep)&&(T+=" active"),this.showMeridian&&s[this.language].meridiem.length==2?(C=a<12?s[this.language].meridiem[0]:s[this.language].meridiem[1],C!=k&&(k!=""&&x.push("</fieldset>"),x.push('<fieldset class="minute"><legend>'+C.toUpperCase()+"</legend>")),k=C,N=a%12?a%12:12,x.push('<span class="minute'+T+'">'+N+":"+(A<10?"0"+A:A)+"</span>"),A==59&&x.push("</fieldset>")):(N=A+":00",x.push('<span class="minute'+T+'">'+a+":"+(A<10?"0"+A:A)+"</span>"))}this.picker.find(".datetimepicker-minutes td").html(x.join(""));var _=this.date.getUTCFullYear(),D=this.picker.find(".datetimepicker-months").find("th:eq(1)").text(r).end().find("span").removeClass("active");_==r&&D.eq(this.date.getUTCMonth()+2).addClass("active"),(r<l||r>p)&&D.addClass("disabled"),r==l&&D.slice(0,h+1).addClass("disabled"),r==p&&D.slice(v).addClass("disabled"),x="",r=parseInt(r/10,10)*10;var P=this.picker.find(".datetimepicker-years").find("th:eq(1)").text(r+"-"+(r+9)).end().find("td");r-=1;for(var A=-1;A<11;A++)x+='<span class="year'+(A==-1||A==10?" old":"")+(_==r?" active":"")+(r<l||r>p?" disabled":"")+'">'+r+"</span>",r+=1;P.html(x),this.place()},updateNavArrows:function(){var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth(),r=e.getUTCDate(),i=e.getUTCHours();switch(this.viewMode){case 0:this.startDate!==-Infinity&&t<=this.startDate.getUTCFullYear()&&n<=this.startDate.getUTCMonth()&&r<=this.startDate.getUTCDate()&&i<=this.startDate.getUTCHours()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==Infinity&&t>=this.endDate.getUTCFullYear()&&n>=this.endDate.getUTCMonth()&&r>=this.endDate.getUTCDate()&&i>=this.endDate.getUTCHours()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:this.startDate!==-Infinity&&t<=this.startDate.getUTCFullYear()&&n<=this.startDate.getUTCMonth()&&r<=this.startDate.getUTCDate()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==Infinity&&t>=this.endDate.getUTCFullYear()&&n>=this.endDate.getUTCMonth()&&r>=this.endDate.getUTCDate()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 2:this.startDate!==-Infinity&&t<=this.startDate.getUTCFullYear()&&n<=this.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==Infinity&&t>=this.endDate.getUTCFullYear()&&n>=this.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 3:case 4:this.startDate!==-Infinity&&t<=this.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==Infinity&&t>=this.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}},mousewheel:function(t){t.preventDefault(),t.stopPropagation();if(this.wheelPause)return;this.wheelPause=!0;var n=t.originalEvent,r=n.wheelDelta,i=r>0?1:r===0?0:-1;this.wheelViewModeNavigationInverseDirection&&(i=-i),this.showMode(i),setTimeout(e.proxy(function(){this.wheelPause=!1},this),this.wheelViewModeNavigationDelay)},click:function(n){n.stopPropagation(),n.preventDefault();var r=e(n.target).closest("span, td, th, legend");r.is("."+this.icontype)&&(r=e(r).parent().closest("span, td, th, legend"));if(r.length==1){if(r.is(".disabled")){this.element.trigger({type:"outOfRange",date:this.viewDate,startDate:this.startDate,endDate:this.endDate});return}switch(r[0].nodeName.toLowerCase()){case"th":switch(r[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var i=o.modes[this.viewMode].navStep*(r[0].className=="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveHour(this.viewDate,i);break;case 1:this.viewDate=this.moveDate(this.viewDate,i);break;case 2:this.viewDate=this.moveMonth(this.viewDate,i);break;case 3:case 4:this.viewDate=this.moveYear(this.viewDate,i)}this.fill(),this.element.trigger({type:r[0].className+":"+this.convertViewModeText(this.viewMode),date:this.viewDate,startDate:this.startDate,endDate:this.endDate});break;case"today":var s=new Date;s=t(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),0),s<this.startDate?s=this.startDate:s>this.endDate&&(s=this.endDate),this.viewMode=this.startViewMode,this.showMode(0),this._setDate(s),this.fill(),this.autoclose&&this.hide()}break;case"span":if(!r.is(".disabled")){var u=this.viewDate.getUTCFullYear(),a=this.viewDate.getUTCMonth(),f=this.viewDate.getUTCDate(),l=this.viewDate.getUTCHours(),h=this.viewDate.getUTCMinutes(),p=this.viewDate.getUTCSeconds();if(r.is(".month"))this.viewDate.setUTCDate(1),a=r.parent().find("span").index(r),f=this.viewDate.getUTCDate(),this.viewDate.setUTCMonth(a),this.element.trigger({type:"changeMonth",date:this.viewDate}),this.viewSelect>=3&&this._setDate(t(u,a,f,l,h,p,0));else if(r.is(".year"))this.viewDate.setUTCDate(1),u=parseInt(r.text(),10)||0,this.viewDate.setUTCFullYear(u),this.element.trigger({type:"changeYear",date:this.viewDate}),this.viewSelect>=4&&this._setDate(t(u,a,f,l,h,p,0));else if(r.is(".hour")){l=parseInt(r.text(),10)||0;if(r.hasClass("hour_am")||r.hasClass("hour_pm"))l==12&&r.hasClass("hour_am")?l=0:l!=12&&r.hasClass("hour_pm")&&(l+=12);this.viewDate.setUTCHours(l),this.element.trigger({type:"changeHour",date:this.viewDate}),this.viewSelect>=1&&this._setDate(t(u,a,f,l,h,p,0))}else r.is(".minute")&&(h=parseInt(r.text().substr(r.text().indexOf(":")+1),10)||0,this.viewDate.setUTCMinutes(h),this.element.trigger({type:"changeMinute",date:this.viewDate}),this.viewSelect>=0&&this._setDate(t(u,a,f,l,h,p,0)));if(this.viewMode!=0){var v=this.viewMode;this.showMode(-1),this.fill(),v==this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide()}break;case"td":if(r.is(".day")&&!r.is(".disabled")){var f=parseInt(r.text(),10)||1,u=this.viewDate.getUTCFullYear(),a=this.viewDate.getUTCMonth(),l=this.viewDate.getUTCHours(),h=this.viewDate.getUTCMinutes(),p=this.viewDate.getUTCSeconds();r.is(".old")?a===0?(a=11,u-=1):a-=1:r.is(".new")&&(a==11?(a=0,u+=1):a+=1),this.viewDate.setUTCFullYear(u),this.viewDate.setUTCMonth(a,f),this.element.trigger({type:"changeDay",date:this.viewDate}),this.viewSelect>=2&&this._setDate(t(u,a,f,l,h,p,0))}var v=this.viewMode;this.showMode(-1),this.fill(),v==this.viewMode&&this.autoclose&&this.hide()}}},_setDate:function(e,t){if(!t||t=="date")this.date=e;if(!t||t=="view")this.viewDate=e;this.fill(),this.setValue();var n;this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&(n.change(),this.autoclose&&(!t||t=="date")),this.element.trigger({type:"changeDate",date:this.date})},moveMinute:function(e,t){if(!t)return e;var n=new Date(e.valueOf());return n.setUTCMinutes(n.getUTCMinutes()+t*this.minuteStep),n},moveHour:function(e,t){if(!t)return e;var n=new Date(e.valueOf());return n.setUTCHours(n.getUTCHours()+t),n},moveDate:function(e,t){if(!t)return e;var n=new Date(e.valueOf());return n.setUTCDate(n.getUTCDate()+t),n},moveMonth:function(e,t){if(!t)return e;var n=new Date(e.valueOf()),r=n.getUTCDate(),i=n.getUTCMonth(),s=Math.abs(t),o,u;t=t>0?1:-1;if(s==1){u=t==-1?function(){return n.getUTCMonth()==i}:function(){return n.getUTCMonth()!=o},o=i+t,n.setUTCMonth(o);if(o<0||o>11)o=(o+12)%12}else{for(var a=0;a<s;a++)n=this.moveMonth(n,t);o=n.getUTCMonth(),n.setUTCDate(r),u=function(){return o!=n.getUTCMonth()}}while(u())n.setUTCDate(--r),n.setUTCMonth(o);return n},moveYear:function(e,t){return this.moveMonth(e,t*12)},dateWithinRange:function(e){return e>=this.startDate&&e<=this.endDate},keydown:function(e){if(this.picker.is(":not(:visible)")){e.keyCode==27&&this.show();return}var t=!1,n,r,i,s,o;switch(e.keyCode){case 27:this.hide(),e.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation)break;n=e.keyCode==37?-1:1,viewMode=this.viewMode,e.ctrlKey?viewMode+=2:e.shiftKey&&(viewMode+=1),viewMode==4?(s=this.moveYear(this.date,n),o=this.moveYear(this.viewDate,n)):viewMode==3?(s=this.moveMonth(this.date,n),o=this.moveMonth(this.viewDate,n)):viewMode==2?(s=this.moveDate(this.date,n),o=this.moveDate(this.viewDate,n)):viewMode==1?(s=this.moveHour(this.date,n),o=this.moveHour(this.viewDate,n)):viewMode==0&&(s=this.moveMinute(this.date,n),o=this.moveMinute(this.viewDate,n)),this.dateWithinRange(s)&&(this.date=s,this.viewDate=o,this.setValue(),this.update(),e.preventDefault(),t=!0);break;case 38:case 40:if(!this.keyboardNavigation)break;n=e.keyCode==38?-1:1,viewMode=this.viewMode,e.ctrlKey?viewMode+=2:e.shiftKey&&(viewMode+=1),viewMode==4?(s=this.moveYear(this.date,n),o=this.moveYear(this.viewDate,n)):viewMode==3?(s=this.moveMonth(this.date,n),o=this.moveMonth(this.viewDate,n)):viewMode==2?(s=this.moveDate(this.date,n*7),o=this.moveDate(this.viewDate,n*7)):viewMode==1?this.showMeridian?(s=this.moveHour(this.date,n*6),o=this.moveHour(this.viewDate,n*6)):(s=this.moveHour(this.date,n*4),o=this.moveHour(this.viewDate,n*4)):viewMode==0&&(s=this.moveMinute(this.date,n*4),o=this.moveMinute(this.viewDate,n*4)),this.dateWithinRange(s)&&(this.date=s,this.viewDate=o,this.setValue(),this.update(),e.preventDefault(),t=!0);break;case 13:if(this.viewMode!=0){var u=this.viewMode;this.showMode(-1),this.fill(),u==this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide();e.preventDefault();break;case 9:this.hide()}if(t){var a;this.isInput?a=this.element:this.component&&(a=this.element.find("input")),a&&a.change(),this.element.trigger({type:"changeDate",date:this.date})}},showMode:function(e){if(e){var t=Math.max(0,Math.min(o.modes.length-1,this.viewMode+e));t>=this.minView&&t<=this.maxView&&(this.element.trigger({type:"changeMode",date:this.viewDate,oldViewMode:this.viewMode,newViewMode:t}),this.viewMode=t)}this.picker.find(">div").hide().filter(".datetimepicker-"+o.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()},reset:function(e){this._setDate(null,"date")},convertViewModeText:function(e){switch(e){case 4:return"decade";case 3:return"year";case 2:return"month";case 1:return"day";case 0:return"hour"}}};var i=e.fn.datetimepicker;e.fn.datetimepicker=function(t){var n=Array.apply(null,arguments);n.shift();var i;return this.each(function(){var s=e(this),o=s.data("datetimepicker"),u=typeof t=="object"&&t;o||s.data("datetimepicker",o=new r(this,e.extend({},e.fn.datetimepicker.defaults,u)));if(typeof t=="string"&&typeof o[t]=="function"){i=o[t].apply(o,n);if(i!==undefined)return!1}}),i!==undefined?i:this},e.fn.datetimepicker.defaults={},e.fn.datetimepicker.Constructor=r;var s=e.fn.datetimepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridiem:["am","pm"],suffix:["st","nd","rd","th"],today:"Today"}},o={modes:[{clsName:"minutes",navFnc:"Hours",navStep:1},{clsName:"hours",navFnc:"Date",navStep:1},{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,o.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},getDefaultFormat:function(e,t){if(e=="standard")return t=="input"?"yyyy-mm-dd hh:ii":"yyyy-mm-dd hh:ii:ss";if(e=="php")return t=="input"?"Y-m-d H:i":"Y-m-d H:i:s";throw new Error("Invalid format type.")},validParts:function(e){if(e=="standard")return/hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;if(e=="php")return/[dDjlNwzFmMnStyYaABgGhHis]/g;throw new Error("Invalid format type.")},nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\rTZ]+/g,parseFormat:function(e,t){var n=e.replace(this.validParts(t),"\0").split("\0"),r=e.match(this.validParts(t));if(!n||!n.length||!r||r.length==0)throw new Error("Invalid date format.");return{separators:n,parts:r}},parseDate:function(n,i,o,u){if(n instanceof Date){var a=new Date(n.valueOf()-n.getTimezoneOffset()*6e4);return a.setMilliseconds(0),a}/^\d{4}\-\d{1,2}\-\d{1,2}$/.test(n)&&(i=this.parseFormat("yyyy-mm-dd",u)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}$/.test(n)&&(i=this.parseFormat("yyyy-mm-dd hh:ii",u)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}\:\d{1,2}[Z]{0,1}$/.test(n)&&(i=this.parseFormat("yyyy-mm-dd hh:ii:ss",u));if(/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(n)){var l=/([-+]\d+)([dmwy])/,c=n.match(/([-+]\d+)([dmwy])/g),h,p;n=new Date;for(var v=0;v<c.length;v++){h=l.exec(c[v]),p=parseInt(h[1]);switch(h[2]){case"d":n.setUTCDate(n.getUTCDate()+p);break;case"m":n=r.prototype.moveMonth.call(r.prototype,n,p);break;case"w":n.setUTCDate(n.getUTCDate()+p*7);break;case"y":n=r.prototype.moveYear.call(r.prototype,n,p)}}return t(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),0)}var c=n&&n.toString().match(this.nonpunctuation)||[],n=new Date(0,0,0,0,0,0,0),m={},y=["hh","h","ii","i","ss","s","yyyy","yy","M","MM","m","mm","D","DD","d","dd","H","HH","p","P"],b={hh:function(e,t){return e.setUTCHours(t)},h:function(e,t){return e.setUTCHours(t)},HH:function(e,t){return e.setUTCHours(t==12?0:t)},H:function(e,t){return e.setUTCHours(t==12?0:t)},ii:function(e,t){return e.setUTCMinutes(t)},i:function(e,t){return e.setUTCMinutes(t)},ss:function(e,t){return e.setUTCSeconds(t)},s:function(e,t){return e.setUTCSeconds(t)},yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){t-=1;while(t<0)t+=12;t%=12,e.setUTCMonth(t);while(e.getUTCMonth()!=t){if(isNaN(e.getUTCMonth()))return e;e.setUTCDate(e.getUTCDate()-1)}return e},d:function(e,t){return e.setUTCDate(t)},p:function(e,t){return e.setUTCHours(t==1?e.getUTCHours()+12:e.getUTCHours())}},w,E,h;b.M=b.MM=b.mm=b.m,b.dd=b.d,b.P=b.p,n=t(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds());if(c.length==i.parts.length){for(var v=0,S=i.parts.length;v<S;v++){w=parseInt(c[v],10),h=i.parts[v];if(isNaN(w))switch(h){case"MM":E=e(s[o].months).filter(function(){var e=this.slice(0,c[v].length),t=c[v].slice(0,e.length);return e==t}),w=e.inArray(E[0],s[o].months)+1;break;case"M":E=e(s[o].monthsShort).filter(function(){var e=this.slice(0,c[v].length),t=c[v].slice(0,e.length);return e.toLowerCase()==t.toLowerCase()}),w=e.inArray(E[0],s[o].monthsShort)+1;break;case"p":case"P":w=e.inArray(c[v].toLowerCase(),s[o].meridiem)}m[h]=w}for(var v=0,x;v<y.length;v++)x=y[v],x in m&&!isNaN(m[x])&&b[x](n,m[x])}return n},formatDate:function(t,n,r,i){if(t==null)return"";var u;if(i=="standard")u={yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear(),m:t.getUTCMonth()+1,M:s[r].monthsShort[t.getUTCMonth()],MM:s[r].months[t.getUTCMonth()],d:t.getUTCDate(),D:s[r].daysShort[t.getUTCDay()],DD:s[r].days[t.getUTCDay()],p:s[r].meridiem.length==2?s[r].meridiem[t.getUTCHours()<12?0:1]:"",h:t.getUTCHours(),i:t.getUTCMinutes(),s:t.getUTCSeconds()},s[r].meridiem.length==2?u.H=u.h%12==0?12:u.h%12:u.H=u.h,u.HH=(u.H<10?"0":"")+u.H,u.P=u.p.toUpperCase(),u.hh=(u.h<10?"0":"")+u.h,u.ii=(u.i<10?"0":"")+u.i,u.ss=(u.s<10?"0":"")+u.s,u.dd=(u.d<10?"0":"")+u.d,u.mm=(u.m<10?"0":"")+u.m;else{if(i!="php")throw new Error("Invalid format type.");u={y:t.getUTCFullYear().toString().substring(2),Y:t.getUTCFullYear(),F:s[r].months[t.getUTCMonth()],M:s[r].monthsShort[t.getUTCMonth()],n:t.getUTCMonth()+1,t:o.getDaysInMonth(t.getUTCFullYear(),t.getUTCMonth()),j:t.getUTCDate(),l:s[r].days[t.getUTCDay()],D:s[r].daysShort[t.getUTCDay()],w:t.getUTCDay(),N:t.getUTCDay()==0?7:t.getUTCDay(),S:t.getUTCDate()%10<=s[r].suffix.length?s[r].suffix[t.getUTCDate()%10-1]:"",a:s[r].meridiem.length==2?s[r].meridiem[t.getUTCHours()<12?0:1]:"",g:t.getUTCHours()%12==0?12:t.getUTCHours()%12,G:t.getUTCHours(),i:t.getUTCMinutes(),s:t.getUTCSeconds()},u.m=(u.n<10?"0":"")+u.n,u.d=(u.j<10?"0":"")+u.j,u.A=u.a.toString().toUpperCase(),u.h=(u.g<10?"0":"")+u.g,u.H=(u.G<10?"0":"")+u.G,u.i=(u.i<10?"0":"")+u.i,u.s=(u.s<10?"0":"")+u.s}var t=[],a=e.extend([],n.separators);for(var f=0,l=n.parts.length;f<l;f++)a.length&&t.push(a.shift()),t.push(u[n.parts[f]]);return a.length&&t.push(a.shift()),t.join("")},convertViewMode:function(e){switch(e){case 4:case"decade":e=4;break;case 3:case"year":e=3;break;case 2:case"month":e=2;break;case 1:case"day":e=1;break;case 0:case"hour":e=0}return e},headTemplate:'<thead><tr><th class="prev"><i class="{leftArrow}"/></th><th colspan="5" class="switch"></th><th class="next"><i class="{rightArrow}"/></th></tr></thead>',headTemplateV3:'<thead><tr><th class="prev"><span class="{iconType} {leftArrow}"></span> </th><th colspan="5" class="switch"></th><th class="next"><span class="{iconType} {rightArrow}"></span> </th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'};o.template='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+o.headTemplate+o.contTemplate+o.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+o.headTemplate+o.contTemplate+o.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+o.headTemplate+"<tbody></tbody>"+o.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+o.headTemplate+o.contTemplate+o.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+o.headTemplate+o.contTemplate+o.footTemplate+"</table></div></div>",o.templateV3='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+o.headTemplateV3+o.contTemplate+o.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+o.headTemplateV3+o.contTemplate+o.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+o.headTemplateV3+"<tbody></tbody>"+o.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+o.headTemplateV3+o.contTemplate+o.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+o.headTemplateV3+o.contTemplate+o.footTemplate+"</table></div></div>",e.fn.datetimepicker.DPGlobal=o,e.fn.datetimepicker.noConflict=function(){return e.fn.datetimepicker=i,this},e(document).on("focus.datetimepicker.data-api click.datetimepicker.data-api",'[data-provide="datetimepicker"]',function(t){var n=e(this);if(n.data("datetimepicker"))return;t.preventDefault(),n.datetimepicker("show")}),e(function(){e('[data-provide="datetimepicker-inline"]').datetimepicker()})}(window.jQuery),+function(e){"use strict";function t(t){return this.each(function(){var r=e(this),i=r.data("bs.toggle"),s="object"==typeof t&&t;i||r.data("bs.toggle",i=new n(this,s)),"string"==typeof t&&i[t]&&i[t]()})}var n=function(t,n){this.$element=e(t),this.options=e.extend({},this.defaults(),n),this.render()};n.VERSION="3.0.0",n.DEFAULTS={on:"On",off:"Off",onstyle:"primary",offstyle:"default",size:"normal",style:""},n.prototype.defaults=function(){return{on:this.$element.attr("data-on")||n.DEFAULTS.on,off:this.$element.attr("data-off")||n.DEFAULTS.off,onstyle:this.$element.attr("data-onstyle")||n.DEFAULTS.onstyle,offstyle:this.$element.attr("data-offstyle")||n.DEFAULTS.offstyle,size:this.$element.attr("data-size")||n.DEFAULTS.size,style:this.$element.attr("data-style")||n.DEFAULTS.style}},n.prototype.render=function(){this._onstyle="btn-"+this.options.onstyle,this._offstyle="btn-"+this.options.offstyle;var t="large"===this.options.size?"btn-lg":"small"===this.options.size?"btn-sm":"mini"===this.options.size?"btn-xs":"",n=e('<label class="btn">').html(this.options.on).addClass(this._onstyle+" "+t),r=e('<label class="btn">').html(this.options.off).addClass(this._offstyle+" "+t+" active"),i=e('<span class="toggle-handle btn btn-default">').addClass(t),s=e('<div class="toggle-group">').append(n,r,i),o=e('<div class="toggle btn" data-toggle="toggle">').addClass(this.$element.prop("checked")?this._onstyle:this._offstyle+" off").addClass(t).addClass(this.options.style);this.$element.wrap(o),e.extend(this,{$toggle:this.$element.parent(),$toggleOn:n,$toggleOff:r,$toggleGroup:s}),this.$toggle.append(s);var u=Math.max(n.outerWidth(),r.outerWidth())+i.outerWidth()/2,f=Math.max(n.outerHeight(),r.outerHeight());n.addClass("toggle-on"),r.addClass("toggle-off"),this.$toggle.css({width:u,height:f}),this.update(!0),this.trigger(!0)},n.prototype.toggle=function(){this.$element.prop("checked")?this.off():this.on()},n.prototype.on=function(e){return this.$element.prop("disabled")?!1:(this.$toggle.removeClass(this._offstyle+" off").addClass(this._onstyle),this.$element.prop("checked",!0),void (e||this.trigger()))},n.prototype.off=function(e){return this.$element.prop("disabled")?!1:(this.$toggle.removeClass(this._onstyle).addClass(this._offstyle+" off"),this.$element.prop("checked",!1),void (e||this.trigger()))},n.prototype.enable=function(){this.$toggle.removeAttr("disabled"),this.$element.prop("disabled",!1)},n.prototype.disable=function(){this.$toggle.attr("disabled","disabled"),this.$element.prop("disabled",!0)},n.prototype.update=function(e){this.$element.prop("disabled")?this.disable():this.enable(),this.$element.prop("checked")?this.on(e):this.off(e)},n.prototype.trigger=function(t){this.$element.off("change.bs.toggle"),t||this.$element.change(),this.$element.on("change.bs.toggle",e.proxy(function(){this.update()},this))},n.prototype.destroy=function(){this.$element.off("change.bs.toggle"),this.$toggleGroup.remove(),this.$element.removeData("bs.toggle"),this.$element.unwrap()};var r=e.fn.bootstrapToggle;e.fn.bootstrapToggle=t,e.fn.bootstrapToggle.Constructor=n,e.fn.toggle.noConflict=function(){return e.fn.bootstrapToggle=r,this},e(function(){e("input[type=checkbox][data-toggle^=toggle]").bootstrapToggle()}),e(document).on("click.bs.toggle","div[data-toggle^=toggle]",function(t){var n=e(this).find("input[type=checkbox]");n.bootstrapToggle("toggle"),t.preventDefault()})}(jQuery)
(function(e){e.editors.List=e.editors.Base.extend({events:{'click [data-action="add"]:last':function(e){e.preventDefault(),this.addItem(null,!0)}},initialize:function(t){t=t||{};var n=e.editors;n.Base.prototype.initialize.call(this,t);var r=this.schema;if(!r)throw new Error("Missing required option 'schema'");this.template=t.template||this.constructor.template,this.Editor=function(){var e=r.itemType;return e?n.List[e]?n.List[e]:n[e]:n.Text}(),this.items=[]},render:function(){var e=this,t=this.value||[],n=Backbone.$,r=n(n.trim(this.template()));return this.$list=r.is("[data-items]")?r:r.find("[data-items]"),t.length?_.each(t,function(t){e.addItem(t)}):this.Editor.isAsync||this.addItem(),e.schema.maxCardinality&&e.items.length>=e.schema.maxCardinality&&r.find('button[data-action="add"]:last').hide(),this.setElement(r),this.$el.attr("id",this.id),this.$el.attr("name",this.key),this.hasFocus&&this.trigger("blur",this),this},addItem:function(t,n){var r=this,i=e.editors,s=(new i.List.Item({list:this,form:this.form,schema:this.schema,value:t,Editor:this.Editor,key:this.key})).render(),o=function(){r.items.push(s),r.$list.append(s.el),r.schema.maxCardinality&&r.items.length>=r.schema.maxCardinality&&r.$el.find('button[data-action="add"]:last').hide(),s.editor.on("all",function(e){if(e==="change")return;var t=_.toArray(arguments);t[0]="item:"+e,t.splice(1,0,r),i.List.prototype.trigger.apply(this,t)},r),s.editor.on("change",function(){s.addEventTriggered||(s.addEventTriggered=!0,this.trigger("add",this,s.editor)),this.trigger("item:change",this,s.editor),this.trigger("change",this)},r),s.editor.on("focus",function(){if(this.hasFocus)return;this.trigger("focus",this)},r),s.editor.on("blur",function(){if(!this.hasFocus)return;var e=this;setTimeout(function(){if(_.find(e.items,function(e){return e.editor.hasFocus}))return;e.trigger("blur",e)},0)},r);if(n||t)s.addEventTriggered=!0;n&&(r.trigger("add",r,s.editor),r.trigger("change",r))};return this.Editor.isAsync?s.editor.on("readyToAdd",o,this):(o(),s.editor.focus()),s},removeItem:function(e){var t=this.schema.confirmDelete;if(t&&!confirm(t))return;var n=_.indexOf(this.items,e);this.items[n].remove(),this.items.splice(n,1),e.addEventTriggered&&(this.trigger("remove",this,e.editor),this.trigger("change",this)),!this.items.length&&!this.Editor.isAsync&&this.addItem(),this.schema.maxCardinality&&this.items.length<this.schema.maxCardinality&&this.$el.find('button[data-action="add"]:last').show()},getValue:function(){var e=_.map(this.items,function(e){return e.getValue()});return _.without(e,undefined,"")},setValue:function(e){this.value=e,this.render()},focus:function(){if(this.hasFocus)return;this.items[0]&&this.items[0].editor.focus()},blur:function(){if(!this.hasFocus)return;var e=_.find(this.items,function(e){return e.editor.hasFocus});e&&e.editor.blur()},remove:function(){_.invoke(this.items,"remove"),e.editors.Base.prototype.remove.call(this)},validate:function(){if(!this.validators)return null;var e=_.map(this.items,function(e){return e.validate()}),t=_.compact(e).length?!0:!1;if(!t)return null;var n={type:"list",message:"Some of the items in the list failed validation",errors:e};return n}},{template:_.template('      <div>        <div data-items></div>        <button type="button" data-action="add">Add</button>      </div>    ',null,e.templateSettings)}),e.editors.List.Item=e.editors.Base.extend({events:{'click [data-action="remove"]:last':function(e){e.preventDefault(),this.list.removeItem(this)},"keydown input[type=text]":function(e){if(e.keyCode!==13)return;e.preventDefault()}},initialize:function(t){this.list=t.list,this.schema=t.schema||this.list.schema,this.value=t.value,this.Editor=t.Editor||e.editors.Text,this.key=t.key,this.template=t.template||this.schema.itemTemplate||this.constructor.template,this.errorClassName=t.errorClassName||this.constructor.errorClassName,this.form=t.form},render:function(){var e=Backbone.$;this.editor=(new this.Editor({key:this.key,schema:this.schema,value:this.value,list:this.list,item:this,form:this.form})).render();var t=e(e.trim(this.template()));return t.find("[data-editor]").append(this.editor.el),this.setElement(t),this},getValue:function(){return this.editor.getValue()},setValue:function(e){this.editor.setValue(e)},focus:function(){this.editor.focus()},blur:function(){this.editor.blur()},remove:function(){this.editor.remove(),Backbone.View.prototype.remove.call(this)},validate:function(){var e=this.getValue(),t=this.list.form?this.list.form.getValue():{},n=this.schema.validators,r=this.getValidator;if(!n)return null;var i=null;return _.every(n,function(n){return i=r(n)(e,t),i?!1:!0}),i?this.setError(i):this.clearError(),i?i:null},setError:function(e){this.$el.addClass(this.errorClassName),this.$el.attr("title",e.message)},clearError:function(){this.$el.removeClass(this.errorClassName),this.$el.attr("title",null)}},{template:_.template('      <div>        <span data-editor></span>        <button type="button" data-action="remove">&times;</button>      </div>    ',null,e.templateSettings),errorClassName:"error"}),e.editors.List.Modal=e.editors.Base.extend({events:{click:"openEditor"},initialize:function(t){t=t||{},e.editors.Base.prototype.initialize.call(this,t);if(!e.editors.List.Modal.ModalAdapter)throw new Error("A ModalAdapter is required");this.form=t.form;if(!t.form)throw new Error('Missing required option: "form"');this.template=t.template||this.constructor.template},render:function(){var e=this;return _.isEmpty(this.value)?this.openEditor():(this.renderSummary(),setTimeout(function(){e.trigger("readyToAdd")},0)),this.hasFocus&&this.trigger("blur",this),this},renderSummary:function(){this.$el.html($.trim(this.template({summary:this.getStringValue()})))},itemToString:function(t){var n=function(t){var n={key:t};return e.Field.prototype.createTitle.call(n)};t=t||{};var r=[];return _.each(this.nestedSchema,function(e,i){var s=e.title?e.title:n(i),o=t[i];if(_.isUndefined(o)||_.isNull(o))o="";r.push(s+": "+o)}),r.join("<br />")},getStringValue:function(){var e=this.schema,t=this.getValue();return _.isEmpty(t)?"[Empty]":e.itemToString?e.itemToString(t):this.itemToString(t)},openEditor:function(){var t=this,n=this.form.constructor,r=this.modalForm=new n({schema:this.nestedSchema,data:this.value}),i=this.modal=new e.editors.List.Modal.ModalAdapter({content:r,animate:!0});i.open(),this.trigger("open",this),this.trigger("focus",this),i.on("cancel",this.onModalClosed,this),i.on("ok",_.bind(this.onModalSubmitted,this))},onModalSubmitted:function(){var e=this.modal,t=this.modalForm,n=!this.value,r=t.validate();if(r)return e.preventClose();this.value=t.getValue(),this.renderSummary(),n&&this.trigger("readyToAdd"),this.trigger("change",this),this.onModalClosed()},onModalClosed:function(){this.modal=null,this.modalForm=null,this.trigger("close",this),this.trigger("blur",this)},getValue:function(){return this.value},setValue:function(e){this.value=e},focus:function(){if(this.hasFocus)return;this.openEditor()},blur:function(){if(!this.hasFocus)return;this.modal&&this.modal.trigger("cancel")}},{template:_.template("      <div><%= summary %></div>    ",null,e.templateSettings),ModalAdapter:Backbone.BootstrapModal,isAsync:!0}),e.editors.List.Object=e.editors.List.Modal.extend({initialize:function(){e.editors.List.Modal.prototype.initialize.apply(this,arguments);var t=this.schema;if(!t.subSchema)throw new Error('Missing required option "schema.subSchema"');this.nestedSchema=t.subSchema}}),e.editors.List.NestedModel=e.editors.List.Modal.extend({initialize:function(){e.editors.List.Modal.prototype.initialize.apply(this,arguments);var t=this.schema;if(!t.model)throw new Error('Missing required option "schema.model"');var n=t.model.prototype.schema;this.nestedSchema=_.isFunction(n)?n():n},getStringValue:function(){var e=this.schema,t=this.getValue();return _.isEmpty(t)?null:e.itemToString?e.itemToString(t):(new e.model(t)).toString()}})})(Backbone.Form),function(e){e.template=_.template('    <form class="form-horizontal" role="form">      <div data-fieldsets></div>      <% if (submitButton) { %>        <button type="submit" class="btn"><%= submitButton %></button>      <% } %>    </form>  '),e.Fieldset.template=_.template("    <fieldset data-fields>      <% if (legend) { %>        <legend><%= legend %></legend>      <% } %>    </fieldset>  "),e.Field.template=_.template('    <div class="form-group field-<%= key %>">      <label class="col-sm-2 control-label" for="<%= editorId %>">        <% if (titleHTML){ %><%= titleHTML %>        <% } else { %><%- title %><% } %>      </label>      <div class="col-sm-10">        <span data-editor></span>        <p class="help-block" data-error></p>        <p class="help-block"><%= help %></p>      </div>    </div>  '),e.NestedField.template=_.template('    <div class="field-<%= key %>">      <div title="<% if (titleHTML){ %><%= titleHTML %><% } else { %><%- title %><% } %>" class="input-xlarge">        <span data-editor></span>        <div class="help-inline" data-error></div>      </div>      <div class="help-block"><%= help %></div>    </div>  '),e.editors.Base.prototype.className="form-control",e.Field.errorClassName="has-error",e.editors.List&&(e.editors.List.template=_.template('      <div class="bbf-list">        <div class="bbf-list-contents">          <ul class="list-unstyled clearfix" data-items></ul>        </div>        <div class="bbf-list-buttons">          <button type="button" class="btn btn-default bbf-add" data-action="add"><span class="glyphicon glyphicon-plus"></span> add value</button>        </div>      </div>    '),e.editors.List.Item.template=_.template('      <li class="clearfix">        <div class="input-group">          <div data-editor></div>          <span class="input-group-btn">            <button type="button" class="btn btn-default bbf-del" data-action="remove">&times;</button>          </span>        </div>      </li>    '),e.editors.List.Object.template=e.editors.List.NestedModel.template=_.template('      <div class="bbf-list-modal"><%= summary %></div>    '))}(Backbone.Form),!function(e){"use strict";var t=function(e){var t=arguments,n=!0,r=1;return e=e.replace(/%s/g,function(){var e=t[r++];return typeof e=="undefined"?(n=!1,""):e}),n?e:""},n=function(t,n,r,i){var s="";return e.each(t,function(e,t){return t[n]===i?(s=t[r],!1):!0}),s},r=function(t,n){var r=-1;return e.each(t,function(e,t){return t.field===n?(r=e,!1):!0}),r},i=function(){var t=e("<p/>").addClass("fixed-table-scroll-inner"),n=e("<div/>").addClass("fixed-table-scroll-outer"),r,i;return n.append(t),e("body").append(n),r=t[0].offsetWidth,n.css("overflow","scroll"),i=t[0].offsetWidth,r===i&&(i=n[0].clientWidth),n.remove(),r-i},s=function(t,n,r,i){if(typeof n=="string"){var s=n.split(".");s.length>1?(n=window,e.each(s,function(e,t){n=n[t]})):n=window[n]}return typeof n=="object"?n:typeof n=="function"?n.apply(t,r):i},o=function(e){return typeof e=="string"?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):e},u=function(t,n){this.options=n,this.$el=e(t),this.$el_=this.$el.clone(),this.timeoutId_=0,this.init()};u.DEFAULTS={classes:"table table-hover",height:undefined,undefinedText:"-",sortName:undefined,sortOrder:"asc",striped:!1,columns:[],data:[],method:"get",url:undefined,cache:!0,contentType:"application/json",dataType:"json",ajaxOptions:{},queryParams:function(e){return e},queryParamsType:"limit",responseHandler:function(e){return e},pagination:!1,sidePagination:"client",totalRows:0,pageNumber:1,pageSize:10,pageList:[10,25,50,100],search:!1,searchAlign:"right",selectItemName:"btSelectItem",showHeader:!0,showColumns:!1,showPaginationSwitch:!1,showRefresh:!1,showToggle:!1,buttonsAlign:"right",smartDisplay:!0,minimumCountColumns:1,idField:undefined,cardView:!1,trimOnSearch:!0,clickToSelect:!1,singleSelect:!1,toolbar:undefined,toolbarAlign:"left",checkboxHeader:!0,sortable:!0,maintainSelected:!1,searchTimeOut:500,iconSize:undefined,iconsPrefix:"glyphicon",icons:{paginationSwitchDown:"glyphicon-collapse-down icon-chevron-down",paginationSwitchUp:"glyphicon-collapse-up icon-chevron-up",refresh:"glyphicon-refresh icon-refresh",toggle:"glyphicon-list-alt icon-list-alt",columns:"glyphicon-th icon-th"},rowStyle:function(e,t){return{}},rowAttributes:function(e,t){return{}},onAll:function(e,t){return!1},onClickRow:function(e,t){return!1},onDblClickRow:function(e,t){return!1},onSort:function(e,t){return!1},onCheck:function(e){return!1},onUncheck:function(e){return!1},onCheckAll:function(){return!1},onUncheckAll:function(){return!1},onLoadSuccess:function(e){return!1},onLoadError:function(e){return!1},onColumnSwitch:function(e,t){return!1},onPageChange:function(e,t){return!1},onSearch:function(e){return!1},onPreBody:function(e){return!1},onPostBody:function(){return!1}},u.LOCALES=[],u.LOCALES["en-US"]={formatLoadingMessage:function(){return"Loading, please wait..."},formatRecordsPerPage:function(e){return t("%s records per page",e)},formatShowingRows:function(e,n,r){return t("Showing %s to %s of %s rows",e,n,r)},formatSearch:function(){return"Search"},formatNoMatches:function(){return"No matching records found"},formatPaginationSwitch:function(){return"Hide/Show pagination"},formatRefresh:function(){return"Refresh"},formatToggle:function(){return"Toggle"},formatColumns:function(){return"Columns"}},e.extend(u.DEFAULTS,u.LOCALES["en-US"]),u.COLUMN_DEFAULTS={radio:!1,checkbox:!1,checkboxEnabled:!0,field:undefined,title:undefined,"class":undefined,align:undefined,halign:undefined,valign:undefined,width:undefined,sortable:!1,order:"asc",visible:!0,switchable:!0,clickToSelect:!0,formatter:undefined,events:undefined,sorter:undefined,cellStyle:undefined,searchable:!0},u.EVENTS={"all.bs.table":"onAll","click-row.bs.table":"onClickRow","dbl-click-row.bs.table":"onDblClickRow","sort.bs.table":"onSort","check.bs.table":"onCheck","uncheck.bs.table":"onUncheck","check-all.bs.table":"onCheckAll","uncheck-all.bs.table":"onUncheckAll","load-success.bs.table":"onLoadSuccess","load-error.bs.table":"onLoadError","column-switch.bs.table":"onColumnSwitch","page-change.bs.table":"onPageChange","search.bs.table":"onSearch","pre-body.bs.table":"onPreBody","post-body.bs.table":"onPostBody"},u.prototype.init=function(){this.initContainer(),this.initTable(),this.initHeader(),this.initData(),this.initToolbar(),this.initPagination(),this.initBody(),this.initServer()},u.prototype.initContainer=function(){this.$container=e(['<div class="bootstrap-table">','<div class="fixed-table-toolbar"></div>','<div class="fixed-table-container">','<div class="fixed-table-header"><table></table></div>','<div class="fixed-table-body">','<div class="fixed-table-loading">',this.options.formatLoadingMessage(),"</div>","</div>",'<div class="fixed-table-pagination"></div>',"</div>","</div>"].join("")),this.$container.insertAfter(this.$el),this.$container.find(".fixed-table-body").append(this.$el),this.$container.after('<div class="clearfix"></div>'),this.$loading=this.$container.find(".fixed-table-loading"),this.$el.addClass(this.options.classes),this.options.striped&&this.$el.addClass("table-striped")},u.prototype.initTable=function(){var t=this,n=[],r=[];this.$header=this.$el.find("thead"),this.$header.length||(this.$header=e("<thead></thead>").appendTo(this.$el)),this.$header.find("tr").length||this.$header.append("<tr></tr>"),this.$header.find("th").each(function(){var t=e.extend({},{title:e(this).html(),"class":e(this).attr("class")},e(this).data());n.push(t)}),this.options.columns=e.extend([],n,this.options.columns),e.each(this.options.columns,function(n,r){t.options.columns[n]=e.extend({},u.COLUMN_DEFAULTS,{field:n},r)});if(this.options.data.length)return;this.$el.find("tbody tr").each(function(){var n={};n._id=e(this).attr("id"),n._class=e(this).attr("class"),e(this).find("td").each(function(r){var i=t.options.columns[r].field;n[i]=e(this).html(),n["_"+i+"_id"]=e(this).attr("id"),n["_"+i+"_class"]=e(this).attr("class")}),r.push(n)}),this.options.data=r},u.prototype.initHeader=function(){var n=this,r=[],i=[];this.header={fields:[],styles:[],classes:[],formatters:[],events:[],sorters:[],cellStyles:[],clickToSelects:[],searchables:[]},e.each(this.options.columns,function(e,s){var o="",u="",a="",f="",l=t(' class="%s"',s["class"]),c=n.options.sortOrder||s.order,h=!0;if(!s.visible)return;u=t("text-align: %s; ",s.halign?s.halign:s.align),a=t("text-align: %s; ",s.align),f=t("vertical-align: %s; ",s.valign),f+=t("width: %spx; ",s.checkbox||s.radio?36:s.width),r.push(s),n.header.fields.push(s.field),n.header.styles.push(a+f),n.header.classes.push(l),n.header.formatters.push(s.formatter),n.header.events.push(s.events),n.header.sorters.push(s.sorter),n.header.cellStyles.push(s.cellStyle),n.header.clickToSelects.push(s.clickToSelect),n.header.searchables.push(s.searchable),i.push("<th",s.checkbox||s.radio?t(' class="bs-checkbox %s"',s["class"]||""):l,t(' style="%s"',u+f),">"),i.push(t('<div class="th-inner %s">',n.options.sortable&&s.sortable?"sortable":"")),o=s.title,n.options.sortName===s.field&&n.options.sortable&&s.sortable&&(o+=n.getCaretHtml()),s.checkbox&&(!n.options.singleSelect&&n.options.checkboxHeader&&(o='<input name="btSelectAll" type="checkbox" />'),n.header.stateField=s.field),s.radio&&(o="",n.header.stateField=s.field,n.options.singleSelect=!0),i.push(o),i.push("</div>"),i.push('<div class="fht-cell"></div>'),i.push("</th>")}),this.$header.find("tr").html(i.join("")),this.$header.find("th").each(function(t){e(this).data(r[t])}),this.$container.off("click","th").on("click","th",function(t){n.options.sortable&&e(this).data().sortable&&n.onSort(t)}),!this.options.showHeader||this.options.cardView?(this.$header.hide(),this.$container.find(".fixed-table-header").hide(),this.$loading.css("top",0)):(this.$header.show(),this.$container.find(".fixed-table-header").show(),this.$loading.css("top","37px")),this.$selectAll=this.$header.find('[name="btSelectAll"]'),this.$container.off("click",'[name="btSelectAll"]').on("click",'[name="btSelectAll"]',function(){var t=e(this).prop("checked");n[t?"checkAll":"uncheckAll"]()})},u.prototype.initData=function(e,t){t==="append"?this.data=this.data.concat(e):t==="prepend"?this.data=e.concat(this.data):this.data=e||this.options.data,this.options.data=this.data;if(this.options.sidePagination==="server")return;this.initSort()},u.prototype.initSort=function(){var t=this,n=this.options.sortName,r=this.options.sortOrder==="desc"?-1:1,i=e.inArray(this.options.sortName,this.header.fields);i!==-1&&this.data.sort(function(o,u){var a=o[n],f=u[n],l=s(t.header,t.header.sorters[i],[a,f]);if(l!==undefined)return r*l;e.isNumeric(a)&&(a=parseFloat(a)),e.isNumeric(f)&&(f=parseFloat(f));if(a===undefined||a===null)a="";if(f===undefined||f===null)f="";return e.isNumeric(a)&&e.isNumeric(f)?a<f?r*-1:r:a===f?0:a.localeCompare(f)===-1?r*-1:r})},u.prototype.onSort=function(t){var n=e(t.currentTarget),r=this.$header.find("th").eq(n.index());this.$header.add(this.$header_).find("span.order").remove(),this.options.sortName===n.data("field")?this.options.sortOrder=this.options.sortOrder==="asc"?"desc":"asc":(this.options.sortName=n.data("field"),this.options.sortOrder=n.data("order")==="asc"?"desc":"asc"),this.trigger("sort",this.options.sortName,this.options.sortOrder),n.add(r).data("order",this.options.sortOrder).find(".th-inner").append(this.getCaretHtml());if(this.options.sidePagination==="server"){this.initServer();return}this.initSort(),this.initBody()},u.prototype.initToolbar=function(){var n=this,r=[],i=0,o,u,a=0;this.$toolbar=this.$container.find(".fixed-table-toolbar").html(""),typeof this.options.toolbar=="string"&&e(t('<div class="bars pull-%s"></div>',this.options.toolbarAlign)).appendTo(this.$toolbar).append(e(this.options.toolbar)),r=[t('<div class="columns columns-%s btn-group pull-%s">',this.options.buttonsAlign,this.options.buttonsAlign)],typeof this.options.icons=="string"&&(this.options.icons=s(null,this.options.icons)),this.options.showPaginationSwitch&&r.push(t('<button class="btn btn-default" type="button" name="paginationSwitch" title="%s">',this.options.formatPaginationSwitch()),t('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.paginationSwitchDown),"</button>"),this.options.showRefresh&&r.push(t('<button class="btn btn-default'+(this.options.iconSize==undefined?"":" btn-"+this.options.iconSize)+'" type="button" name="refresh" title="%s">',this.options.formatRefresh()),t('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.refresh),"</button>"),this.options.showToggle&&r.push(t('<button class="btn btn-default'+(this.options.iconSize==undefined?"":" btn-"+this.options.iconSize)+'" type="button" name="toggle" title="%s">',this.options.formatToggle()),t('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.toggle),"</button>"),this.options.showColumns&&(r.push(t('<div class="keep-open btn-group" title="%s">',this.options.formatColumns()),'<button type="button" class="btn btn-default'+(this.options.iconSize==undefined?"":" btn-"+this.options.iconSize)+' dropdown-toggle" data-toggle="dropdown">',t('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.columns),' <span class="caret"></span>',"</button>",'<ul class="dropdown-menu" role="menu">'),e.each(this.options.columns,function(e,n){if(n.radio||n.checkbox)return;var i=n.visible?' checked="checked"':"";n.switchable&&(r.push(t('<li><label><input type="checkbox" data-field="%s" value="%s"%s> %s</label></li>',n.field,e,i,n.title)),a++)}),r.push("</ul>","</div>")),r.push("</div>"),(this.showToolbar||r.length>2)&&this.$toolbar.append(r.join("")),this.options.showPaginationSwitch&&this.$toolbar.find('button[name="paginationSwitch"]').off("click").on("click",e.proxy(this.togglePagination,this)),this.options.showRefresh&&this.$toolbar.find('button[name="refresh"]').off("click").on("click",e.proxy(this.refresh,this)),this.options.showToggle&&this.$toolbar.find('button[name="toggle"]').off("click").on("click",function(){n.options.cardView=!n.options.cardView,n.initHeader(),n.initBody()}),this.options.showColumns&&(o=this.$toolbar.find(".keep-open"),a<=this.options.minimumCountColumns&&o.find("input").prop("disabled",!0),o.find("li").off("click").on("click",function(e){e.stopImmediatePropagation()}),o.find("input").off("click").on("click",function(){var t=e(this);n.toggleColumn(t.val(),t.prop("checked"),!1),n.trigger("column-switch",e(this).data("field"),t.prop("checked"))})),this.options.search&&(r=[],r.push('<div class="pull-'+this.options.searchAlign+' search">',t('<input class="form-control'+(this.options.iconSize==undefined?"":" input-"+this.options.iconSize)+'" type="text" placeholder="%s">',this.options.formatSearch()),"</div>"),this.$toolbar.append(r.join("")),u=this.$toolbar.find(".search input"),u.off("keyup").on("keyup",function(e){clearTimeout(i),i=setTimeout(function(){n.onSearch(e)},n.options.searchTimeOut)}))},u.prototype.onSearch=function(t){var n=e.trim(e(t.currentTarget).val());this.options.trimOnSearch&&e(t.currentTarget).val(n);if(n===this.searchText)return;this.searchText=n,this.options.pageNumber=1,this.initSearch(),this.updatePagination(),this.trigger("search",n)},u.prototype.initSearch=function(){var t=this;if(this.options.sidePagination!=="server"){var n=this.searchText&&this.searchText.toLowerCase(),r=e.isEmptyObject(this.filterColumns)?null:this.filterColumns;this.data=r?e.grep(this.options.data,function(e,t){for(var n in r)if(e[n]!==r[n])return!1;return!0}):this.options.data,this.data=n?e.grep(this.data,function(r,i){for(var o in r){o=e.isNumeric(o)?parseInt(o,10):o;var u=r[o];u=s(t.header,t.header.formatters[e.inArray(o,t.header.fields)],[u,r,i],u);var a=e.inArray(o,t.header.fields);if(a!==-1&&t.header.searchables[a]&&(typeof u=="string"||typeof u=="number")&&(u+"").toLowerCase().indexOf(n)!==-1)return!0}return!1}):this.data}},u.prototype.initPagination=function(){this.$pagination=this.$container.find(".fixed-table-pagination");if(!this.options.pagination){this.$pagination.hide();return}this.$pagination.show();var n=this,r=[],i,s,o,u,a,f,l,c,h,p=this.getData();this.options.sidePagination!=="server"&&(this.options.totalRows=p.length),this.totalPages=0,this.options.totalRows&&(this.totalPages=~~((this.options.totalRows-1)/this.options.pageSize)+1,this.options.totalPages=this.totalPages),this.totalPages>0&&this.options.pageNumber>this.totalPages&&(this.options.pageNumber=this.totalPages),this.pageFrom=(this.options.pageNumber-1)*this.options.pageSize+1,this.pageTo=this.options.pageNumber*this.options.pageSize,this.pageTo>this.options.totalRows&&(this.pageTo=this.options.totalRows),r.push('<div class="pull-left pagination-detail">','<span class="pagination-info">',this.options.formatShowingRows(this.pageFrom,this.pageTo,this.options.totalRows),"</span>"),r.push('<span class="page-list">');var d=['<span class="btn-group dropup">','<button type="button" class="btn btn-default '+(this.options.iconSize==undefined?"":" btn-"+this.options.iconSize)+' dropdown-toggle" data-toggle="dropdown">','<span class="page-size">',this.options.pageSize,"</span>",' <span class="caret"></span>',"</button>",'<ul class="dropdown-menu" role="menu">'],v=this.options.pageList;if(typeof this.options.pageList=="string"){var m=this.options.pageList.replace("[","").replace("]","").replace(/ /g,"").split(",");v=[],e.each(m,function(e,t){v.push(+t)})}e.each(v,function(e,r){if(!n.options.smartDisplay||e===0||v[e-1]<=n.options.totalRows){var i=r===n.options.pageSize?' class="active"':"";d.push(t('<li%s><a href="javascript:void(0)">%s</a></li>',i,r))}}),d.push("</ul></span>"),r.push(this.options.formatRecordsPerPage(d.join(""))),r.push("</span>"),r.push("</div>",'<div class="pull-right pagination">','<ul class="pagination'+(this.options.iconSize==undefined?"":" pagination-"+this.options.iconSize)+'">','<li class="page-first"><a href="javascript:void(0)">&lt;&lt;</a></li>','<li class="page-pre"><a href="javascript:void(0)">&lt;</a></li>'),this.totalPages<5?(s=1,o=this.totalPages):(s=this.options.pageNumber-2,o=s+4,s<1&&(s=1,o=5),o>this.totalPages&&(o=this.totalPages,s=o-4));for(i=s;i<=o;i++)r.push('<li class="page-number'+(i===this.options.pageNumber?" active disabled":"")+'">','<a href="javascript:void(0)">',i,"</a>","</li>");r.push('<li class="page-next"><a href="javascript:void(0)">&gt;</a></li>','<li class="page-last"><a href="javascript:void(0)">&gt;&gt;</a></li>',"</ul>","</div>"),this.$pagination.html(r.join("")),u=this.$pagination.find(".page-list a"),a=this.$pagination.find(".page-first"),f=this.$pagination.find(".page-pre"),l=this.$pagination.find(".page-next"),c=this.$pagination.find(".page-last"),h=this.$pagination.find(".page-number"),this.options.pageNumber<=1&&(a.addClass("disabled"),f.addClass("disabled")),this.options.pageNumber>=this.totalPages&&(l.addClass("disabled"),c.addClass("disabled")),this.options.smartDisplay&&(this.totalPages<=1&&this.$pagination.find("div.pagination").hide(),(this.options.pageList.length<2||this.options.totalRows<=this.options.pageList[0])&&this.$pagination.find("span.page-list").hide(),this.$pagination[this.getData().length?"show":"hide"]()),u.off("click").on("click",e.proxy(this.onPageListChange,this)),a.off("click").on("click",e.proxy(this.onPageFirst,this)),f.off("click").on("click",e.proxy(this.onPagePre,this)),l.off("click").on("click",e.proxy(this.onPageNext,this)),c.off("click").on("click",e.proxy(this.onPageLast,this)),h.off("click").on("click",e.proxy(this.onPageNumber,this))},u.prototype.updatePagination=function(t){if(t&&e(t.currentTarget).hasClass("disabled"))return;this.options.maintainSelected||this.resetRows(),this.initPagination(),this.options.sidePagination==="server"?this.initServer():this.initBody(),this.trigger("page-change",this.options.pageNumber,this.options.pageSize)},u.prototype.onPageListChange=function(t){var n=e(t.currentTarget);n.parent().addClass("active").siblings().removeClass("active"),this.options.pageSize=+n.text(),this.$toolbar.find(".page-size").text(this.options.pageSize),this.updatePagination(t)},u.prototype.onPageFirst=function(e){this.options.pageNumber=1,this.updatePagination(e)},u.prototype.onPagePre=function(e){this.options.pageNumber--,this.updatePagination(e)},u.prototype.onPageNext=function(e){this.options.pageNumber++,this.updatePagination(e)},u.prototype.onPageLast=function(e){this.options.pageNumber=this.totalPages,this.updatePagination(e)},u.prototype.onPageNumber=function(t){if(this.options.pageNumber===+e(t.currentTarget).text())return;this.options.pageNumber=+e(t.currentTarget).text(),this.updatePagination(t)},u.prototype.initBody=function(i){var u=this,a=[],f=this.getData();this.trigger("pre-body",f),this.$body=this.$el.find("tbody"),this.$body.length||(this.$body=e("<tbody></tbody>").appendTo(this.$el));if(!this.options.pagination||this.options.sidePagination==="server")this.pageFrom=1,this.pageTo=f.length;for(var l=this.pageFrom-1;l<this.pageTo;l++){var c=f[l],h={},p=[],d={},v=[];h=s(this.options,this.options.rowStyle,[c,l],h);if(h&&h.css)for(var m in h.css)p.push(m+": "+h.css[m]);d=s(this.options,this.options.rowAttributes,[c,l],d);if(d)for(var m in d)v.push(t('%s="%s"',m,o(d[m])));a.push("<tr",t(" %s",v.join(" ")),t(' id="%s"',e.isArray(c)?undefined:c._id),t(' class="%s"',h.classes||(e.isArray(c)?undefined:c._class)),t(' data-index="%s"',l),">"),this.options.cardView&&a.push(t('<td colspan="%s">',this.header.fields.length)),e.each(this.header.fields,function(e,i){var o="",f=c[i],d="",v={},m="",g=u.header.classes[e],y=u.options.columns[r(u.options.columns,i)];h=t('style="%s"',p.concat(u.header.styles[e]).join("; ")),f=s(u.header,u.header.formatters[e],[f,c,l],f),c["_"+i+"_id"]&&(m=t(' id="%s"',c["_"+i+"_id"])),c["_"+i+"_class"]&&(g=t(' class="%s"',c["_"+i+"_class"])),v=s(u.header,u.header.cellStyles[e],[f,c,l],v),v.classes&&(g=t(' class="%s"',v.classes));if(v.css){var b=[];for(var w in v.css)b.push(w+": "+v.css[w]);h=t('style="%s"',b.concat(u.header.styles[e]).join("; "))}if(y.checkbox||y.radio){if(u.options.cardView)return!0;d=y.checkbox?"checkbox":d,d=y.radio?"radio":d,o=['<td class="bs-checkbox">',"<input"+t(' data-index="%s"',l)+t(' name="%s"',u.options.selectItemName)+t(' type="%s"',d)+t(' value="%s"',c[u.options.idField])+t(' checked="%s"',f===!0||f&&f.checked?"checked":undefined)+t(' disabled="%s"',!y.checkboxEnabled||f&&f.disabled?"disabled":undefined)+" />","</td>"].join("")}else f=typeof f=="undefined"||f===null?u.options.undefinedText:f,o=u.options.cardView?['<div class="card-view">',u.options.showHeader?t('<span class="title" %s>%s</span>',h,n(u.options.columns,"field","title",i)):"",t('<span class="value">%s</span>',f),"</div>"].join(""):[t("<td%s %s %s>",m,g,h),f,"</td>"].join(""),u.options.cardView&&u.options.smartDisplay&&f===""&&(o="");a.push(o)}),this.options.cardView&&a.push("</td>"),a.push("</tr>")}a.length||a.push('<tr class="no-records-found">',t('<td colspan="%s">%s</td>',this.header.fields.length,this.options.formatNoMatches()),"</tr>"),this.$body.html(a.join("")),i||this.scrollTo(0),this.$body.find("> tr > td").off("click").on("click",function(){var n=e(this).parent();u.trigger("click-row",u.data[n.data("index")],n),u.options.clickToSelect&&u.header.clickToSelects[n.children().index(e(this))]&&n.find(t('[name="%s"]',u.options.selectItemName))[0].click()}),this.$body.find("tr").off("dblclick").on("dblclick",function(){u.trigger("dbl-click-row",u.data[e(this).data("index")],e(this))}),this.$selectItem=this.$body.find(t('[name="%s"]',this.options.selectItemName)),this.$selectItem.off("click").on("click",function(t){t.stopImmediatePropagation();var n=e(this).prop("checked"),r=u.data[e(this).data("index")];r[u.header.stateField]=n,u.trigger(n?"check":"uncheck",r),u.options.singleSelect&&(u.$selectItem.not(this).each(function(){u.data[e(this).data("index")][u.header.stateField]=!1}),u.$selectItem.filter(":checked").not(this).prop("checked",!1)),u.updateSelected()}),e.each(this.header.events,function(t,n){if(!n)return;typeof n=="string"&&(n=s(null,n));for(var r in n)u.$body.find("tr").each(function(){var i=e(this),s=i.find(u.options.cardView?".card-view":"td").eq(t),o=r.indexOf(" "),a=r.substring(0,o),f=r.substring(o+1),l=n[r];s.find(f).off(a).on(a,function(e){var n=i.data("index"),r=u.data[n],s=r[u.header.fields[t]];l.apply(this,[e,s,r,n])})})}),this.updateSelected(),this.resetView(),this.trigger("post-body")},u.prototype.initServer=function(t,n){var r=this,i={},o={pageSize:this.options.pageSize,pageNumber:this.options.pageNumber,searchText:this.searchText,sortName:this.options.sortName,sortOrder:this.options.sortOrder};if(!this.options.url)return;this.options.queryParamsType==="limit"&&(o={search:o.searchText,sort:o.sortName,order:o.sortOrder},this.options.pagination&&(o.limit=this.options.pageSize,o.offset=this.options.pageSize*(this.options.pageNumber-1))),i=s(this.options,this.options.queryParams,[o],i),e.extend(i,n||{});if(i===!1)return;t||this.$loading.show(),e.ajax(e.extend({},s(null,this.options.ajaxOptions),{type:this.options.method,url:this.options.url,data:this.options.contentType==="application/json"&&this.options.method==="post"?JSON.stringify(i):i,cache:this.options.cache,contentType:this.options.contentType,dataType:this.options.dataType,success:function(e){e=s(r.options,r.options.responseHandler,[e],e),r.load(e),r.trigger("load-success",e)},error:function(e){r.trigger("load-error",e.status)},complete:function(){t||r.$loading.hide()}}))},u.prototype.getCaretHtml=function(){return['<span class="order'+(this.options.sortOrder==="desc"?"":" dropup")+'">','<span class="caret" style="margin: 10px 5px;"></span>',"</span>"].join("")},u.prototype.updateSelected=function(){var t=this.$selectItem.filter(":enabled").length===this.$selectItem.filter(":enabled").filter(":checked").length;this.$selectAll.add(this.$selectAll_).prop("checked",t),this.$selectItem.each(function(){e(this).parents("tr")[e(this).prop("checked")?"addClass":"removeClass"]("selected")})},u.prototype.updateRows=function(t){var n=this;this.$selectItem.each(function(){n.data[e(this).data("index")][n.header.stateField]=t})},u.prototype.resetRows=function(){var t=this;e.each(this.data,function(e,n){t.$selectAll.prop("checked",!1),t.$selectItem.prop("checked",!1),n[t.header.stateField]=!1})},u.prototype.trigger=function(t){var n=Array.prototype.slice.call(arguments,1);t+=".bs.table",this.options[u.EVENTS[t]].apply(this.options,n),this.$el.trigger(e.Event(t),n),this.options.onAll(t,n),this.$el.trigger(e.Event("all.bs.table"),[t,n])},u.prototype.resetHeader=function(){var t=this,n=this.$container.find(".fixed-table-header"),r=this.$container.find(".fixed-table-body"),s=this.$el.width()>r.width()?i():0;if(this.$el.is(":hidden")){clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(e.proxy(this.resetHeader,this),100);return}this.$header_=this.$header.clone(!0,!0),this.$selectAll_=this.$header_.find('[name="btSelectAll"]'),setTimeout(function(){n.css({height:"37px","border-bottom":"1px solid #dddddd","margin-right":s}).find("table").css("width",t.$el.css("width")).html("").attr("class",t.$el.attr("class")).append(t.$header_),t.$header.find("th").each(function(n){t.$header_.find("th").eq(n).data(e(this).data())}),t.$body.find("tr:first-child:not(.no-records-found) > *").each(function(n){t.$header_.find("div.fht-cell").eq(n).width(e(this).innerWidth())}),t.$el.css("margin-top",-t.$header.height()),r.off("scroll").on("scroll",function(){n.scrollLeft(e(this).scrollLeft())})})},u.prototype.toggleColumn=function(e,n,r){if(e===-1)return;this.options.columns[e].visible=n,this.initHeader(),this.initSearch(),this.initPagination(),this.initBody();if(this.options.showColumns){var i=this.$toolbar.find(".keep-open input").prop("disabled",!1);r&&i.filter(t('[value="%s"]',e)).prop("checked",n),i.filter(":checked").length<=this.options.minimumCountColumns&&i.filter(":checked").prop("disabled",!0)}},u.prototype.resetView=function(e){var t=this,n=this.header;e&&e.height&&(this.options.height=e.height),this.$selectAll.prop("checked",this.$selectItem.length>0&&this.$selectItem.length===this.$selectItem.filter(":checked").length);if(this.options.height){var r=+this.$toolbar.children().outerHeight(!0),i=+this.$pagination.children().outerHeight(!0),s=this.options.height-r-i;this.$container.find(".fixed-table-container").css("height",s+"px")}if(this.options.cardView){t.$el.css("margin-top","0"),t.$container.find(".fixed-table-container").css("padding-bottom","0");return}this.options.showHeader&&this.options.height&&this.resetHeader(),this.options.height&&this.options.showHeader&&this.$container.find(".fixed-table-container").css("padding-bottom","37px")},u.prototype.getData=function(){return this.searchText||!e.isEmptyObject(this.filterColumns)?this.data:this.options.data},u.prototype.load=function(e){this.options.sidePagination==="server"&&(this.options.totalRows=e.total,e=e.rows),this.initData(e),this.initSearch(),this.initPagination(),this.initBody()},u.prototype.append=function(e){this.initData(e,"append"),this.initSearch(),this.initPagination(),this.initBody(!0)},u.prototype.prepend=function(e){this.initData(e,"prepend"),this.initSearch(),this.initPagination(),this.initBody(!0)},u.prototype.remove=function(t){var n=this.options.data.length,r,i;if(!t.hasOwnProperty("field")||!t.hasOwnProperty("values"))return;for(r=n-1;r>=0;r--){i=this.options.data[r];if(!i.hasOwnProperty(t.field))return;e.inArray(i[t.field],t.values)!==-1&&this.options.data.splice(r,1)}if(n===this.options.data.length)return;this.initSearch(),this.initPagination(),this.initBody(!0)},u.prototype.update=function(t){var n=this.data.length,r,i;if(!t.hasOwnProperty("field")||!t.hasOwnProperty("data"))return;for(r=n-1;r>=0;r--){i=this.data[r];if(!i.hasOwnProperty(t.field))return;if(i[t.field]===t.data[t.field]){e.extend(this.data[r],t.data);break}}this.initBody(!0)},u.prototype.insertRow=function(e){if(!e.hasOwnProperty("index")||!e.hasOwnProperty("row"))return;this.data.splice(e.index,0,e.row),this.initBody(!0)},u.prototype.updateRow=function(t){if(!t.hasOwnProperty("index")||!t.hasOwnProperty("row"))return;e.extend(this.data[t.index],t.row),this.initBody(!0)},u.prototype.mergeCells=function(t){var n=t.index,r=e.inArray(t.field,this.header.fields),i=t.rowspan||1,s=t.colspan||1,o,u,a=this.$body.find("tr"),f=a.eq(n).find("td").eq(r);if(n<0||r<0||n>=this.data.length)return;for(o=n;o<n+i;o++)for(u=r;u<r+s;u++)a.eq(o).find("td").eq(u).hide();f.attr("rowspan",i).attr("colspan",s).show()},u.prototype.getOptions=function(){return this.options},u.prototype.getSelections=function(){var t=this;return e.grep(this.data,function(e){return e[t.header.stateField]})},u.prototype.checkAll=function(){this.checkAll_(!0)},u.prototype.uncheckAll=function(){this.checkAll_(!1)},u.prototype.checkAll_=function(e){this.$selectItem.filter(":enabled").prop("checked",e),this.updateRows(e),this.updateSelected(),this.trigger(e?"check-all":"uncheck-all")},u.prototype.check=function(e){this.check_(!0,e)},u.prototype.uncheck=function(e){this.check_(!1,e)},u.prototype.check_=function(e,n){this.$selectItem.filter(t('[data-index="%s"]',n)).prop("checked",e),this.data[n][this.header.stateField]=e,this.updateSelected()},u.prototype.destroy=function(){this.$el.insertBefore(this.$container),e(this.options.toolbar).insertBefore(this.$el),this.$container.next().remove(),this.$container.remove(),this.$el.html(this.$el_.html()).css("margin-top","0").attr("class",this.$el_.attr("class")||"")},u.prototype.showLoading=function(){this.$loading.show()},u.prototype.hideLoading=function(){this.$loading.hide()},u.prototype.togglePagination=function(){this.options.pagination=!this.options.pagination;var e=this.$toolbar.find('button[name="paginationSwitch"] i');this.options.pagination?e.attr("class",this.options.iconsPrefix+" "+this.options.icons.paginationSwitchDown):e.attr("class",this.options.iconsPrefix+" "+this.options.icons.paginationSwitchUp),this.updatePagination()},u.prototype.refresh=function(e){e&&e.url&&(this.options.url=e.url,this.options.pageNumber=1),this.initServer(e&&e.silent,e&&e.query)},u.prototype.showColumn=function(e){this.toggleColumn(r(this.options.columns,e),!0,!0)},u.prototype.hideColumn=function(e){this.toggleColumn(r(this.options.columns,e),!1,!0)},u.prototype.filterBy=function(t){this.filterColumns=e.isEmptyObject(t)?{}:t,this.options.pageNumber=1,this.initSearch(),this.updatePagination()},u.prototype.scrollTo=function(e){var t=this.$container.find(".fixed-table-body");typeof e=="string"&&(e=e==="bottom"?t[0].scrollHeight:0),typeof e=="number"&&t.scrollTop(e)},u.prototype.selectPage=function(e){e>0&&e<=this.options.totalPages&&(this.options.pageNumber=e,this.updatePagination())},u.prototype.prevPage=function(){this.options.pageNumber>1&&(this.options.pageNumber--,this.updatePagination())},u.prototype.nextPage=function(){this.options.pageNumber<this.options.totalPages&&(this.options.pageNumber++,this.updatePagination())},u.prototype.toggleView=function(){this.options.cardView=!this.options.cardView,this.initHeader(),this.initBody()};var a=["getOptions","getSelections","getData","load","append","prepend","remove","insertRow","updateRow","mergeCells","checkAll","uncheckAll","check","uncheck","refresh","resetView","destroy","showLoading","hideLoading","showColumn","hideColumn","filterBy","scrollTo","selectPage","prevPage","nextPage","togglePagination","toggleView","update"];e.fn.bootstrapTable=function(t,n){var r;return this.each(function(){var i=e(this),s=i.data("bootstrap.table"),o=e.extend({},u.DEFAULTS,i.data(),typeof t=="object"&&t);if(typeof t=="string"){if(e.inArray(t,a)<0)throw"Unknown method: "+t;if(!s)return;r=s[t](n),t==="destroy"&&i.removeData("bootstrap.table")}s||i.data("bootstrap.table",s=new u(this,o))}),typeof r=="undefined"?this:r},e.fn.bootstrapTable.Constructor=u,e.fn.bootstrapTable.defaults=u.DEFAULTS,e.fn.bootstrapTable.columnDefaults=u.COLUMN_DEFAULTS,e.fn.bootstrapTable.locales=u.LOCALES,e.fn.bootstrapTable.methods=a,e(function(){e('[data-toggle="table"]').bootstrapTable()})}(jQuery),!function(e){"use strict";e.extend(e.fn.bootstrapTable.defaults,{editable:!0,onEditableInit:function(){return!1}}),e.extend(e.fn.bootstrapTable.Constructor.EVENTS,{"editable-init.bs.table":"onEditableInit"});var t=e.fn.bootstrapTable.Constructor,n=t.prototype.initTable,r=t.prototype.initBody;t.prototype.initTable=function(){var t=this;n.apply(this,Array.prototype.slice.apply(arguments));if(!this.options.editable)return;e.each(this.options.columns,function(e,n){if(!n.editable)return;var r=n.formatter;n.formatter=function(e,i,s){var o=r?r(e,i,s):e;return['<a href="javascript:void(0)"',' data-name="'+n.field+'"',' data-pk="'+i[t.options.idField]+'"',">"+o+"</a>"].join("")}})},t.prototype.initBody=function(){var t=this;r.apply(this,Array.prototype.slice.apply(arguments));if(!this.options.editable)return;e.each(this.options.columns,function(n,r){if(!r.editable)return;var i=t.getData();t.$body.find('a[data-name="'+r.field+'"]').each(function(){if(typeof r.editable=="function"){var t=i[e(this).parents("tr[data-index]").data("index")];e(this).editable(r.editable(t,r.field))}else e(this).editable(r.editable)}).off("save").on("save",function(n,s){var o=i[e(this).parents("tr[data-index]").data("index")];t.options.dataSetter?t.options.dataSetter(o,r.field,s.newValue):o[r.field]=s.newValue})}),this.trigger("editable-init")}}(jQuery),function(e){var n={type:null,showLangSelect:!0,selectize:!1,create:!0},r=function(e,t,n,r,i,s){var o=parseInt(e,10);return isNaN(o)?!1:!t&&o==0?!1:!n&&o<0?!1:!r&&o>0?!1:i!=undefined&&o>i?!1:s!=undefined&&o<s?!1:!0},i=function(t){return e.isNumeric(t)},s={"http://www.w3.org/2000/01/rdf-schema#Literal":{label:"Plain Literal"},"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource":{label:"Reference"},"http://www.w3.org/2001/XMLSchema#integer":{label:"Integer",verify:function(e){return r(e,!0,!0,!0)}},"http://www.w3.org/2001/XMLSchema#decimal":{label:"Decimal",verify:i},"http://www.w3.org/2001/XMLSchema#double":{label:"Double",verify:i},"http://www.w3.org/2001/XMLSchema#float":{label:"Float",verify:i},"http://www.w3.org/2001/XMLSchema#nonPositiveInteger":{label:"Non-Positive Integer",verify:function(e){return r(e,!0,!0,!1)}},"http://www.w3.org/2001/XMLSchema#negativeInteger":{label:"Negative Integer",verify:function(e){return r(e,!1,!0,!1)}},"http://www.w3.org/2001/XMLSchema#long":{label:"Long",verify:function(e){return r(e,!0,!0,!0)}},"http://www.w3.org/2001/XMLSchema#int":{label:"Int",verify:function(e){return r(e,!0,!0,!0,2147483647,-2147483648)}},"http://www.w3.org/2001/XMLSchema#short":{label:"Short",verify:function(e){return r(e,!0,!0,!0,32767,-32768)}},"http://www.w3.org/2001/XMLSchema#byte":{label:"Byte",verify:function(e){return r(e,!0,!0,!0,127,-128)}},"http://www.w3.org/2001/XMLSchema#nonNegativeInteger":{label:"Non-Negative Integer",verify:function(e){return r(e,!0,!1,!0)}},"http://www.w3.org/2001/XMLSchema#unsignedLong":{label:"Unsigned Long",verify:function(e){return r(e,!0,!1,!0)}},"http://www.w3.org/2001/XMLSchema#unsignedInt":{label:"Unsigned Int",verify:function(e){return r(e,!0,!1,!0,4294967295)}},"http://www.w3.org/2001/XMLSchema#unsignedShort":{label:"Unsigned Short",verify:function(e){return r(e,!0,!1,!0,65535)}},"http://www.w3.org/2001/XMLSchema#unsignedByte":{label:"Unsigned Byte",verify:function(e){return r(e,!0,!0,!0,255)}},"http://www.w3.org/2001/XMLSchema#positiveInteger":{label:"Positive Integer",verify:function(e){return r(e,!1,!1,!0)}},"http://www.w3.org/2001/XMLSchema#boolean":{label:"Boolean",setup:function(e,t){t?(e.bootstrapToggle&&e.bootstrapToggle("destroy"),e.attr("type","text")):(e.bootstrapToggle&&e.bootstrapToggle({on:"True",off:"False"}),e.attr("type","checkbox"))},getValue:function(e){return e.is(":checked")?"true":"false"},setValue:function(e,t){parseInt(t)==1||typeof t=="string"&&t.toLowerCase()=="true"?e.attr("checked","checked"):e.removeAttr("checked")}},"http://www.w3.org/2001/XMLSchema#string":{label:"String"},"http://www.w3.org/2001/XMLSchema#hexBinary":{label:"Hex Binary"},"http://www.w3.org/2001/XMLSchema#dateTime":{label:"Datetime",setup:function(e,t){t?e.datetimepicker("remove"):e.datetimepicker({format:"yyyy-mm-ddThh:ii:ssZ",weekStart:1})}},"http://www.w3.org/2001/XMLSchema#date":{label:"Date",setup:function(e,t){t?e.datetimepicker("remove"):e.datetimepicker({format:"yyyy-mm-dd",weekStart:1})}}},o=function(r,i){var o=this;o.mainElem=r,o.options=e.extend({},n,i),o.currentType=o.options.type||"http://www.w3.org/2000/01/rdf-schema#Literal",o.mainElem.on("input",function(){o.verifyInput(),o.change()}),o.container=e(document.createElement("div")).addClass("rdfNodeEditor"),o.inputContainer=e(document.createElement("div")).addClass("rdfNodeInputContainer");var u=e(r).addClass("form-control");u.after(o.container),o.inputContainer.append(u),o.container.append(o.inputContainer);if(o.options.choices){o.resSelect=e(document.createElement("select")),o.inputContainer.append(o.resSelect),o.mainElem.hide();var a=function(e){var t=[];for(var n=0;n<e.length;n++){var r=RDFE.RdfNode.fromStoreNode(e[n]);r.label=e[n].label||r.value,t.push(r)}o.resSelect.selectize({valueField:"value",searchField:"label",sortField:"label",options:t,create:o.options.create?function(e,t){var n=new RDFE.RdfNode("uri",e);n.label=e,this.options[e]=n,t(n)}:!1,createOnBlur:!0,onChange:function(e){o.mainElem.val(e),o.change()},render:{item:function(e,t){return"<div>"+t(e.label||e.value)+"</div>"},option:function(e,t){return e.label?"<div>"+t(e.label)+" <small>("+t(e.value)+")</small></div>":"<div>"+t(e.value)+"</div>"}}})};typeof o.options.choices=="object"?a(o.options.choices):typeof o.options.choices=="function"&&o.options.choices(function(e){a(e)})}o.langElem=e(document.createElement("input")).addClass("form-control").attr("placeholder","Language"),o.langContainer=e(document.createElement("div")).addClass("rdfNodeLangContainer"),o.langContainer.append(o.langElem),o.container.append(o.langContainer),o.currentType!="http://www.w3.org/2000/01/rdf-schema#Literal"&&o.langContainer.hide(),o.langElem.on("input",function(){o.lang=o.langElem.val(),o.verifyInput(),o.change()}),o.options.showLangSelect||o.langContainer.hide(),o.typeContainer=e(document.createElement("div")).addClass("rdfNodeTypeContainer"),o.typeElem=e(document.createElement("select")).addClass("form-control");for(t in s)o.typeElem.append(e(document.createElement("option")).attr("value",t).text(s[t].label));o.typeContainer.append(o.typeElem),o.container.append(o.typeContainer);var f=function(){o.lastType=o.currentType,o.currentType=o.options.selectize?o.typeElem[0].selectize.getValue():o.typeElem.val(),o.verifyFct=s[o.currentType].verify,o.updateEditor(),o.verifyInput(),o.change()};o.options.selectize?(o.typeElem.selectize({onChange:f}),o.typeElem[0].selectize.setValue(this.currentType)):o.typeElem.change(f),o.options.type&&(o.typeElem.val(o.options.type),o.typeContainer.hide()),o.updateEditor(!0)};o.prototype.change=function(){e(this).trigger("change",this)};var u=function(){var t=["http://www.w3.org/2000/01/rdf-schema#Literal","http://www.w3.org/2001/XMLSchema#string"];return function(n,r){return n===r||e.inArray(n,t)>=0&&e.inArray(r,t)>=0}}();o.prototype.updateEditor=function(e){u(this.options.type,this.currentType)?this.typeContainer.hide():this.typeContainer.css("display","table-cell"),!this.options.showLangSelect||this.currentType!="http://www.w3.org/2000/01/rdf-schema#Literal"?this.langContainer.hide():this.langContainer.css("display","table-cell");if(e||this.lastType!=this.currentType)this.lastType&&s[this.lastType].setup&&s[this.lastType].setup(this.mainElem,!0),s[this.currentType].setup&&s[this.currentType].setup(this.mainElem)},o.prototype.getValue=function(){return this.currentType=="http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"?new RDFE.RdfNode("uri",this.mainElem.val()):new RDFE.RdfNode("literal",s[this.currentType].getValue?s[this.currentType].getValue(this.mainElem):this.mainElem.val(),this.currentType!="http://www.w3.org/2000/01/rdf-schema#Literal"?this.currentType:undefined,this.lang?this.lang:undefined)},o.prototype.setValue=function(e){if(e){var t=RDFE.RdfNode.fromStoreNode(e);this.lastType=this.currentType;var n=t.type;n==="uri"?this.currentType="http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource":(this.currentType=t.datatype||"http://www.w3.org/2000/01/rdf-schema#Literal",this.options.type==="http://www.w3.org/2001/XMLSchema#boolean"&&(t.value==="0"||t.value==="1")&&(this.currentType="http://www.w3.org/2001/XMLSchema#boolean")),this.lang=t.language,t.value.indexOf("\n")!==-1&&this.transformToTextarea(),this.mainElem.val(t.value),this.resSelect&&(this.resSelect[0].selectize.addOption(t),this.resSelect[0].selectize.setValue(t.value)),s[this.currentType]&&s[this.currentType].setValue&&s[this.currentType].setValue(this.mainElem,this.mainElem.val()),this.langElem.val(this.lang),this.typeElem.val(this.currentType),this.options.selectize&&this.typeElem[0].selectize.setValue(this.currentType),this.updateEditor()}},o.prototype.isValid=function(e){return this.verifyFct?this.verifyFct(this.mainElem.val()):!0},o.prototype.verifyInput=function(){var t=this,n=e(this.mainElem).val(),r=!0;n.length>0&&(r=this.verifyFct?this.verifyFct(n):!0),r?t.mainElem.removeClass("has-error"):t.mainElem.addClass("has-error")},o.prototype.isLiteralType=function(e){return s.hasOwnProperty(e)&&e!="http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"},o.prototype.setEditFocus=function(){this.mainElem.focus()},o.prototype.blur=function(){this.mainElem.blur()},o.prototype.getElement=function(){return this.container},o.prototype.transformToTextarea=function(){var t=this;if(t.mainElem.prop("tagName")==="INPUT"&&t.mainElem.prop("type")==="text"){var n=t.mainElem.val();textArea=document.createElement("textarea"),textArea.id=t.mainElem.prop("id"),textArea.name=t.mainElem.prop("name"),e(textArea).addClass(t.mainElem.prop("class")),textArea.value=n,t.mainElem.replaceWith(textArea),t.mainElem=e(textArea)}},e.fn.rdfNodeEditor=function(e){var t=this.data("rdfNodeEditor");return t||(t=new o(this,e),this.data("rdfNodeEditor",t)),t}}(jQuery),function(e){"use strict";var t=function(e){this.init("rdfnode",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.filter("input"),this.setClass(),this.$input.rdfNodeEditor(this.options.rdfnode)},activate:function(){this.$input.rdfNodeEditor().setEditFocus()},value2html:function(t,n){if(!t){e(n).empty();return}e(n).text(t.toString())},html2value:function(e){return null},input2value:function(){return this.$input.rdfNodeEditor().getValue()},value2input:function(e){this.$input.rdfNodeEditor().setValue(e)}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{rdfnode:{},tpl:'<input type="text">'}),e.fn.editabletypes.rdfnode=t}(window.jQuery),function(e){var t=function(t,n){var r=this;r.options=e.extend({},n),r.options.ontoManager=r.options.ontoManager||new RDFE.OntologyManager,r.mainElem=t,e(ontologyManager).on("changed",function(e,t){r.sel.addOption(t.allOntologies())}),e(r.mainElem).selectize({valueField:"URI",searchField:["title","label","prefix","URI"],sortField:["prefix","URI"],options:r.options.ontoManager.ontologies,onChange:function(t){e(r).trigger("changed",r.options.ontoManager.ontologyByURI(t))},create:function(e,t){var n=r.options.ontoManager.ontologyDetermine(e);n||(n=r.options.ontoManager.prefixes[e]||e),r.options.ontoManager.ontologyParse(n,{success:function(e){t(e)},error:function(){t(null)}})},render:{item:function(e,t){return"<div>"+t(e.title||e.label||e.prefix||e.URI)+"</div>"},option:function(e,t){return"<div>"+t(e.title||e.label||e.prefix||e.URI)+"<br/><small>("+t(e.URI)+")</small></div>"},option_create:function(e,t){var n=r.options.ontoManager.prefixes[e.input]||e.input;return n!=e.input?'<div class="create">Load <strong>'+t(e.input)+"</strong> <small>("+t(n)+")</small>&hellip;</div>":'<div class="create">Load <strong>'+t(n)+"</strong>&hellip;</div>"}}}),r.sel=e(r.mainElem)[0].selectize};t.prototype.selectedOntologyURI=function(){return this.sel.getValue()},t.prototype.selectedOntology=function(){return this.sel.options[this.selectedOntologyURI()]},t.prototype.on=function(t,n){e(this).on(t,n)},e.fn.ontoBox=function(e){var n=this.data("ontoBox");return n||(n=new t(this,e),this.data("ontoBox",n)),n}}(jQuery),function(e){var t=function(n,r){var i=this;i.options=e.extend({},t.defaults,r),i.options.ontoManager=i.options.ontoManager||new RDFE.OntologyManager,i.mainElem=n,e(ontologyManager).on("ontologyLoaded",function(e,t,n){i.updateOptions()}),e(i.mainElem).selectize({valueField:"URI",searchField:["title","label","prefix","URI"],sortField:["prefix","URI"],options:i.propertyList(),onChange:function(t){e(i).trigger("changed",i.sel.options[t])},create:function(e,t){t(i.options.ontoManager.ontologyPropertyByURI(i.options.ontoManager.uriDenormalize(e),!0))},render:{item:function(e,t){var n=e.title||e.label||name.curi||e.name;return e.curi&&e.curi!=n?n=t(n)+" <small>("+t(e.curi)+")</small>":n=t(n),"<div>"+n+"</div>"},option:function(e,t){return"<div>"+t(e.title||e.label||name.curi||e.name)+"<br/><small>("+t(e.URI)+")</small></div>"},option_create:function(e,t){var n=i.options.ontoManager.uriDenormalize(e.input);return n!=e.input?'<div class="create">Add <strong>'+t(e.input)+"</strong> <small>("+t(n)+")</small>&hellip;</div>":'<div class="create">Add <strong>'+t(n)+"</strong>&hellip;</div>"}}}),i.sel=e(i.mainElem)[0].selectize};t.defaults={ontoManager:null,ontology:null},t.prototype.setOntology=function(e){console.log("setOntology",e),this.options.ontology=e,this.updateOptions()},t.prototype.propertyList=function(){return console.log("propertyList",this.options),this.options.ontology?this.options.ontology.allProperties():this.options.ontoManager.allProperties()},t.prototype.updateOptions=function(){var e=this.propertyList();this.sel.clearOptions(),this.sel.addOption(e)},t.prototype.setPropertyURI=function(e){console.log("PropertyBox.setPropertyURI",e);if(e){var t=this.options.ontoManager.uriDenormalize(e);this.sel.options[t]||this.sel.addOption(this.options.ontoManager.OntologyProperty(null,t)),this.sel.setValue(t)}else this.sel.setValue(null)},t.prototype.selectedURI=function(){return this.sel.getValue()},t.prototype.selectedProperty=function(){return this.sel.options[this.selectedURI()]},t.prototype.on=function(t,n){return e(this).on(t,n),this},e.fn.propertyBox=function(e){var n=this.data("propertyBox");return n||(n=new t(this,e),this.data("propertyBox",n)),n}}(jQuery),function(e){"use strict";var t=function(e){this.init("rdfnode",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.filter("select"),this.setClass(),this.$input.propertyBox(this.options.propertyBox),this.$input.propertyBox().sel.$control.css("min-width","250px")},activate:function(){},value2html:function(t,n){if(!t){e(n).empty();return}e(n).text(t.toString())},html2value:function(e){return null},input2value:function(){return this.$input.propertyBox().selectedURI()},value2input:function(e){this.$input.propertyBox().setPropertyURI(e)}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{propertyBox:{},tpl:"<select></select>"}),e.fn.editabletypes.propertyBox=t}(window.jQuery),function(e){window.RDFE||(window.RDFE={}),RDFE.TripleView=function(){var t=function(e,t){this.doc=e,this.ontologyManager=t},n=function(e){return e.interfaceName=="Literal"?e.datatype=="http://www.w3.org/2001/XMLSchema#dateTime"?(new Date(e.nominalValue)).toString():e.nominalValue:e.toString()};return t.prototype.render=function(t,r){var i=this,s=function(t,n,r){var s=r;n==="predicate"&&(s=i.doc.store.rdf.createNamedNode(r));if(r.toStoreNode)s=r.toStoreNode(i.doc.store);else if(n!="object"||t.object.interfaceName=="NamedNode")s=i.doc.store.rdf.createNamedNode(r);else if(t.object.datatype=="http://www.w3.org/2001/XMLSchema#dateTime"){var o=new Date(r);s=i.doc.store.rdf.createLiteral(o.toISOString(),t.object.language,t.object.datatype)}else s=i.doc.store.rdf.createLiteral(r,t.object.language,t.object.datatype);var u=i.doc.store.rdf.createTriple(t.subject,t.predicate,t.object);u[n]=s,i.doc.updateTriple(t,u,function(e){},function(t){e(i).trigger("rdf-editor-error",{message:"Failed to update triple in document: "+t})})};i.doc.listProperties(function(o){console.log("Found existing predicates: ",o),i.doc.store.graph(i.doc.graph,function(o,u){if(o){t.empty();var a=e(document.createElement("table")).addClass("table");t.append(a);var f=u.toArray();for(var l=0;l<f.length;l+=1)f[l].id=l;a.data("maxindex",l),a.bootstrapTable({striped:!0,sortName:"s",pagination:!0,search:!0,searchAlign:"left",showHeader:!0,editable:!0,data:f,dataSetter:s,columns:[{field:"subject",title:"Subject",aligh:"left",sortable:!0,editable:function(e){return{mode:"inline",type:"rdfnode",rdfnode:{type:"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"},value:e.subject}},formatter:n},{field:"predicate",title:"Predicate",align:"left",sortable:!0,editable:function(e){return{mode:"inline",type:"propertyBox",propertyBox:{ontoManager:i.ontologyManager},value:e.predicate.nominalValue}},formatter:n},{field:"object",title:"Object",align:"left",sortable:!0,editable:function(e){return{mode:"inline",type:"rdfnode",value:e.object}},formatter:n},{field:"actions",title:"Actions",align:"center",valign:"middle",clickToSelect:!1,editable:!1,formatter:function(e,t,n){return['<a class="remove ml10" href="javascript:void(0)" title="Remove">','<i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .remove":function(t,n,r,s){var o=r;i.doc.deleteTriple(o,function(){a.bootstrapTable("remove",{field:"id",values:[r.id]})},function(){e(i).trigger("rdf-editor-error",{type:"triple-delete-failed",message:"Failed to delete triple."})})}}}]}),i.tripleTable=a,r&&r()}else e(i).trigger("rdf-editor-error","Failed to query triples from doc.")})})},t.prototype.addTriple=function(t){var n=this.tripleTable.data("maxindex");n+=1,this.tripleTable.bootstrapTable("append",e.extend(t,{id:n})),this.tripleTable.data("maxindex",n)},t}()}(jQuery),Backbone.Form.editors.Rdfnode=Backbone.Form.editors.Base.extend({tagName:"input",events:{change:function(){this.trigger("change",this)},focus:function(){this.trigger("focus",this)},blur:function(){this.trigger("blur",this)},keyup:function(e,t){e.keyCode==13&&e.shiftKey&&(console.log("shift+enter"),this.editor&&this.editor.transformToTextarea(),e.stopPropagation()),this.trigger("keyup",this)}},initialize:function(e){Backbone.Form.editors.Base.prototype.initialize.call(this,e)},render:function(){var e=this;return this.$el.attr("type","text"),this.$el.rdfNodeEditor(this.schema.rdfnode),e.editor=this.$el.rdfNodeEditor(),e.setElement(e.editor.getElement()),$(this.editor).on("change",function(){e.trigger("change",this)}),this.setValue(this.value),this},getValue:function(){return this.editor.getValue()},setValue:function(e){this.editor.setValue(e)},focus:function(){if(this.hasFocus)return;this.editor.setEditFocus()},blur:function(){if(!this.hasFocus)return;this.editor.blur()}}),Backbone.Form.editors.NestedRdf=Backbone.Form.editors.Object.extend({initialize:function(e){Backbone.Form.editors.Base.prototype.initialize.call(this,e);if(!this.form)throw new Error('Missing required option "form"');if(!e.schema.model)throw new Error('Missing required "schema.model" option for NestedRdf editor')},render:function(){var e=this.form.constructor,t=this.value,n=this.key,r=this.schema.model,i=t?t:new r;return this.nestedForm=new e({model:i,idPrefix:this.id+"_",fieldTemplate:"nestedField"}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){return{uri:this.nestedForm.model.uri,values:this.nestedForm.getValue()}}}),window.RDFE||(window.RDFE={}),RDFE.EntityModel=Backbone.Model.extend({setEntity:function(e,t){this.doc=e,this.uri=t,this.individualsCache={}},addValue:function(e,t){var n=this.get(e)||[];n.push(t),this.set(e,n)},getIndividuals:function(e,t){var n=this;if(this.individualsCache[e]){t(this.individualsCache[e]);return}var r=[],i=this.doc.ontologyManager.ontologyClassByURI(e);!e||e==="http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"?r=this.doc.ontologyManager.individuals:e==="http://www.w3.org/2000/01/rdf-schema#Class"?r=this.doc.ontologyManager.ontologyClasses:e==="http://www.w3.org/1999/02/22-rdf-syntax-ns#Property"?r=this.doc.ontologyManager.ontologyProperties:i&&(r=i.getIndividuals(!0)),r=_.map(_.values(r),function(e){var t=new RDFE.RdfNode("uri",e.URI);return t.label=e.label||e.name,t}),n.doc.listEntities(e,function(e){$.merge(r,e)});if(i){var s=i.getSubClasses(!0);for(var o=0,u=s.length;o<u;o++)n.doc.listEntities(s[o].URI,function(e){$.merge(r,e)})}this.individualsCache[e]=r,t(r)},maxCardinalityForProperty:function(e){for(var t=0;t<this.types.length;t++){var n=this.types[t].maxCardinalityForProperty(e);if(n)return n}return null},restrictionsForProperty:function(e){for(var t=0;t<this.types.length;t++){var n=this.types[t].restrictions[e];if(n)return n}return null},isAggregateProperty:function(e){for(var t=0;t<this.types.length;t++)if(this.types[t].isAggregateProperty(e))return!0;return!1},addSchemaEntryForProperty:function(e){var t=this,n=e.URI?e:t.doc.ontologyManager.ontologyProperties[e]||{URI:e},r=this.restrictionsForProperty(e),i,s;r&&(i=r.hasCustomLabel,s=r.hasCustomComment);var o=RDFE.Utils.createTitle(i||n.label||n.title||RDFE.Utils.uri2name(n.URI)),u={titleHTML:'<span title="{0}">{1}</span>'.format(RDFE.Utils.escapeXml(n.URI),o),title:o,maxCardinality:t.maxCardinalityForProperty(n.URI),editorAttrs:{title:RDFE.coalesce(s,n.comment,n.description)},validators:[function(e,t){}]};if(t.isAggregateProperty(n.URI)){var a=n.getRange?t.doc.ontologyManager.ontologyClassByURI(n.getRange()):null;a?(u.type="List",u.itemType="NestedRdf",u.model=RDFE.EntityModel.extend({defaults:{"http://www.w3.org/1999/02/22-rdf-syntax-ns#type":[n.getRange()]},initialize:function(e){RDFE.EntityModel.prototype.initialize.call(this,e),this.doc=t.doc,this.buildSchemaFromTypes([a])},individualsCache:t.individualsCache}),u.editorAttrs.style="height:auto;"):(console.log("Caution: invalid range on aggregate: ",n),u.type="List",u.itemType="Rdfnode",u.rdfnode={type:"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",create:!0})}else{u.type="List",u.itemType="Rdfnode",u.rdfnode={};var f=_.result(n,"getRange");n.class==t.doc.ontologyManager.uriDenormalize("owl:DatatypeProperty")?u.rdfnode.type=f:n.class==t.doc.ontologyManager.uriDenormalize("owl:ObjectProperty")?(u.rdfnode.type="http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",u.rdfnode.choices=function(e){t.getIndividuals(f,e)},u.rdfnode.create=!0):f&&(f=="http://www.w3.org/2000/01/rdf-schema#Literal"||f.startsWith("http://www.w3.org/2001/XMLSchema#")?u.rdfnode.type=f:(u.rdfnode.type="http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",u.rdfnode.choices=function(e){t.getIndividuals(f,e)},u.rdfnode.create=!0))}t.schema[n.URI]=u},buildSchemaFromTypes:function(e){var t=this;t.schema={},t.fields=[],t.lens=null,t.types=e;for(var n=0,r=e.length;n<r;n++){var i=e[n].getFresnelLens();if(i&&i.showProperties.length){t.lens=i;break}}i?t.fields=_.without(i.showProperties,t.doc.ontologyManager.uriDenormalize("fresnel:allProperties")):t.fields=[t.doc.ontologyManager.uriDenormalize("rdf:type")];for(var n=0;n<t.fields.length;n++)t.addSchemaEntryForProperty(t.fields[n])},docToModel:function(e,t){var n=this;n.schema={},n.fields=[],n.ontologyManager=ontologyManager,this.doc.getEntity(n.uri,function(t){n.types=_.compact(_.map(t.types,n.doc.ontologyManager.ontologyClassByURI,n.doc.ontologyManager)),n.fields=[],n.lens=null;var r=[];if(n.types.length===0)for(var i in t.properties){var s=n.doc.ontologyManager.ontologyPropertyByURI(i);s&&s.domain&&(n.types=_.union(n.types,s.domain))}for(var o=0,u=n.types.length;o<u;o++){var a=n.types[o].getFresnelLens();if(a&&a.showProperties.length>0){n.lens=a;break}}a&&(n.fields=_.clone(a.showProperties));if(!a){n.allowAddProperty=!0;for(var i in t.properties)_.contains(n.fields,i)||(i==="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"?n.fields.unshift(i):n.fields.push(i))}else{var f=n.fields.indexOf(n.ontologyManager.uriDenormalize("fresnel:allProperties"));if(f>=0){n.allowAddProperty=!0;var l=[];for(i in t.properties)!_.contains(n.fields,i)&&!_.contains(a.hideProperties,i)&&l.push(i);n.fields.splice.apply(n.fields,[f,1].concat(l))}}for(var o=0;o<n.fields.length;o++)n.addSchemaEntryForProperty(n.fields[o]);for(var i in t.properties){var c=n.isAggregateProperty(i),h=t.properties[i];for(var o=0;o<h.length;o++)if(c){var p=new RDFE.EntityModel;p.setEntity(n.doc,h[o].value),p.individualsCache=n.individualsCache,p.docToModel(function(){n.addValue(i,p)})}else n.addValue(i,h[o])}e&&e()})},modelToDoc:function(){function t(n,r,i){var s=[];if(!n||n.length===0){var o="";for(var u=0,a=i.config.options.labelProps.length;u<a;u++)if(r[i.config.options.labelProps[u]]){o=r[i.config.options.labelProps[u]];break}o=(o||"subres")+"_"+e,n=i.buildEntityUri(o),e++}var f=i.store.rdf.createNamedNode(n);for(prop in r){var l=i.store.rdf.createNamedNode(prop),c=r[prop];c.constructor!==Array&&(c=[c]);for(var h=0;h<c.length;h++){var p=c[h];if(p.values){var d=t(p.uri,p.values,i);d.length>0&&(s.push(i.store.rdf.createTriple(f,l,d[0].subject)),Array.prototype.push.apply(s,d))}else{var v=c[h].toStoreNode(i.store);v&&v.nominalValue.length>0&&s.push(i.store.rdf.createTriple(f,l,v))}}}return s}var e=1;return function(n,r){var i=this;e=1;var s=t(this.uri,i.attributes,i.doc),o=[];for(var u=0;u<s.length;u++)_.indexOf(o,s[u].subject.nominalValue)<0&&o.push(s[u].subject.nominalValue);var a=function(e){e>=o.length?i.doc.addTriples(s,n,r):i.doc.deleteBySubject(o[e],function(){a(e+1)},r)};a(0)}}()}),function(e){window.RDFE||(window.RDFE={}),RDFE.EntityEditor=function(){var t=function(e,t){this.doc=e,this.ontologyManager=t},n=Backbone.Form.extend({template:_.template('        <form class="form-horizontal clearfix" role="form">          <a href="#" class="btn btn-default btn-xs pull-right addProp">Add Property</a>          <div data-fieldsets></div>          <% if (submitButton) { %>            <button type="submit" class="btn"><%= submitButton %></button>          <% } %>        </form>      '),render:function(){var t=this;return Backbone.Form.prototype.render.call(this),t.model.allowAddProperty||this.$el.find(".addProp").hide(),this.$el.find("> a.addProp").click(function(n){n.preventDefault();var r=e(document.createElement("select")),i=e(document.createElement("button")).addClass("btn").addClass("btn-default").text("Add"),s=e(document.createElement("button")).addClass("btn").addClass("btn-default").text("Cancel"),o=e(document.createElement("div")).append(e(document.createElement("span")).text("New Property:")).append(r).append(i).append(s);r=r.propertyBox({ontoManager:t.model.doc.ontologyManager}),s.click(function(e){e.preventDefault(),o.remove()}),i.click(function(e){e.preventDefault();if(r.selectedURI()){console.log("Adding new property",r.selectedURI(),"to form",t),t.commit(),t.model.addSchemaEntryForProperty(r.selectedProperty()),t.model.fields.push(r.selectedURI()),t.fieldsets=undefined,t.initialize(t.options),o.remove();var n=t.$el.parent();t.$el.remove(),t.render(),console.log(n,t.$el),n.append(t.$el)}else console.log("No prop selected")}),t.$el.prepend(o)}),this}});return t.prototype.template=_.template('<div class="panel panel-default">        <div class="panel-heading clearfix">          <h3 class="panel-title pull-left">Editing <a href="<%= entityUri %>"><span class="entity-label"><%= entityLabel %><span></a> <span class="entity-types"></span></h3>          <div class="btn-group pull-right" role="group">            <button type="button" class="btn btn-primary btn-sm" id="okBtn">Apply</button>            <button type="button" class="btn btn-default btn-sm" id="cnclBtn">Cancel</button>          </div>        </div>        <div class="panel-body" id="entityFormContainer">        </div>      </div>'),t.prototype.render=function(t,r,i){var s=this,o=new RDFE.EntityModel;o.setEntity(this.doc,r),o.docToModel(function(){var u=new n({model:o});u.render(),t.empty(),t.append(s.template({entityUri:r,entityLabel:RDFE.Utils.uri2name(r)})),s.doc.getEntity(r,function(e){t.find(".entity-types").html(s.ontologyManager.typesToLabel(e.types,!0)),t.find(".entity-label").html(e.label)}),t.find("#entityFormContainer").append(u.el),t.find(".toggle.btn").css("width","100%");var a=t.find("button#cnclBtn"),f=t.find("button#saveBtn"),l=t.find("button#okBtn");a.click(function(){i()});var c=function(t){u.commit(),o.modelToDoc(function(){e(s).trigger("rdf-editor-success",{type:"editor-form-save-done",message:"Locally saved details of "+r}),t&&t()},function(t){e(s).trigger("rdf-editor-error",{type:"editor-form-save-failed",message:t})})};f.click(function(){c()}),l.click(function(){c(i)})},function(t){e(s).trigger("rdf-editor-error",{type:"editor-form-creation-failed",message:t})})},t}()}(jQuery),function(e){window.RDFE||(window.RDFE={}),RDFE.EntityView=function(){var t=function(e,t,n){this.doc=e,this.ontologyManager=t,this.editFct=n.editFct},n=function(e,t,n){return t.types&&t.types.length?t.label+" <small>("+t.types+")</small>":t.label},r=function(e,t,n){return['<a class="edit ml10" href="javascript:void(0)" title="Edit">','  <i class="glyphicon glyphicon-edit"></i>',"</a>",'<a class="remove ml10" href="javascript:void(0)" title="Remove">','  <i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},i=function(e,t){return{label:e.label,types:t.typesToLabel(e.types),uri:e.uri||e.value}};return t.prototype.render=function(t,s){var o=this;o.doc.listEntities(function(u){o.entityTable=null,t.empty();var a=e(document.createElement("table")).addClass("table");t.append(a);var f=[];for(var l=0;l<u.length;l++)f.push(i(u[l],o.ontologyManager));var c=function(t){o.doc.deleteEntity(t,function(){a.bootstrapTable("remove",{field:"uri",values:[t]}),e(o).trigger("rdf-editor-success",{type:"entity-delete-done",uri:t,message:"Successfully deleted entity "+t+"."})},function(t){e(o).trigger("rdf-editor-error",{type:"entity-delete-failed",message:t})})};a.bootstrapTable({striped:!0,sortName:"label",pagination:!0,search:!0,searchAlign:"left",trimOnSearch:!1,showHeader:!0,data:f,idField:"uri",columns:[{field:"label",title:"Entity Name",aligh:"left",sortable:!0,formatter:n},{field:"actions",title:"Actions",align:"center",valign:"middle",clickToSelect:!1,formatter:r,events:{"click .edit":function(e,t,n,r){o.editFct(n.uri)},"click .remove":function(e,t,n,r){c(n.uri)}}}]}),o.entityTable=a,s&&s()},function(t){e(o).trigger("rdf-editor-error",{type:"entity-list-failed",message:t})})},t.prototype.addEntity=function(e){this.entityTable.bootstrapTable("append",e)},t.prototype.updateEntity=function(e){var t=this;t.doc.getEntity(e,function(e){t.entityTable.bootstrapTable("update",{field:"uri",data:i(e,t.ontologyManager)})})},t}()}(jQuery),typeof String.prototype.startsWith!="function"&&(String.prototype.startsWith=function(e){return this.indexOf(e)==0}),window.RDFE||(window.RDFE={}),RDFE.Editor=function(e,t){var n=this,t=$.extend({initOntologyManager:!0},t);this.ontologyManager=new RDFE.OntologyManager(e.options),t.initOntologyManager===!0&&this.ontologyManager.init(),this.doc=new RDFE.Document(this.ontologyManager,e),this.config=e},RDFE.Editor.prototype.render=function(e){this.container=e,this.container.empty(),this.listContainer=$(document.createElement("div")).appendTo(this.container),this.formContainer=$(document.createElement("div")).appendTo(this.container),this.toggleView(this.config.options.defaultView)},RDFE.Editor.prototype.currentView=function(){return this._currentView},RDFE.Editor.prototype.toggleView=function(e){e!==this._currentView&&(e==="triples"?(this.createTripleList(),this._currentView="triples"):(this.createEntityList(),this._currentView="entities"))},RDFE.Editor.prototype.updateView=function(){this._currentView==="triples"?this.createTripleList():this._currentView==="entities"&&this.createEntityList()},RDFE.Editor.prototype.createTripleList=function(){var e=this;$(e).trigger("rdf-editor-start",{id:"render-triple-list",message:"Loading Triples..."}),this.tripleView||(this.tripleView=new RDFE.TripleView(this.doc,this.ontologyManager),$(e.tripleView).on("rdf-editor-error",function(t,n){$(e).trigger("rdf-editor-error",n)}).on("rdf-editor-success",function(t,n){$(e).trigger("rdf-editor-success",n)})),this.formContainer.hide(),this.listContainer.empty().show(),this.tripleView.render(e.listContainer,function(){$(e).trigger("rdf-editor-done",{id:"render-triple-list"})})},RDFE.Editor.prototype.createNewStatementEditor=function(){var e=this;if(!this.doc)return!1;e.listContainer.hide(),e.formContainer.html('       <div class="panel panel-default">       <div class="panel-heading"><h3 class="panel-title">Add new Triple</h3></div>       <div class="panel-body"><div class="form-horizontal">       <div class="form-group"><label for="subject" class="col-sm-2 control-label">Subject</label>       <div class="col-sm-10"><input name="subject" class="form-control" /></div></div>       <div class="form-group"><label for="predicate" class="col-sm-2 control-label">Predicate</label>       <div class="col-sm-10"><select name="predicate" class="form-control"></select></div></div>       <div class="form-group"><label for="object" class="col-sm-2 control-label">Object</label>       <div class="col-sm-10"><input name="object" class="form-control" /></div></div>       <div class="form-group"><div class="col-sm-10 col-sm-offset-2"><a href="#" class="btn btn-default triple-action triple-action-new-cancel">Cancel</a>         <a href="#" class="btn btn-primary triple-action triple-action-new-save">OK</a></div></div>       </form></div></div>\n').show();var t=e.formContainer.find('input[name="object"]').rdfNodeEditor(),n=e.formContainer.find('select[name="predicate"]').propertyBox({ontoManager:e.ontologyManager}).on("changed",function(n,r){console.log("changed",r);var i=t.getValue(),s,o=r.getRange();t.isLiteralType(o)?s=new RDFE.RdfNode("literal",i.value,o,i.language):e.ontologyManager.ontologyClassByURI(o)?s=new RDFE.RdfNode("uri",i.value):s=new RDFE.RdfNode("literal",i.value,null,""),t.setValue(s)});e.formContainer.find("a.triple-action-new-cancel").click(function(t){e.createTripleList()}),e.formContainer.find("a.triple-action-new-save").click(function(r){var i=e.formContainer.find('input[name="subject"]').val(),s=n.selectedURI(),o=t.getValue(),u=e.doc.store.rdf.createTriple(e.doc.store.rdf.createNamedNode(i),e.doc.store.rdf.createNamedNode(s),o.toStoreNode(e.doc.store));e.doc.addTriples([u],function(){e.tripleView&&e.tripleView.addTriple(u),$(e).trigger("rdf-editor-success",{type:"triple-insert-success",message:"Successfully added new triple."}),e.createTripleList()},function(){$(e).trigger("rdf-editor-error",{type:"triple-insert-failed",message:"Failed to add new triple to store."})})})},RDFE.Editor.prototype.createNewEntityEditor=function(e){var t=this,n,r,i,s,o=function(e){var n=t.ontologyManager.ontologyByURI(e.currentTarget.selectedOntologyURI());s.clearOptions(),s.addOption(n?n.classesAsArray():t.ontologyManager.allClasses())};if(!this.doc)return!1;this.listContainer.hide(),this.formContainer.show();if(!e)t.formContainer.html('<div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">Add new Entity</h3></div><div class="panel-body"><div class="form-horizontal">   <div class="form-group">     <label for="ontology" class="col-sm-2 control-label">Ontology</label>     <div class="col-sm-10">       <select name="ontology" id="ontology" class="form-control" />     </div>   </div>   <div class="form-group">     <label for="class" class="col-sm-2 control-label">Type</label>     <div class="col-sm-10">       <select name="class" id="class" class="form-control" />     </div>   </div>   <div class="form-group">      <label for="subject" class="col-sm-2 control-label">Entity URI</label>      <div class="col-sm-10">        <input name="subject" id="subject" class="form-control" />      </div>   </div>   <div class="form-group">     <div class="col-sm-10 col-sm-offset-2">       <a href="#" class="btn btn-default triple-action triple-action-new-cancel">Cancel</a>       <a href="#" class="btn btn-primary triple-action triple-action-new-save">OK</a>     </div>   </div> </div></div></div>\n'),r=$("#ontology").ontoBox({ontoManager:t.ontologyManager}),r.on("changed",o),r.sel.focus(),i=$("#class").selectize({create:!0,valueField:"URI",labelField:"URI",searchField:["title","label","prefix","URI"],sortField:["prefix","URI"],options:t.ontologyManager.allClasses(),create:function(e,n){n(t.ontologyManager.OntologyClass(null,t.ontologyManager.uriDenormalize(e)))},render:{item:function(e,t){var n=e.title||e.label||name.curi||e.name;return e.curi&&e.curi!=n?n=t(n)+" <small>("+t(e.curi)+")</small>":n=t(n),"<div>"+n+"</div>"},option:function(e,t){return"<div>"+t(e.title||e.label||name.curi||e.name)+"<br/><small>("+t(e.URI)+")</small></div>"},option_create:function(e,n){var r=t.ontologyManager.uriDenormalize(e.input);return r!=e.input?'<div class="create">Add <strong>'+n(e.input)+"</strong> <small>("+n(r)+")</small>&hellip;</div>":'<div class="create">Add <strong>'+n(r)+"</strong>&hellip;</div>"}}}),s=i[0].selectize;else{var u=t.ontologyManager.ontologyClassByURI(e),a=u?u.label:RDFE.Utils.uri2name(e);t.formContainer.html('<div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">Add new Entity</h3></div><div class="panel-body"><div class="form-horizontal">   <div class="form-group">     <label for="class" class="col-sm-2 control-label">Type</label>     <div class="col-sm-10">       <p class="form-control-static" title="'+e+'">'+a+"</p>"+"    </div> "+"  </div> "+'  <div class="form-group"> '+'     <label for="subject" class="col-sm-2 control-label">Entity URI</label> '+'     <div class="col-sm-10"> '+'       <input name="subject" id="subject" class="form-control" /> '+"     </div> "+"  </div> "+'  <div class="form-group"> '+'    <div class="col-sm-10 col-sm-offset-2"> '+'      <a href="#" class="btn btn-default triple-action triple-action-new-cancel">Cancel</a> '+'      <a href="#" class="btn btn-primary triple-action triple-action-new-save">OK</a> '+"    </div> "+"  </div> "+"</div></div></div>\n"),t.formContainer.find("input#subject").focus()}this.config.options.entityUriTmpl&&t.formContainer.find('label[for="subject"]').text("Entity Name"),t.formContainer.find("a.triple-action-new-cancel").click(function(e){t.listContainer.show(),t.formContainer.hide()});var f=function(){var n=t.formContainer.find('input[name="subject"]').val(),r=null,i=e||t.formContainer.find("#class")[0].selectize.getValue();t.config.options.entityUriTmpl&&(r=n,n=null),t.doc.addEntity(n,r,i,function(e){t.entityView&&t.entityView.addEntity(e),$(t).trigger("rdf-editor-success",{type:"entity-insert-success",message:"Successfully created new entity."}),t.editEntity(e.uri)},function(){$(t).trigger("rdf-editor-error",{type:"triple-insert-failed",message:"Failed to add new triple to store."})})};t.formContainer.find("a.triple-action-new-save").click(function(e){f()}),t.formContainer.find("input#subject").keypress(function(e){e.which===13&&f()})},RDFE.Editor.prototype.createEntityList=function(){var e=this;$(e).trigger("rdf-editor-start",{id:"render-entity-list",message:"Loading Entities..."}),e.entityView||(e.entityView=new RDFE.EntityView(this.doc,this.ontologyManager,{editFct:function(t){e.editEntity.call(e,t)}}),$(e.entityView).on("rdf-editor-error",function(t){$(e).trigger("rdf-editor-error",d)}).on("rdf-editor-success",function(t,n){$(e).trigger("rdf-editor-success",n)})),e.formContainer.hide(),e.listContainer.empty().show(),e.entityView.render(e.listContainer,function(){$(e).trigger("rdf-editor-done",{id:"render-entity-list"})})},RDFE.Editor.prototype.editEntity=function(e){var t=this;t.entityEditor||(t.entityEditor=new RDFE.EntityEditor(t.doc,t.ontologyManager),$(t.entityEditor).on("rdf-editor-error",function(e){$(t).trigger("rdf-editor-error",d)}).on("rdf-editor-success",function(e,n){$(t).trigger("rdf-editor-success",n)})),t.listContainer.hide(),t.formContainer.show(),t.entityEditor.render(t.formContainer,e,function(){t.formContainer.hide(),t.listContainer.show(),t.entityView.updateEntity(e)})}